  UNIVERSIDAD NACIONAL DEL ALTIPLANO – PUNO
FACULTAD DE INGENIERÍA MECÁNICA ELÉCTRICA, ELECTRÓNICA Y
                       SISTEMAS
      ESCUELA PROFESIONAL DE INGENIERÍA ELECTRÓNICA




“DISEÑO E IMPLEMENTACIÓN DE UN CONTROLADOR
ADAPTATIVO AUTOSINTONIZADO PARA EL CONTROL
            DE UN PÉNDULO TRIPLE”


                        TESIS
                   PRESENTADO POR:
            WILSON BETO MENDOZA CCOA



          PARA OPTAR EL TÍTULO PROFESIONAL DE:
               INGENIERO ELECTRÓNICO



                    PUNO    –     PERÚ
                           2013
ÁREA: Automatización e instrumentación
TEMA: Instrumentación y control de procesos
      DEDICATORIA


       A Dios por haberme dado la vida y permitirme haber

llegado hasta este momento tan importante de mi formación

profesional .A mis padres porque siempre confiaron en mí y

me sacaron adelante dándome ejemplos de superación y

entrega. A mi hermano por haberme fomentado el deseo de

superación y anhelo de triunfo en la vida. Gracias a ustedes

hoy puedo ver alcanzada mi meta, ya que siempre estuvieron

impulsándome en los momentos más difíciles de mi profesión.




                                 Wilson Beto Mendoza Ccoa.
AGRADECIMIENTOS



Agradezco a Dios por protegerme durante todo mi camino
y darme fuerzas para superar obstáculos y dificultades a
lo largo de toda mi vida.

A mis padres por su demostración constante de
superación y perseverancia y por demostrarme la gran fe
que tienen en mí.

A mi hermano, por su respaldo, confianza y consejos que
me ayudaron a afrontar los retos que se me han
presentado a lo largo de mi vida.

A los Ingenieros por compartir sus conocimientos, apoyo
y motivación para la culminación de nuestros estudios
profesionales y para la elaboración de esta tesis.

A los compañeros de estudio y amigos por su motivación y
apoyo mutuo en nuestra formación profesional y sin los
cuales no hubiera logrado concluir esta meta.




                             Wilson Beto Mendoza Ccoa.
                                                              ÍNDICE
Índice de Figuras.................................................................................................................. i
Índice de Cuadros .............................................................................................................. iv
Nomenclatura ...................................................................................................................... v
Resumen ............................................................................................................................ vi
Abstract ............................................................................................................................. vii
Introducción ..................................................................................................................... viii


                                                          CAPÍTULO I
1. PLANTEAMIENTO Y FORMULACIÓN DEL PROBLEMA
      1.1 Descripción del Problema ...................................................................................... 1
      1.2 Formulación del Problema .................................................................................... 2
      1.3 Antecedentes de Investigación .............................................................................. 2
      1.4 Justificación .......................................................................................................... 5
      1.5 Objetivos de la Investigación ................................................................................ 6
            1.5.1       Objetivo General ....................................................................................... 6
            1.5.2       Objetivos Específicos ................................................................................ 6
      1.6 Hipótesis................................................................................................................. 6
            1.6.1       Hipótesis General ..................................................................................... 6
            1.6.2       Hipótesis Especificas ................................................................................. 6
      1.7 Operacionalización de Variables ........................................................................... 7
            1.7.1       Variable Dependiente ................................................................................ 7
            1.7.2       Variables Independientes .......................................................................... 7
      1.8 Limitaciones de la Investigación ............................................................................ 7




                                                         CAPÍTULO II
2 FUNDAMENTO TEÓRICO
      2.1 Sistemas de Control Automático. .......................................................................... 8
            2.1.1       Tipos de Sistemas de Control ................................................................... 9
                   2.1.1.1 Sistemas de control en lazo abierto………………………..………....9
                   2.1.1.2 Sistemas de control en lazo cerrado…………………..………...…..11
2.2 Control Digital ..................................................................................................... 14
      2.2.1     Función de transferencia pulso ............................................................... 15
      2.2.2     Modelo en el espacio de estados ............................................................ 15
      2.2.3     Representación en el espacio de estados de sistemas en
                     tiempo discreto ................................................................................... 16
      2.2.4     Discretización de las ecuaciones en espacio de estados en
                      tiempo continuo ................................................................................. 18
2.3 Control Adaptativo ............................................................................................... 19
      2.3.1     Programación de Ganancias .................................................................... 20
      2.3.2     Control Adaptativo por Modelo de referencia......................................... 21
                     2.3.2.1. Enfoque de sensibilidad........................................................ 22
                     2.3.2.2. Método de Lyapunov .......................................................... 23
                     2.2.2.3. Método de Hiperestabilidad ................................................. 24
      2.3.3     Regulador autoajustable .......................................................................... 25
            2.3.3.1 Asignación de polos y ceros ............................................................. 28
            2.3.3.2 Predicción Optima ........................................................................... 30
            2.3.3.3 Regulación de mínima varianza ....................................................... 32
            2.3.3.4 Control predictivo generalizado........................................................ 33
2.4 Identificación de Sistemas .................................................................................. 34
      2.4.1     Modelo ARX .......................................................................................... 34
      2.4.2     Procedimiento de identificación de sistemas ........................................... 35
      2.4.3     Validación del modelo ............................................................................ 36
      2.4.4     El bucle de identificación de sistemas .................................................... 37
      2.4.5     Métodos recursivos de estimacion de parámetros ................................... 38
      2.4.6     El algoritmo de los mínimos cuadrados recursivos ................................. 39
            2.4.6.1 Algoritmo recursivo .......................................................................... 39
            2.4.6.2 Matriz de inversión eficiente ............................................................ 40
            2.4.6.3 Caso multivariable ............................................................................ 41
2.5       Mecánica analítica de Euler - Lagrange - Hamilton ...................................... 41
      2.5.1     Sistemas con ligaduras ............................................................................ 42
            2.5.1.1 Ligaduras holónomas ....................................................................... 43
            2.5.1.2 Ligaduras no holónomas ................................................................... 43
        2.5.2      Coordenadas generalizadas ..................................................................... 44
        2.5.3      El principio de D’Alembert en coordenadas generalizadas .................... 47
        2.5.4      Ecuaciones de Lagrange .......................................................................... 48




                                                  CAPÍTULO III
3 MÉTODO DE INVESTIGACIÓN
  3.1 Tipo y Diseño de Investigación ........................................................................... 50
        3.1.1      Tipo de Investigación .............................................................................. 50
        3.1.2      Nivel de Investigación ............................................................................. 51
        3.1.3      Diseño de Investigación .......................................................................... 52
        3.1.4      Tema de Investigación ............................................................................. 52
  3.2 Técnicas e instrumentos de recolección de datos ................................................. 52
  3.3 Fases de la Investigación...................................................................................... 53
  3.4 Condiciones de Prueba y Evaluación del Sistema ............................................... 54
  3.5 Ámbito de Estudio ............................................................................................... 55
  3.6 Recursos ............................................................................................................... 56
        3.6.1      Recursos Humanos .................................................................................. 56
        3.6.2      Recursos Materiales ................................................................................ 56
  3.7 Financiamiento del Proyecto ................................................................................ 57




                                                  CAPÍTULO IV
4 EXPOSICIÓN, DISEÑO Y ANÁLISIS DE RESULTADOS
  4.1 Generalidades ....................................................................................................... 61
  4.2 Modelamiento matemático del péndulo triple ..................................................... 61
        4.2.1      Modelamiento matemático del subsistema carro – péndulo triple .......... 61
        4.2.2      Modelamiento matemático del subsistema Motor - Polea ...................... 67
        4.2.3      Modelamiento matemático en MATLAB ............................................... 70
        4.2.4      Variables y parámetros del proceso ........................................................ 74
        4.2.5      Linealización del sistema ........................................................................ 75
        4.2.6      Modelo en espacio de estado discreto ..................................................... 77
     4.3 Estimador de parámetros del Proceso. ................................................................ 78
            4.3.1     Pasos para la estimación en Matlab ......................................................... 80
     4.4 Diseño del controlador Adaptativo ...................................................................... 82
            4.4.1     Diseño del controlador en Matlab ........................................................... 85
            4.4.2     Respuestas Gráficas ................................................................................. 86
            4.4.3     Prueba de la adaptatibilidad del controlador ........................................... 89
            4.4.4     Diseño del observador de estados............................................................ 92
                 4.4.4.1 Diseño del observador de estados en Matlab……………….………94
            4.4.5     Simulación en Simulink .......................................................................... 97
            4.4.6     Programa completo del controlador Adaptativo ................................... 107
     4.5 Diseño del sistema mecánico del péndulo triple ............................................... 114
     4.6 Diseño electrónico del controlador .................................................................. 117
     4.7 Diseño del software de control .......................................................................... 121
            4.7.1     Interfaz de usuario ................................................................................. 121
            4.7.2     Comunicación entre LabVIEW y PIC ................................................... 125
            4.7.3     Programación del PIC 18F4550 ............................................................ 129
     4.8 Resultados de la investigación .......................................................................... 136
               Prueba 1: Correcciones en el hardware y software ........................................ 138
               Prueba 2: Mejora del diseño del controlador – observador............................ 139
               Prueba 3: Probando la adaptatibilidad del controlador diseñado .................. 139
            4.8.1     Resultados finales del controlador ........................................................ 140
            4.8.2     Comparación del controlador adaptativo frente a otro control .............. 141
            4.8.3     Diferencias entre modelo completo no lineal y modelo
                          Linealizado. ...................................................................................... 144
     4.9 Validación de Hipótesis ..................................................................................... 147


CONCLUSIONES ........................................................................................................ 149
RECOMENDACIONES .............................................................................................. 151
REFERENCIAS BIBLIOGRAFÍAS .......................................................................... 152
ANEXOS........................................................................................................................ 154

GLOSARIO DE TÉRMINOS ..................................................................................... 169
                                         ÍNDICE DE FIGURAS


Figura 1. Sistema de Control en lazo abierto. ..................................................................... 9
Figura 2. Sistema de Control en lazo abierto con actuador. ............................................... 9
Figura 3. Sistema de Control en lazo abierto para el alumbrado público ......................... 10
Figura 4. Sistema de Control en lazo cerrado. .................................................................. 11
Figura 5. Sistema de Control en lazo cerrado realimentado con un captador .................. 12
Figura 6. Sistema de control en tiempo continuo. ............................................................ 14
Figura 7. Sistema de control digital. ................................................................................. 15
Figura 8. Configuración básica del control Adaptivo. ...................................................... 20
Figura 9. Sistema de programación de ganancias. ............................................................ 20
Figura 10. Esquema del MRAC.. ...................................................................................... 21
Figura 11. Esquema del STR ............................................................................................ 25
Figura 12 Estructura de control por asignación de polos y ceros. .................................... 28
Figura 13. Interpretación como modelo de referencia. ..................................................... 30
Figura 14. El bucle de identificación de sistemas. ............................................................ 38
Figura 15. El método adaptativo. ...................................................................................... 39
Figura 16. El movimiento del sólido articulado ............................................................... 45
Figura 17. Subsistema carro – péndulo triple. .................................................................. 61
Figura 18. Subsistema motor polea................................................................................... 67
Figura 19. Identificación de parámetros. .......................................................................... 81
Figura 20. Estructura del sistema de control Adaptativo del Péndulo Triple. ................. 82
Figura 21. Respuestas del sistema Péndulo Triple .. ....................................................... 86
Figura 22. Posición y velocidad lineal del carro .. ........................................................... 87
Figura 23. Posición y velocidad angular de la primera varilla.. ....................................... 87
Figura 24. Posición y velocidad angular de la segunda varilla.. ....................................... 87
Figura 25. Posición y velocidad angular de la tercera varilla.. ......................................... 88
Figura 26. Acción integral y señal de control u(k).. ......................................................... 88
Figura 27. Estimador de parámetros. ................................................................................ 89
Figura 28. Sistema lineal variable con control Adaptativo (carro). .................................. 89
Figura 29. Sistema lineal variable con control Adaptativo (péndulo 1). .......................... 90


                                                                                                                   i
Figura 30. Sistema lineal variable con control Adaptativo (péndulo 2). .......................... 90
Figura 31. Sistema lineal variable con control Adaptativo (péndulo 3). .......................... 91
Figura 32. Sistema lineal variable con control Adaptativo(control). ................................ 91
Figura 33. Sistema de regulación con observador de estados........................................... 92
Figura 34. Simulación del sistema de control adaptativo usando Simulink de Matlab.. .. 97
Figura 35. Modelo no lineal del Péndulo Triple. .............................................................. 97
Figura 36. Identificador del sistema. .............................................................................. 100
Figura 37. Diseño del controlador. ................................................................................. 102
Figura 38. Respuestas del controlador Adaptativo a una entrada variable. .................... 104
Figura 39. Sistema lineal variable con control Adaptativo (péndulo 1). ........................ 105
Figura 40. Sistema lineal variable con control Adaptativo (péndulo 2). ........................ 105
Figura 41. Sistema lineal variable con control Adaptativo (péndulo 3). ........................ 105
Figura 42. Sistema lineal variable con control Adaptativo (control). ............................. 106
Figura 43. Cantidad y tiempos en que varían los parámetros ......................................... 106
Figura 44. Estimador de parámetros ............................................................................... 107
Figura 45. Diseño mecánico del Péndulo Triple (vista frontal) ..................................... 114
Figura 46. Diseño mecánico del Péndulo Triple (vista superior). .................................. 115
Figura 47. Sistema mecánico del Péndulo Triple. .......................................................... 116
Figura 48. Fuente de alimentación para el controlador ................................................. 117
Figura 49. Fuente de alimentación para el driver de potencia ....................................... 117
Figura 50. Controlador del sistema, compuesto por los PIC16F877, PIC 18F4550 y
                enlazado vía el puerto USB con el LabVIEW 2012 .................................... 118
Figure 51. Circuito equivalente del driver STK 6875 de SANYO ................................. 119
Figura 52. Etapa de potencia........................................................................................... 119
Figura 53. Circuito electrónico de control del péndulo triple. ........................................ 120
Figure 54. Ventana principal de la interfaz de usuario ................................................... 121
Figura 55. Variables y Dinámica del sistema ................................................................. 122
Figura 56. Estructura del Controlador Adaptativo ........................................................ 122
Figure 57. Diagrama de bloque del Controlador Adaptativo autosintonizado para
              controlar el péndulo triple. ............................................................................. 123
Figura 58. Diagrama de bloques para el modelo lineal en tiempo continuo y discreto .. 124
Figura 59. Diagrama de bloque para la ley de control .................................................... 124

                                                                                                                    ii
Figura 60. Diagrama de bloque para la comunicación entre LabVIEW y el PIC ........... 125
Figura 61. Diagrama de bloque para el MPUSBGETDEVICECOUNT del
              mpusbapi.dll. ................................................................................................ 126
Figura 62. Configuración de parámetros para el MPUSBGETDEVICECOUNT
              del mpusbapi.dll............................................................................................ 126
Figura 63. Diagrama de bloque para el MPUSBREAD del mpusbapi.dll. ................... 127
Figura 64. Configuración de parámetros para el MPUSBREAD                                                    del
              mpusbapi.dll ................................................................................................. 127
Figura 65. Diagrama de bloque para el MPUSBWRITE del mpusbapi.dll. ................. 128
Figura 66. Configuración de parámetros para el MPUSBWRITE del mpusbapi.dll .. 128
Figura 67. Compilación del programa en PICC ............................................................. 132
Figura 68. Grabador PICKIT 2 de Microchip ................................................................. 132
Figura 69. Programación del PIC usando PICKIT 2 de Microchip ................................ 133
Figura 70. Conexión del PIC 18F4550 a la PC............................................................... 133
Figura 71. Instalación del Driver mchpusb.................................................................... 134
Figura 72. Instalación del software de control .............................................................. 135
Figura 73. Instalación exitosa del driver para la comunicación entre PIC y PC ............ 135
Figura 74. Reconocimiento de la DAQ ........................................................................ 136
Figura 75. Respuesta del controlador Adaptativo frente a una señal de entrada
              variable........................................................................................................... 137
Figura 76. Evolución temporal de los ángulos frente a una señal de entrada variable . 137
Figura 77. Controlador fijo : PI óptimo cuadrático ...................................................... 141
Figura 78. Respuestas cuando los parámetros varían en 5% .......................................... 142
Figura 79. Respuestas cuando los parámetros varían en 50% ...................................... 142
Figura 80. Respuesta cuando se incremento 500 gr a la varilla 3. .................................. 143
Figura 81. Respuesta cuando se incremento 1000 gr a la varilla 3. ................................ 143
Figura 82. Simulación usando el modelo no lineal del péndulo triple. ........................ 144
Figura 83. Simulación usando el modelo linealizado del péndulo triple. .................... 145
Figura 84. Error entre la posición. .................................................................................. 145
Figura 85. Error entre los ángulos. ................................................................................ 146
Figura 86. Error entre las velocidades ........................................................................... 146


                                                                                                                           iii
                                     ÍNDICE DE CUADROS


Cuadro 1. Técnicas e instrumentos de recolección de datos. ............................................ 52
Cuadro 2. Financiamiento de la Investigación.................................................................. 58
Cuadro 3. Variables y parámetros del Péndulo Triple. .......................................................... 74
Cuadro 4. Cuadro de resultados obtenidos utilizando el Controlador Adaptativo.. ....... 140
Cuadro 5. Resultados utilizando un controlador fijo.. .................................................... 144
Cuadro 6. Diferencias entre modelo completo no lineal y modelo linealizado .............. 147
Cuadro 7. Características del Controlador Adaptativo ................................................... 147




                                                                                                          iv
                                 NOMENCLATURA


ARMA           Modelo autoregresivo de media móvil
ARMAX          Modelo autoregresivo de media móvil con entrada externa
ARX            Modelo autoregresivo con entrada externa
BJ             Estructura Box - Jenkins
DC             Corriente Directa
GPC            Controlador Predictivo Generalizado
LabVIEW         Laboratory Virtual Instrumentation Engineering Workbench
LQR             Regulador cuadrático lineal
MATLAB          MATrix LABoratory
MCR             Mínimos cuadrados recursivos
MCRM            Mínimos cuadrados recursivos mejorados
MIMO            Sistema de múltiples entradas y múltiples salidas
MOSFET          Transistor de efecto de campo metal-óxido-semiconductor
MRAC            Controlador Adaptativo por modelo de referencia
PID             Controlador Proporcional Integral Derivativo
PIC             Controlador de interfaz periférico
PWM             Modulación por anchura de pulso
SISO            Sistema de una entrada y una salida
STR             Regulador Autoajustable
USB             Bus Serie Universal
VID&PID         Identificador de Vendedor y producto.
x1, x2, x3, x4, x5, x6, x7, x8   Variables de estado
uc              Señal de control




                                                                           v
                                    RESUMEN


       El proyecto de investigación desarrollado propone diseñar e implementar un
controlador adaptativo autosintonizado para controlar la estabilidad de un péndulo
triple invertido lineal utilizando conocimientos de la ingeniería de control,
electrónica analógica y digital, mecánica analítica y la programación.
       Para modelar el sistema no se hizo uso de la mecánica clásica de Newton,
sino se utilizó la mecánica analítica de Euler – LaGrange, como método de
estimación de parámetros se empleó el método de los mínimos cuadrados recursivos
mejorados, además se diseño un observador de estados de orden mínimo para
garantizar la realimentación de todos los estados, la ley de control utilizada fue un
regulador proporcional integral óptimo cuadrático con realimentación de estados, las
simulaciones se realizaron en el software de MATLAB ®.
       El sistema mecánico diseñado se construyó a base de aluminio, los sensores
utilizados para la medición del desplazamiento del carro así como para los
deslazamientos angulares de las varillas son potenciómetros, como elemento
actuador se usó un motor DC de imán permanente de 24 voltios.
       Se desarrolló un software en el programa LabVIEW 2012 para el monitoreo
y control del péndulo triple, para la comunicación entre el sistema mecánico y el
software de control se diseño una tarjeta de adquisición y envío de datos con el
PIC18F4550 de Microchip vía el puerto USB, además se empleó un PIC16F877 con
la finalidad de compartir parte del algoritmo de control con el fin de minimizar el
tiempo de retardo en el envió, recepción y procesamiento de datos.
       Se comprobó la adaptatibilidad del controlador diseñado frente a cambios en
la dinámica del sistema, demostrando la eficacia del regulador adaptativo, además se
realizó comparaciones entre el controlador diseñado y un controlador óptimo, se
observó que un simple regulador óptimo no responde correctamente a medida que la
dinámica del sistema varia del punto en el cual fue diseñado, de esta forma se
demostró la ventaja de utilizar un control más inteligente frente a uno fijo, sin
embargo los recursos computacionales requeridos son más elevados, por lo que se
debe de tomar en cuenta al momento de diseñar un controlador para un sistema
determinado.

                                                                                   vi
                                       ABSTRACT


       The developed research project aims to design and implement an adaptive
controller autotuning to control the stability of the triple inverted pendulum using
knowledge of control engineering, analog and digital electronics, analytical
mechanics and programming.


       To model the system does not use classical mechanics of Newton, but we
used the analytical mechanics of Euler - LaGrange, as parameter estimation method
we used the recursive least squares algorithm, and it was designed a state observer to
ensure every state feedback, the control law used was proportional integral optimal
quadratic regulator with state feedback, simulations were performed in MATLAB ®
software.


       The mechanical system designed is constructed of aluminum, the sensors
used for measuring the displacement of the car and rods are potentiometers, as
actuator we used a permanent magnet DC motor of 24 volts.


       Software was developed in LabVIEW 2012 for monitoring and control of the
triple pendulum, for communication between the mechanical system and the control
software it designed a data acquisition card with the PIC18F4550 by USB port, also
used a PIC16F877 in order to share some of the control algorithm in order to
minimize the time delay in the sending, receiving and processing data.


       The adaptability of the controller designed was tested for changes in the
system dynamics, demonstrating the effectiveness of the adaptive controller, I made
comparisons between the controller designed and an optimal controller , was
observed that a simple optimal regulator does not respond correctly as the system
dynamics varies the point at which it was designed, thus demonstrated the benefit of
using a more intelligent control against one fixed, however the computational
resources needed are higher, so this should be taken into account when designing a
controller for a given system.

                                                                                   vii
                                     INTRODUCCIÓN


        En la actualidad la mayoría de industrias combina el uso del control PID para
el control básico de los procesos con el uso de técnicas de control predictivo basado
en modelo para aplicaciones de control avanzado, sin embargo existe ausencia de un
mecanismo de adaptación que permita a los controladores ajustarse a los cambios de
la dinámica del proceso, por ello la disponibilidad de una solución de control
adaptativo, capaz de operar de manera eficaz y robusta en entornos industriales y
mejorar el rendimiento de control de los sistemas, por lo tanto, es de gran interés
considerarlos por razones económicas y de seguridad en su aplicación en la industria.
        Entre las últimas estrategias de control que buscan obtener un mejor
rendimiento están aquellas que se basan en conocimientos de la inteligencia artificial,
lógica difusa y últimamente el control adaptativo predictivo experto, en todas estas
nuevas estrategias se toma gran interés en diseñar mecanismos de adaptación que
sean capaces de responder adecuadamente frente a cambios dinámicos del proceso e
incertidumbres no modeladas.
        El control adaptativo se divide en tres grandes esquemas que son: La
programación de ganancias o gain sheduling, por modelo de referencia y el regulador
autoajustable, siendo este último capaz de estimar en línea los parámetros y estados
del proceso, por tanto, debido a la gran importancia del control adaptativo y su
mecanismo de adaptación, el presente proyecto de investigación busca diseñar e
implementar un controlador adaptativo autoajustable aplicado a un proceso altamente
no lineal e inestable con el fin de observar los beneficios de usar un control variable
frente a uno fijo .
        El sistema en el que se aplicará el controlador adaptativo autoajustable es el
péndulo triple invertido, este proceso es altamente inestable y presenta características
no lineales que los hacen idóneo para el estudio, las aplicaciones del péndulo triple se
presentan en distintos campos de investigación como la robótica, la estabilización de
misiles, estudios sobre vibraciones sísmicas entre otras.
        El presente proyecto de investigación consta de seis capítulos, distribuidos de
la siguiente manera:


                                                                                    viii
       El CAPÍTULO I: Planteamiento y formulación del problema; describe la
problemática de estudio, se plantea las soluciones que se pueden alcanzar con la
realización del proyecto, tomando como base, investigaciones ya hechas. Así mismo,
se tiene la justificación respectiva de la ejecución del proyecto, sus objetivos,
hipótesis y limitaciones correspondientes.
       En el CAPÍTULO II: Fundamento Teórico; se tienen: los conceptos,
enunciados, fórmulas, teoremas, etc., aplicados al estudio del tema de investigación
de manera clara y precisa, en las áreas de: teoría de control analógico y digital,
estrategias de los controladores adaptativos, métodos de estimación de parámetros y
mecánica analítica.
       El CAPÍTULO III: Método de investigación; detalla específicamente el tipo y
diseño de la investigación realizada, las técnicas e instrumentos de recolección de
datos, fases de la investigación y condiciones de prueba, se analiza el ámbito de
estudio en donde se aplicará el proyecto de investigación, además de los recursos y
financiamiento del proyecto.
       El CAPÍTULO IV: Exposición, diseño y análisis de resultados; es la parte
principal del proyecto de investigación, en este capítulo realizamos el modelamiento
matemático completo no lineal y el modelo linealizado del sistema motor - péndulo
triple, además utilizamos el método de los mínimos cuadrados recursivos mejorados
(MCRM) como estimador de parámetros del proceso, como ley de control utilizamos
un regulador proporcional integral optimo cuadrático con realimentación de estados,
realizamos el diseño mecánico, controlador electrónico y el software de control en
LabVIEW, mediante la técnica de prueba y error realizamos las pruebas con el fin de
probar nuestro diseño, por ultimo hacemos una comparación entre el regulador
adaptativo diseñado y un controlador fijo.
       Finalmente se exponen las conclusiones a las cuales se llegaron en la
realización   del     presente   proyecto    de   investigación,   así   mismo    damos
recomendaciones y sugerencias para futuras investigaciones y trabajos relacionados
que se puedan llevar más adelante.


                                                                                 El Autor


                                                                                       ix
   CAPITULO I
    PLANTEAMIENTO Y
FORMULACIÓN DEL PROBLEMA
1.1.   DESCRIPCIÓN DEL PROBLEMA


              Uno de los problemas clásicos en el área de ingeniería de control es
       controlar la estabilidad de un péndulo invertido lineal, pero existen variantes de
       este como el péndulo rotacional o de Furuta, así como añadir más articulaciones
       al péndulo como son el péndulo doble y el péndulo triple, este último presenta
       características importantes ya que mimetiza el movimiento del cuerpo humano
       y su mecanismo de balanceo, investigaciones han demostrado un progreso en
       esta área y sus aplicaciones se dan en el campo de la robótica humanoide,
       proyectos militares para la estabilización de misiles, en estudios referentes a
       sistemas de aislamiento de vibración sísmica donde se estudia la frecuencia y
       respuesta de la función de transferencia.
              La mayoría de sistemas de control utilizados actualmente en las
       industrias son los PID, sin embargo este presenta limitaciones en su correcto
       funcionamiento a medida que los parámetros del proceso se alejan del punto de
       operación en la cual fueron diseñados, además de estas variaciones, las
       incertidumbres en el modelado y los posibles fallos por parte de los sensores y
       actuadores obligan a elaborar nuevas estrategias de control que garanticen un
       correcto funcionamiento ante incertidumbres en el modelo y perturbaciones
       sobre este, para solucionar esto existen dos enfoques, la primera es utilizar un
       controlador adaptativo el cual estima los parámetros y basándose en estos
       calcula la señal de control y la segunda es considerar las incertidumbres del
       sistema, esto nos lleva a un esquema de control robusto, la metodología más
       adecuada para resolver estos problemas son los reguladores autoajustables.
              Por tanto esta tesis se propone diseñar e implementar un controlador
       adaptativo autosintonizado para controlar la estabilidad de un péndulo triple
       invertido lineal; por otra parte se pretende hacer una comparación de la eficacia
       del control adaptativo y un controlador diseñado con otra estrategia de control
       y así comparar las respuestas en estado transitorio y estacionario así como la
       estabilidad del sistema, adicionalmente a esto se realizara una interfaz gráfica
       de usuario que permita visualizar en tiempo real los cambios en el
       comportamiento del péndulo triple.

                                                                                       1
1.2.   FORMULACIÓN DEL PROBLEMA

              Los factores que determinan el funcionamiento del péndulo triple son el
       algoritmo de control, la precisión de los sensores, la rapidez y capacidad de
       procesamiento de los dispositivos electrónicos usados en la adquisición y envío
       de datos y la calidad del prototipo físico diseñado.
              Por lo tanto debido a la gran importancia, complejidad del problema y
       la poca información referente al control del péndulo triple nos preguntamos si:

              ¿Es posible controlar la estabilidad de un péndulo triple empleando un
       controlador adaptativo autosintonizado?
              ¿La respuesta de un controlador adaptativo autosintonizado tiene un
       mejor comportamiento que usar otras estrategias de control?
              ¿Las ventajas de emplear un controlador adaptativo son mayores a las
       desventajas producidas por el costo computacional necesario para realizar los
       algoritmos de control?

1.3.   ANTECEDENTES DE INVESTIGACIÓN

              Para resolver el problema planteado en esta investigación, se recurrió a
       diversas investigaciones en el área de la ingeniería electrónica y de control,
       microcontroladores, comunicación con ordenador, sistemas computacionales,
       matemáticas avanzadas y mecánica analítica. Se tuvo en consideración los
       siguientes antecedentes:

       Título: Levantamiento y estabilización del péndulo invertido lineal.
       Autores: Fernando Castaños Luna (Facultad de Ingeniería UNAM)
       Técnicas empleadas: Algoritmo de control usando LQR .
       Conclusión principal: Esta investigación         tiene por objetivo diseñar un
       algoritmo de control usando un regulador cuadrático lineal - LQR                  y
       observadores de Luenberger para el control de estabilidad del péndulo, además
       toma la iniciativa de realizar un algoritmo de autolevantamiento, los resultados
       de este trabajo muestran que el controlador diseñado es capaz de compensar
       adecuadamente tanto perturbaciones como variaciones en los parámetros del

                                                                                         2
sistema; en tanto el algoritmo de autolevantamiento no garantiza que el péndulo
llegue a la posición de equilibrio con velocidad angular nula, esto causa que no
siempre se logre levantar en la totalidad de los intentos.

Título: Péndulo triple invertido.
Autores: Víctor Hernández Santamaría, José Rojo Ramírez.
Técnicas empleadas: Control adaptativo y robusto.
Conclusión principal: Este proyecto tenía como finalidad desarrollar un
sistema completo, desde el sistema mecánico, hasta la implementación de un
controlador adaptable y otro robusto; para el modelamiento del sistema utilizó
mecánica analítica de Euler-Lagrange, esta formulación es más sistemática que
la Newtoniana lo que facilita enormemente la formulación de un modelo
complejo como es el péndulo triple, para el sistema de identificación usa el
algoritmo de los mínimos cuadrados y como estrategia de control o ley de
control usa el método de asignación de polos; las respuestas dadas por el
sistema muestran una adaptabilidad del controlador a los cambios de los
parámetros del sistema.

Título: Comportamiento dinámico de un péndulo triple plano.
Autores: Iván de Jesús Rivas campero y José Manuel Sausedo Solorio.
Técnicas empleadas: Análisis no lineal.
Conclusión       principal:   El   proyecto   pretende   hacer   un   estudio   del
comportamiento no lineal del péndulo triple, así como muestra que este puede
extenderse al estudio del péndulo de “N” eslabones, se hace un análisis de la
frecuencia de resonancia así como los cambios en la dinámica al variar la
magnitud, frecuencia de perturbación y rozamiento en los eslabones
,demostrando que los estados del péndulo pueden ser periódicos, cuasi -
periódicos y caóticos; muestra que el comportamiento de los desplazamientos
angulares tanto en función del tiempo como de la frecuencia definen la
frecuencia de perturbación así como los coeficientes de resonancia definan
zonas de respuesta con estados periódicos, cuasi - periódicos y respuestas
caóticas, se detectan errores en el sistema linealizado en las zonas cercanas a la
de resonancia.

                                                                                 3
Título: Comparison of techniques for stabilization of a triple inverted
pendulum.
Autores: Érick Lee, James Perkins.
Técnicas empleadas: Métodos LQR y Q-Learning.
Conclusión principal: Esta investigación tiene por objetivo realizar un sistema
de control de balanceo del péndulo triple empleando las técnicas de LQR y Q -
learning, donde muestra que el sistema diseñado usando LQR obtiene buenos
resultados mientras que el Q - Learning muestra respuestas insatisfactorias
debido a la gran cantidad de recursos consumidos por el algoritmo diseñado.


Título: Control avanzado – diseño y aplicaciones en tiempo real .
Autores: Arturo Rojas Moreno.
Técnicas empleadas: Control optimo, adaptativo, predictivo, robusto y no
lineal.
Conclusión principal: Este libro muestra distintos técnicas empleadas en el
diseño de sistemas de control no tradicional, como control óptimo cuadrático,
adaptativo, predictivo, robusto y no lineal, con simulaciones hechas en el
software de Matlab, así como programas de control en tiempo real desarrolladas
en C++, mostrando aplicaciones en tiempo real que guardan estrecha relación
entre la teoría – simulación y la práctica.


Título: System identification – Theory for the user.
Autores: Lennart Ljung.
Técnicas empleadas: Técnicas de identificación de sistemas.
Conclusión principal: Este libro muestra los distintos métodos y técnicas
usadas en la identificación de sistemas, propiedades y usos que son muy
necesarios a la hora de modelar un sistema dinámico basado en la observación
de datos del sistema, además de los métodos de estimación de parámetros,
muestra otras técnicas que pueden servir para solucionar problemas mucho más
complejos que los vistos en el presente proyecto.




                                                                              4
       Título: Control de péndulo invertido.
       Autores: Universidad Carnige Mellon.
       Técnicas empleadas: Control PID, respuesta en frecuencia, etc.
       Conclusión principal: Muestra distintos ejemplos de sistemas de control
       aplicando los criterios de diseño de control clásico y avanzado, además cuenta
       con algoritmos desarrollados en Matlab que hacen más práctico el estudio de
       esta área de la ingeniería.


1.4.   JUSTIFICACIÓN


              El péndulo triple plano es utilizado para estudiar el comportamiento de
       distintos campos de la ciencia e ingeniería como el control de estabilidad de los
       misiles para investigaciones militares, en estudios del comportamiento del
       cuerpo humano, ya que el péndulo triple mimetiza el movimiento del cuerpo
       humano y su mecanismo de balanceo, además varios estudios sobre vibraciones
       sísmicas utilizaron un péndulo triple para estudiar la frecuencia y las respuestas
       en el tiempo así como su función de transferencia, también se utilizó para
       estudiar sistemas pistón-biela-manivela de un motor monocilindro de
       combustión, así como en la estabilidad de satélites y de robots humanoides.
       Como podemos ver las aplicaciones del péndulo triple son diversas e
       importantes.
              En la vida real la dinámica de un proceso no se conoce completamente,
       por lo que el modelo de la planta solo puede considerarse como una
       aproximación a la descripción exacta, además las perturbaciones desconocidas
       influyen en el comportamiento del sistema ocasionando que el controlador
       trabaje fuera del entorno al cual fue diseñado, ocasionando un funcionamiento
       inadecuado del sistema, esto lleva a pensar en diseñar un controlador que sea
       capaz de variar su comportamiento frente a cambios en su dinámica y a las
       perturbaciones externas, estos problemas son resueltos si utilizamos un
       controlador adaptativo autosintonizado que presenta una solución en tiempo
       real tratando de alcanzar un control optimo, sujeto a una ley de control y
       obteniendo información del proceso y sus señales.

                                                                                       5
1.5.   OBJETIVOS DE LA INVESTIGACIÓN


       1.5.1.   Objetivo General
                 Diseñar e implementar un sistema para el control de estabilidad de
                    un      péndulo triple invertido lineal mediante un controlador
                    adaptativo autosintonizado.

       1.5.2.   Objetivos Específicos
                 Determinar las diferencias de los modelos matemáticos del sistema
                  del péndulo triple en su forma lineal y su modelo completo no lineal.

                 Determinar las diferencias de la respuesta transitoria y estacionaria
                  entre el controlador adaptativo diseñado y un controlador fijo como
                  es el óptimo cuadrático.

                 Realizar una interfaz de usuario que permita controlar el Set Point así
                  como monitorear las señales provenientes del sistema.



1.6.   HIPÓTESIS DE LA INVETIGACIÓN


       1.6.1.   Hipótesis General.
                    El controlador adaptativo autosintonizado controla eficazmente la
                    estabilidad de un péndulo triple invertido lineal.


        1.6.2 Hipótesis Específicas.
                 H.1. El      controlador      adaptativo   autosintonizado   atenúa    las
                         perturbaciones externas y tiene una mejor respuesta que otros
                         métodos de control.

                 H.2. Las ventajas de emplear un controlador adaptativo son mayores a
                         las desventajas producidas por el costo computacional requerido
                         para realizar los algoritmos de control.



                                                                                          6
1.7.   OPERACIONALIZACIÓN DE VARIABLES


       1.7.1.    Variable Independiente
                La variable independiente de la presente investigación es el controlador
                adaptativo.


       1.7.2.    Variables Dependientes
                Con el fin de alcanzar el objetivo las variables dependientes son:
                    -Estabilidad del péndulo triple.
                    -Error de los Ángulos de las varillas de los péndulos.
                    -Tiempo de respuesta del controlador.
                    -Sensibilidad a las perturbaciones y cambios en la dinámica del
                    sistema.


1.8.   LIMITACIONES DE LA INVESTIGACIÓN


                La complejidad de los algoritmos de identificación de parámetros y
       control en tiempo real empleados consumen muchos recursos del sistema
       computacional ,esto causa un retardo en el envió de la señal de control , además
       al ser este un prototipo se puso limitaciones en la parte económica que no
       permitieron el uso de        dispositivos       mejor dotados en      adquisición y
       procesamiento de datos; creando limitaciones en el correcto desempeño del
       sistema; por otra parte el modulo mecánico del péndulo triple así como los
       sensores y actuador usados son de bajo costo, generando comportamientos
       inesperados que afectan al óptimo desempeño total de la planta.
                El péndulo triple muestra ser como se esperaba, un sistema muy
       complejo de controlar, si bien las simulaciones indican un correcto
       funcionamiento del controlador adaptativo, en la vida práctica aparecen varios
       factores que no permiten alcanzar el estado optimo del sistema, sin embargo
       utilizando la técnica de prueba y error se consiguió que el controlador tenga un
       comportamiento aceptable.



                                                                                        7
CAPITULO II
FUNDAMENTO TEÓRICO
       2.1.   SISTEMAS DE CONTROL AUTOMÁTICO


                       Un sistema automático de control es un conjunto de componentes físicos
              conectados o relacionados entre sí, de manera que regulen o dirijan su actuación
              por sí mismos, es decir sin intervención de agentes exteriores (incluido el factor
              humano), corrigiendo además los posibles errores que se presenten en su
              funcionamiento [9]1.
                       Actualmente, cualquier mecanismo, sistema o planta industrial presenta
              una parte actuadora, que corresponde al sistema físico que realiza la acción, y
              otra parte de mando o control, que genera las órdenes necesarias para que esa
              acción se lleve o no a cabo.
                       Un ejemplo sencillo de sistema automático lo constituye el control de
              temperatura de una habitación por medio de un termostato, en el que se
              programa una temperatura de referencia que se considera idónea. Si en un
              instante determinado la temperatura del recinto es inferior a la deseada, se
              producirá calor, lo que incrementará la temperatura hasta el valor programado,
              momento en que la calefacción se desconecta de manera automática [9].
                       En la actualidad los sistemas automáticos juegan un gran papel en
              muchos campos, mejorando nuestra calidad de vida:
                       En los procesos industriales:
                       - Aumentando las cantidades y mejorando la calidad del producto,
              gracias a la producción en serie y a las cadenas de montaje.
                       - Reduciendo los costes de producción.
                       - Fabricando artículos que no se pueden obtener por otros medios.
                       - En los hogares: Mejorando la calidad de vida. Podríamos citar desde
              una lavadora hasta un control inteligente de edificios (domótica).
                       - Para los avances científicos: Un claro ejemplo lo constituyen las
              misiones espaciales.
                       - Para los avances tecnológicos: por ejemplo en automoción es de todos
              conocidos los limpiaparabrisas inteligentes, etc.



1
    Teoría de control –Diseño Electrónico. Espartacus Gomaris.
                                                                                              8
                       Como se puede observar las aplicaciones son innumerables, de esta
              manera surge toda una teoría denominada la regulación automática, dedicada al
              estudio de los sistemas automáticos de control.


              2.1.1.    Tipos de Sistemas de Control
                       Los sistemas de regulación se pueden clasificar en:
                           o Sistemas de bucle o lazo abierto: son aquellos en los que la
                                acción de control es independiente de la salida.
                           o Sistemas de bucle o lazo cerrado: son aquellos en los que la
                                acción de control depende en cierto modo, de la salida [15] 2.


                        2.1.1.1.- Sistemas de control en lazo abierto
                                Un sistema de control en lazo o bucle abierto es aquél en el que
                        la señal de salida no influye sobre la señal de entrada. La exactitud de
                        estos sistemas depende de su calibración, de manera que al calibrar se
                        establece una relación entre la entrada y la salida con el fin de obtener
                        del sistema la exactitud deseada [9]. El diagrama de bloque de un
                        sistema en lazo abierto es:




                                            Figura 1: Sistema de Control en lazo abierto.


                                El sistema se controla bien directamente, o bien mediante un
                        transductor y un actuador. El esquema típico del sistema será, en este
                        caso:




                                      Figura 2: Sistema de Control en lazo abierto con actuador.


2
    Ingeniería de control moderna. Katsuhiko Ogata.
                                                                                                   9
       El transductor modifica o adapta la naturaleza de la señal de
entrada al sistema de control.
       En el caso del sistema de control de la temperatura de una
habitación, para que sea un sistema abierto es necesario que no exista
termostato, de manera que siga funcionando permanentemente. La
entrada del sistema sería la temperatura ideal de la habitación; la planta
o proceso sería la habitación y la salida sería la temperatura real de la
habitación. El transductor podría ser un dial en el que definamos el
tiempo de funcionamiento y el actuador el propio foco de calefacción
(caldera o radiador) [9].
       El actuador o accionador modifica la entrada del sistema
entregada por el transductor (normalmente amplifica la señal).
       Una lavadora automática sería un claro ejemplo de sistema de
control en lazo abierto. La blancura de la ropa (señal de salida) no
influye en la entrada. La variable tiempo presenta una importancia
fundamental: si está bien calibrada, cada proceso durará el tiempo
necesario para obtener la mejor blancura, otro ejemplo de sistema en
lazo abierto sería el alumbrado público controlado por interruptor
horario. El encendido o apagado no depende de la luz presente, sino de
los tiempos fijados en el interruptor horario.




      Figura 3: Sistema de Control en lazo abierto para el alumbrado público.


       Como vemos los sistemas de lazo abierto dependen de la
variable tiempo y la salida no depende de la entrada, erl principal
inconveniente que presentan los sistemas de lazo abierto es que son
extremadamente sensibles a las perturbaciones. Por ejemplo si en una
habitación se ha conseguido una temperatura idónea y se abre una
puerta o ventana (perturbación) entraría aire frío, de manera que el
tiempo necesario para obtener dicha temperatura sería diferente.

                                                                                10
2.1.1.2.- Sistemas de control en lazo cerrado
       Si en un sistema en lazo abierto existen perturbaciones, no se
obtiene siempre la variable de salida deseada. Conviene, por tanto,
utilizar un sistema en el que haya una relación entre la salida y la
entrada [9].
       Un sistema de control de lazo cerrado es aquél en el que la
acción de control es, en cierto modo, dependiente de la salida. La señal
de salida influye en la entrada. Para esto es necesario que la entrada sea
modificada en cada instante en función de la salida. Esto se consigue
por medio de lo que llamamos realimentación o retroalimentación
(feedback).
       La realimentación es la propiedad de un sistema en lazo cerrado
por la cual la salida (o cualquier otra variable del sistema que esté
controlada) se compara con la entrada del sistema(o una de sus
entradas), de manera que la acción de control se establezca como una
función de ambas [9] y [15].
       A veces también se le llama a la realimentación transductor de
la señal de salida, ya que mide en cada instante el valor de la señal de
salida y proporciona un valor proporcional a dicha señal.
       Por lo tanto podemos definir también los sistemas de control en
lazo cerrado como aquellos sistemas en los que existe una
realimentación de la señal de salida, de manera que ésta ejerce un
efecto sobre la acción de control.
       El diagrama de bloques correspondiente a un sistema de control
en lazo cerrado es:




                 Figura 4: Sistema de Control en lazo cerrado.
                                                                       11
       El controlador está formado por todos los elementos de control
y a la planta también se le llama proceso.
       En este esquema se observa cómo la salida es realimentada
hacia la entrada. Ambas se comparan, y la diferencia que existe entre la
entrada, que es la señal de referencia o consigna (señal de mando), y el
valor de la salida (señal realimentada) se conoce como error o señal de
error. La señal que entrega el controlador se llama señal de control o
manipulada y la entregada por la salida, señal controlada.
       El error, o diferencia entre los valores de la entrada y de la
salida, actúa sobre los elementos de control en el sentido de reducirse a
cero y llevar la salida a su valor correcto. Se intenta que el sistema siga
siempre a la señal de consigna [9].
       El diagrama de bloques anterior se puede sustituir por el
siguiente:




    Figura 5: Sistema de Control en lazo cerrado realimentado con un captador.


       La salida del sistema de regulación se realimenta mediante un
captador. En el comparador o detector de error, la señal de referencia
(salida del transductor) se compara con la señal de salida medida por el
captador, con lo que se genera la siguiente señal de error:

                                  e(t) = r(t) – b(t)                      (2 – 1)

Donde e(t) es la señal de error, r(t) la señal de referencia y b(t) la
variable realimentada. Pueden suceder dos casos:
       - Que la señal de error sea nula; en este caso la salida tendrá
exactamente el valor previsto.
                                                                                 12
         - Que la señal de error no sea nula; esta señal de error actúa
sobre el elemento regulador que a su salida proporciona una señal que,
a través del elemento accionador, influye en la planta o proceso para
que la salida alcance el valor previsto y de esta manera el valor se
anule.
         En el ejemplo de control de temperatura de una habitación, el
sistema, planta o proceso es la habitación que se quiere calentar, el
transductor puede ser un dial con el que se define el grado de
calentamiento, el actuador o accionador una caldera o un radiador y el
captador puede ser un termómetro, este último actúa como sensor
midiendo la temperatura del recinto, para que pueda ser comparada con
la de referencia [9].
         El regulador o controlador es el elemento que determina el
comportamiento del bucle, por lo que debe ser un componente diseñado
con gran precisión. Es el cerebro del bucle de control.
         Mientras que la variable controlada se mantenga en el valor
previsto, el regulador no actuará sobre el elemento accionador, pero si
el valor de la variable se aleja del prefijado, el regulador modifica su
señal, ordenando al accionador que actúe sobre la planta o proceso, en
el sentido de corregir dicho alejamiento. El termostato del ejemplo
anterior realizaría esta función.
         Los sistemas en lazo cerrado son mucho menos sensibles a las
perturbaciones que los de lazo abierto, ya que cualquier modificación
de las condiciones del sistema afectará a la salida, pero este cambio
será registrado por medio de la realimentación como un error que es en
definitiva la variable que actúa sobre el sistema de control. De este
modo, las perturbaciones se compensan, y la salida se independiza de
las mismas [9].




                                                                     13
       2.2.    CONTROL DIGITAL


                       La aplicación del control por computadora ha hecho posible el
               movimiento inteligente en robots industriales, la optimización de economía en
               combustible en automóviles y el refinamiento en la operación de enseres y
               máquinas de uso doméstico, entre otros.
                       La capacidad en la toma de decisiones y la flexibilidad en los programas
               de control son las mayores ventajas de los sistemas de control digital [16]3.
                        La figura 6 de abajo muestra el típico sistema continuo realimentado
               que hemos considerado hasta ahora. Casi la totalidad de los controladores
               continuos pueden implementarse usando electrónica analógica.




                                          Figura 6: Sistema de control en tiempo continúo.


                       El controlador analógico, encerrado en el cuadrado a trazos, puede
               reemplazarse por un controlador digital, como se muestra abajo, el cual hace la
               misma tarea de control que el controlador analógico. La diferencia básica entre
               estos controladores es que el sistema digital opera con señales discretas (o
               muestras de la señal censada) en lugar de señales continuas [16].




3
    Sistemas de control en tiempo discreto . Katsuhiko Ogata.
                                                                                               14
                            Figura 7: Sistema de control digital.




2.2.1.   Función de transferencia pulso
         La función de transferencia pulso [16] relaciona la transformada Z de la
salida en los instantes de muestreo con la correspondiente entrada muestreada.
Conociendo la función de transferencia G(s) = y(s)/u(s) de un sistema, la
correspondiente función de transferencia de pulso se determina de la relación:

          𝑌(𝑧)                                1−𝑒 −𝑠𝑇                            𝐺(𝑠)
          𝑈(𝑧)
                 = 𝐺(𝑧) = 𝑍[𝐺𝑟0 𝐺(𝑠)] = 𝑍 [     𝑠
                                                      𝐺(𝑠)]   = (1 − 𝑧 −1 )𝑍 [    𝑠
                                                                                      ]   (2 – 2)


         Para el caso multivariables, la matriz de transferencia de pulso G(z) se
determina empleando la relación (2-2) para cada elemento de la matriz de
transferencia G(s). Para derivar la función de transferencia de pulso para el caso
de procesos en cascada o formando lazos cerrados, debemos proceder con
cautela, porque no siempre es posible encontrar una relación de la forma 𝑦(𝑧) =
𝐺(𝑧)𝑢(𝑧) [16].


2.2.2.    Modelo en el espacio de estados.
         Para sistemas de tiempo discreto variantes en el tiempo la ecuación de
estado [16] se puede escribir como:

                                                                                              15
                         𝑥(𝑘 + 1) = 𝑓[𝑥(𝑘), 𝑢(𝑘), 𝑘]                       (2 – 3)
         Y la ecuación de salida como:
                           𝑦(𝑘) = 𝑔[ 𝑥(𝑘), 𝑢(𝑘), 𝑘]                            (2 - 4)
                  Si el sistema es lineal, la ecuación de estado y salida se
         representan como:
                             𝑥(𝑘 + 1) = 𝐺(𝑘)𝑥(𝑘) + 𝐻(𝑘)𝑢(𝑘)                (2 – 5)
                               𝑦(𝑘) = 𝐶(𝑘)𝑥(𝑘) + 𝐷(𝑘)𝑢(𝑘)                  (2 – 6)
          𝑑𝑜𝑛𝑑𝑒 ∶
          𝑥(𝑘) = 𝑣𝑒𝑐𝑡𝑜𝑟 𝑑𝑒 𝑒𝑠𝑡𝑎𝑑𝑜 𝑛
          𝑦(𝑘) = 𝑣𝑒𝑐𝑡𝑜𝑟 𝑑𝑒 𝑠𝑎𝑙𝑖𝑑𝑎 𝑚
          𝑢(𝑘) = 𝑣𝑒𝑐𝑡𝑜𝑟 𝑑𝑒 𝑒𝑛𝑡𝑟𝑎𝑑𝑎 𝑟
          𝐺(𝑘) = 𝑚𝑎𝑡𝑟𝑖𝑧 𝑑𝑒 𝑒𝑠𝑡𝑎𝑑𝑜 𝑑𝑒 𝑜𝑟𝑑𝑒𝑛 𝑛𝑥𝑛
          𝐻(𝑘) = 𝑚𝑎𝑡𝑟𝑖𝑧 𝑑𝑒 𝑒𝑛𝑡𝑟𝑎𝑑𝑎 𝑑𝑒 𝑜𝑟𝑑𝑒𝑛 𝑛𝑥𝑟
          𝐶(𝑘) = 𝑚𝑎𝑡𝑟𝑖𝑧 𝑑𝑒 𝑠𝑎𝑙𝑖𝑑𝑎 𝑑𝑒 𝑜𝑟𝑑𝑒𝑛 𝑚𝑥𝑛
          𝐷(𝑘) = 𝑚𝑎𝑡𝑟𝑖𝑧 𝑑𝑒 𝑡𝑟𝑎𝑛𝑠𝑓𝑒𝑟𝑒𝑛𝑐𝑖𝑎 𝑑𝑖𝑟𝑒𝑐𝑡𝑎 𝑑𝑒 𝑜𝑟𝑑𝑒𝑛 𝑚𝑥𝑟
         Si el sistema es invariante en el tiempo, entonces:


                                  𝑥(𝑘 + 1) = 𝐺𝑥(𝑘) + 𝐻𝑢(𝑘)                 (2 – 7)
                                   𝑦(𝑘) = 𝐶𝑥(𝑘) + 𝐷𝑢(𝑘)                    (2 – 8)


2.2.3.   Representación en el espacio de estados de sistemas en tiempo
          discreto.
         Formas canónicas para las ecuaciones en espacio de estado de sistemas
discretos [16].
          Consideremos el siguiente sistema en tiempo discreto:

              𝑦(𝑘) + 𝑎1 𝑦(𝑘 − 1) + 𝑎2 𝑦(𝑘 − 2) + ⋯ + 𝑎𝑛 𝑦(𝑘 − 𝑛) = 𝑏0 𝑢(𝑘) +
               ⋯ + 𝑏𝑛 𝑢(𝑘 − 𝑛)                                                 ( 2-9 )
          Donde u(k) es la entrada y y(k) es la salida en el instante de muestreo
          k, al escribir en forma de función de transferencia pulso tenemos:
                       𝑌(𝑘)       𝑏0 +𝑏1 𝑧 −1 +⋯+𝑏𝑛 𝑧 −𝑛
                              =                                           (2 – 10)
                       𝑈(𝑘)       1+𝑎1 𝑧 −1 +⋯+𝑎𝑛 𝑧 −𝑛


                                                                                   16
            Dentro de las formas de expresar representaciones en espacio de
            tiempo discreto tenemos:


            Forma canónica Controlable .Se expresa mediante las siguientes
            ecuaciones:
  𝑥1 (𝑘 + 1)       0          1       0      …  0      𝑥1 (𝑘)    0
  𝑥2 (𝑘 + 1)       0          0       1      …  0      𝑥2 (𝑘)    0.
       .           .          .       .      .  .         .
       ..      =                                          ..   + .. u(k)     (2 – 11)
                   .          .       .      .  .
 𝑥𝑛−1 (𝑘̇ + 1)     0          0       0      …  1 𝑥𝑛−1 (𝑘) 0
[ 𝑥𝑛 (𝑘 + 1) ]   [−𝑎𝑛       −𝑎𝑛−1   −𝑎𝑛−2    … −𝑎1 ] [ 𝑥𝑛 (𝑘) ] [1]


                                                           𝑥1 (𝑘)
                                                           𝑥2(𝑘)
                                                              .
 𝑦 = [𝑏𝑛 − 𝑎𝑛 𝑏0   | 𝑏𝑛−1 − 𝑎𝑛−1 𝑏0   | … | 𝑏1 − 𝑎1 𝑏0 ]      ..    + 𝑏0 𝒖 (2 – 12)
                                                          𝑥𝑛−1 (𝑘)
                                                         [ 𝑥𝑛 (𝑘) ]


            Forma Canónica observable .La siguiente representación en el espacio
            de estados discreto se denomina forma canónica observable:


   𝑥1 (𝑘 + 1)     0   0 …       0 −𝑎𝑛     𝑥1 (𝑘)         𝑏𝑛 − 𝑎𝑛 𝑏0
   𝑥2 (𝑘 + 1)     1   0 ….      0 −𝑎𝑛−1 𝑥2 (𝑘)         𝑏𝑛−1 − 𝑎𝑛−1 𝑏0
        .
                  .   .  .      .   .        .                .
        ..      =                            ..    +          ..        𝑢(𝑘) (2 – 13)
                  .   .  .      .   .
  𝑥𝑛−1 (𝑘̇ + 1)   0   0 …       0 −𝑎2 𝑥𝑛−1 (𝑘)                 .
 [ 𝑥𝑛 (𝑘 + 1) ] [0    0 …                𝑥
                                1 −𝑎1 ] [ 𝑛  (𝑘) ]   [   𝑏1 −   𝑎1 𝑏0 ]


                                                     𝑥1 (𝑘)
                                                     𝑥2(𝑘)
                                                        .
                   𝑦 = [0    | 0    | … |     1]        ..      + 𝑏0 𝒖     (2 – 14)
                                                    𝑥𝑛−1 (𝑘)
                                                   [ 𝑥𝑛 (𝑘) ]
                    Observe que la matriz de estado de nxn de la ecuación de estado
            obtenida mediante la ecuación (2-11) es la transpuesta de la ecuación
            de estado definida mediante la ecuación (2-13) [16].



                                                                                  17
                        Forma canónica diagonal. Si los polos de la función de transferencia
                        pulso son todos distintos entonces la representación en el espacio se
                        puede representar como sigue:


                          𝑥1 (𝑘 + 1)     𝑝1       0        …       0 0 𝑥1 (𝑘)          1
                          𝑥2 (𝑘 + 1)
                               .         0        𝑝2       ….      0 0 𝑥2 (𝑘)  .       1.
                               ..      = .         .        .      . .         ..    + .. 𝑢(𝑘) (2-15)
                                          .        .        .      . .
                         𝑥𝑛−1 (𝑘̇ + 1)   0        0        …       0 0 𝑥𝑛−1 (𝑘)         .
                        [ 𝑥𝑛 (𝑘 + 1) ] [ 0        0        …       0 𝑝𝑛 ] [ 𝑥𝑛 (𝑘) ]  [1  ]


                                                                     𝑥1 (𝑘)
                                                                     𝑥2 (𝑘)
                                                                        .
                                     𝑦 = [𝑐1    𝑐2     …    𝑐𝑛 ]        ..      + 𝑏0 𝒖        (2-16)
                                                                    𝑥𝑛−1 (𝑘)
                                                                   [ 𝑥𝑛 (𝑘) ]

              2.2.4.    Discretización de las ecuaciones en espacio de tiempo continuo.
                       En el control digital de procesos es necesario convertir la ecuación en el
              espacio de estados en tiempo continuo en ecuaciones en el espacio de estados
              en tiempo discreto, se puede realizar dicha conversión si se introducen
              muestreadores y dispositivos de retención ficticios, el error introducido por la
              discretización se puede hacer despreciar utilizando un periodo de muestreo
              suficientemente pequeño en comparación con la constante más significativa del
              sistema [1]4.
                       Analizando el sistema tenemos:
                                                                        𝑇
                              𝑥(𝑘 + 1) = 𝑒 𝐴𝑇 𝑥(𝑘𝑇) + 𝑒 𝐴𝑇 ∫0 𝑒 −𝐴𝑇 𝐵𝑢(𝑘𝑇)𝑑𝑡                   (2-17)
                        ℎ𝑎𝑐𝑖𝑒𝑛𝑑𝑜 𝜆 = 𝑇 − 𝑡 .
                                                                            𝑇
                                   𝑥(𝑘 + 1) = 𝑒 𝐴𝑇 𝑥(𝑘𝑇) + 𝑒 𝐴𝑇 ∫0 𝑒 𝜆𝑇 𝐵𝑢(𝑘𝑇)𝑑 𝜆              (2-18)
                        Por tanto:
                                                           𝐺(𝑇) = 𝑒 𝐴𝑇                         (2-19)


                                                                    𝑇
                                                     𝐻(𝑇) = (∫0 𝑒 𝜆𝑇 𝑑 𝜆)B                   (2 – 20)


4
    Control Avanzado - Diseño y aplicaciones en tiempo real. Arturo Rojas Moreno.
                                                                                                  18
                       Entonces la ecuación (2 – 18) se convierte en:
                                     𝑥((𝑘 + 1)𝑇) = 𝐺(𝑇)𝑥(𝑘𝑇) + 𝐻(𝑇)𝑢(𝑘𝑇)                 (2 – 21)


                       Y la ecuación de salida se convierte en :
                                              𝑦(𝑘𝑇) = 𝐶𝑥(𝑘𝑇) + 𝐷𝑢(𝑘𝑇)                    (2 – 22)
                       Donde C y D son matrices constantes y no dependen del periodo de
                       muestreo T.



       2.3.   CONTROL ADAPTATIVO


                      Los sistemas de control adaptivo ajustan su comportamiento a las
              cambiantes propiedades del proceso controlado y de las señales que interactúan
              sobre dicho proceso. Por el contrario, los sistemas de control fijos se
              caracterizan por la presencia de una ley de control invariable con el tiempo
              [23]5. La investigación sobre controladores adaptivos se ha centrado en dos
              grupos principales: controladores adaptivos con un modelo referencial (MRAC)
              y controladores con autosintonización (STR) [14],[23].
                      La característica fundamental que distingue a los controladores
              adaptivos es la presencia de un bucle de control en el que se compara un índice
              de funcionamiento. En la figura 8 puede verse que está compuesto de un bucle
              principal de realimentación negativa, en el que actúa al igual que en los
              sistemas convencionales un regulador y de otro bucle que mide un cierto índice
              de funcionamiento el cual es comparado con índice deseado y se procesa el
              error en un mecanismo de adaptación que ajusta los parámetros del regulador
              [5],[14]6 ,[23] y [25].




5
    Control Adaptivo y Robusto. Rodríguez Rubio Francisco, Manuel Jesús López Sánchez.
6
    Adaptative Control. Karl J. Astrom,Bjorn Wittenmark .
                                                                                              19
                    Figura 8: Configuración básica del control Adaptivo.


       Los esquemas básicos más utilizados se presentan a continuación:


2.3.1. Programación de ganancias.
       En algunos sistemas existen variables auxiliares que describen bien las
características de la dinámica del proceso. Si estas variables pueden ser
medidas, estas variables pueden ser usadas para cambiar los parámetros del
regulador, es decir se utilizan para acomodar los cambios en la ganancia del
proceso. Este método de programar ganancias se presenta en la figura 9 [5],
[14],[23].




               Figura 9:   Sistema de programación de ganancias.



                                                                           20
         El ajuste de ganancia es una compensación en lazo abierto y puede ser
visto como un sistema con control de realimentación en el cual el lazo de
realimentación es ajustado en compensación directa. Esto reduce los efectos de
la variación de parámetros.


2.3.2.   Control Adaptativo con referencia a modelo (MRAC)
         Los controladores adaptivos con modelo de referencia intentan alcanzar
para un señal de entrada definida, un comportamiento en bucle cerrado dado
por un modelo de referencia, estos fueron diseñados primeramente para
sistemas continuos por minimización de un índice de actuación. Las
especificaciones del diseño del controlador son dadas en términos de un modelo
de referencia donde la salida deberá seguir a la referencia. El esquema que
representa el control MRAC se presenta en la figura 10 [5], [23].




                          Figura 10:   Esquema del MRAC.


         En este caso el modelo está en paralelo con el sistema. El regulador está
formado por dos lazos: un lazo interno de realimentación ordinaria compuesta
por la planta y el regulador y un lazo externo que ajusta los parámetros del
regulador de tal forma que el error entre la salida de la planta y, y la referencia
Ym sea pequeño, convirtiendo al lazo externo en un lazo regulador. El
problema clave es determinar un mecanismo de ajuste tal que el sistema sea
estable y lleve el error a cero.


                                                                                21
2.3.2.1.- Enfoque de sensibilidad
        Este método está basado en el uso de los modelos de
sensibilidad para adaptar los parámetros en la dirección correcta [23].
La deducción de este método comienza con el planteamiento de un
índice de actuación, normalmente cuadrático:


                                           𝑡+𝑇
                          𝒥(𝑡 + 𝑇) = ∫𝑡            𝑒 2 (𝜏)𝑑𝜏                      (2 – 23)


        En esta ecuación 𝑒1 = 𝑦𝑝 − 𝑦𝑚 y el índice 𝒥 se evalua sobre
el periodo T fijo, en el cual los parámetros permanecen constantes. En
el instante (t + T) los parámetros son ajustados en la dirección
decreciente de 𝒥.


                                𝜕𝒥                   𝑡+𝑇             𝜕𝑒1 (𝜏)
       𝜃(𝑡 + 𝑇) = 𝜃(𝑡) − Г 𝜕𝜃 = 𝜃(𝑡) − Г ∫𝑡                2𝑒1 (𝜏)             𝑑𝜏 (2 – 24)
                                                                       𝜕𝜃


Г Debe ser una matriz cuadrada definida positiva, que representa la
ganancia de adaptación, usualmente es diagonal, teniendo en cuenta
que:
                                     𝜕𝑒1 (𝜏)       𝜕𝑦𝑝
                                               =                                  (2 – 25)
                                      𝜕𝜃            𝜕𝜃
La ecuación (2 - 25) queda:


                  𝜃(𝑡+𝑇)−𝜃(𝑡)          1   𝑡+𝑇               𝜕𝑦𝑝
                                = − ∫𝑡           2𝑒1 (𝜏)            𝑑𝜏            (2 – 26)
                      𝑇            Г                           𝜕𝜃
Que en el límite para T → 0 da la ley de adaptación:
                                𝑑𝜃                    𝜕𝑦𝑝
                                     = −2Г𝑒1                                      (2 – 27)
                                𝑑𝑡                    𝜕𝜃


            𝜕𝑦𝑝
El factor          representa la sensibilidad de la salida del proceso a las
             𝜕𝜃

variaciones en 𝜃 , y puede ser generado por un modelo de sensibilidad.
Como puedeobservarse esta ley de adaptación es la misma que la
denominada regla del MIT [5], [23].

                                                                                       22
El modelo de sensibilidad anterior se sustituye por la sensibilidad del
modelo de referencia, dado que normalmente el modelo del proceso se
desconoce. Esta suposición se hace en base a que pasado un tiempo la
respuesta del sistema converge a la respuesta del modelo de referencia.
       La principal desventaja de este método, es la ausencia de un
criterio que garantice la estabilidad del sistema de control. El sistema
puede hacerse inestable si el modelo de referencia no se escoge
adecuadamente o si la ganancia de adaptación se elige demasiado
grande.

2.3.2.2.- Método de Lyapunov
       Dado el carácter no lineal y variable en el tiempo de los
sistemas adaptativos por modelo de referencia MRAC, no son válidos
los criterios de estabilidad de sistemas lineales. Un método bien
conocido es el método directo de Lyapunov [23].
          Este método establece que un sistema tiene un equilibrio x = 0,
asintóticamente estable, si existe una función, llamada de Lyapunov, V
(x) que satisface:
   𝑉(𝑥) > 0 𝑝𝑎𝑟𝑎 𝑥 ≠ 0 𝑑𝑒𝑓𝑖𝑛𝑖𝑑𝑎 𝑝𝑜𝑠𝑖𝑡𝑖𝑣𝑎
   𝑉(𝑥) < 0 𝑝𝑎𝑟𝑎 𝑥 ≠ 0̇ 𝑑𝑒𝑓𝑖𝑛𝑖𝑑𝑎 𝑛𝑒𝑔𝑎𝑡𝑖𝑣𝑎                        (2 – 28)
   𝑉(𝑥) → ∞ 𝑝𝑎𝑟𝑎 ‖𝑥‖ → ∞
   𝑉(0) = 0


       Como la función de Lyapunov es similar a una función de
energía, esta debe decrecer con el tiempo. Utilizando este método en el
diseño de sistemas adaptativos, se trasladan las especificaciones de
estabilidad directamente en la ley de adaptación, siguiendo los pasos:
1. El primer paso es encontrar la ecuación de error, bien en la salida
(𝑦𝑝 − 𝑦𝑚 ) o en las variables de estado (𝑥𝑝 − 𝑥𝑚 ).


2. Encontrar una función de Lyapunov como una función del error entre
las señales y del error en los parámetros ( 𝜑 = 𝜃̂ − 𝜃 ).

                                                                         23
  En su forma más simple esta función toma la forma:
                      𝑉 = 𝑒 𝑇 𝑃𝑒 + 𝜑 𝑇 Г−1 𝜑                        (2 – 29)
  Donde las matrices P y Г−1 deben ser definidas positivas.


3. Calcular la derivada de la función de Lyapunov. La derivada debe ser
definida negativa. Generalmente toma la forma:
         𝑉̇ = −𝑒 𝑇 𝑄𝑒 + 𝑎𝑙𝑔𝑢𝑛𝑜𝑠 𝑡𝑒𝑟𝑚𝑖𝑛𝑜𝑠 𝑖𝑛𝑐𝑙𝑢𝑦𝑒𝑛𝑑𝑜 𝜑                (2 -30)
       El primer término garantiza que la derivada es definida
negativa, por lo que, haciendo el resto igual a cero se tiene una posible
solución. La matriz Q es definida positiva. Las matrices P y Q, para un
sistema gobernado por una matriz A, están relacionadas por la ecuación
de Lyapunov:
                                  −𝑄 = 𝐴𝑇 𝑃 + 𝑃𝐴                     (2 -31)
4. Haciendo el término extra igual a cero se obtiene la ley de
adaptación, normalmente tiene la forma:

                                      𝜃̇ = −Г𝜀𝜉                      (2 -32)

𝜀 Está directamente relacionado con el error e y 𝜉 es una versión
modificada del vector de señales (referencia, salida, etc.) [23].


2.3.2.3.- Método de Hiperestabilidad
       Con este método también se consigue una ley de adaptación
estable. Como en el método de Lyapunov, en primer lugar se formulan
las ecuaciones de error. Estas ecuaciones se dividen en una parte lineal
invariable con el tiempo y otra no lineal y variable con el tiempo. La
primera parte contiene usualmente al modelo de referencia y su salida
es la señal de error que es utilizada para la ley de adaptación. La
segunda parte contiene la ley de adaptación y su salida negada es la
entrada a la parte lineal [23].
       La teoría de hiperestabilidad garantiza la estabilidad asintótica
si ambas partes (lineal y no lineal), satisfacen las condiciones de
pasividad (Landau 1979):

                                                                         24
         1. La parte lineal (llámese G(s)), debe ser estrictamente positiva.
              Ello significa que:
           (a) G(s) debe ser real si s es real.
           (b) los polos de G(s) deben tener parte real negativa, y
           (c) la parte real de 𝐺(𝑗𝜔) de ser mayor que cero para −∞ < 𝜔 < ∞.


         2. La parte no lineal debe cumplir la desigualdad de Popov.


                                 𝑇
                               ∫0 𝑣 𝑇 𝜔𝑑𝑡 ≥ −𝛾 2        ; ∀𝑡 > 0          (2 – 33)


         Siendo v el vector de entrada y w el vector de salida de la parte no
         lineal, y una constante finita positiva que no depende de t.


2.3.3.   Regulador Auto-sintonizable.
         Estos reguladores tratan de alcanzar un control óptimo sujeto a un tipo
de controlador y a obtener información del proceso [23], este regulador está
compuesto por dos lazos:
         Un lazo interno de realimentación ordinaria y un lazo externo que
actualiza los parámetros del proceso o del regulador por medio de identificación
de sistemas. Pueden ser aplicados a muchos problemas de control que no son
formulados como un problema de control estocástico [14]. El diagrama de
bloques se muestra en la figura 11.




                            Figura 11: Esquema    del STR.

                                                                               25
       Si los parámetros del proceso varían con el tiempo, ya sea por derivas o
desgastes de las constantes físicas, o bien porque el proceso es no lineal y se
modifica el punto de funcionamiento en el que estamos trabajando, el
controlador calculado para un punto de funcionamiento concreto, no será el
adecuado para este tipo de situaciones.
       Cuando nos enfrentamos con este tipo de problemas, podemos plantear
una estructura de control que además del bucle principal de regulación que
existe en todo sistema de control, incorpore un segundo bucle de control, en el
que a partir de la información recogida del proceso y con un determinado
criterio de diseño, se modifiquen los parámetros del regulador [23].
         En este caso, se comienza con un método de diseño para sistemas con
parámetros conocidos, sustituyendo posteriormente los parámetros conocidos
por sus estimados y recalculando el controlador en cada paso. La aplicación de
esta idea es lo que se conoce como el principio de equivalencia cierta [23], [35].
       El diagrama de bloques de estos controladores se puede ver en la figura
11; en el que se distinguen tres partes claramente diferenciadas:
            Un algoritmo recursivo de estimación de parámetros
            Un mecanismo de adaptación que desarrolla la tarea de diseño
               del regulador y
            Un regulador con parámetros ajustables.
       Estos reguladores conforman una estructura sub óptima basada en el
principio de separación de las tareas de control e identificación [5],[23].
       La idea de los reguladores autoajustables puede ser aplicada a muchos
problemas de control que no son formulados como un problema de control
estocástico. Dada la modularidad y la separación del control e identificación,
pueden formarse muchas clases de reguladores autoajustables por combinación
de diferentes métodos de diseño e identificadores.
       En cuanto al modelo de la planta, supondremos en general, que sobre el
sistema actúan perturbaciones estocásticas, por lo que el proceso estará descrito
por su modelo ARMAX [17], de la siguiente forma:


                               𝐵(𝑧 −1 ) −𝑑         𝐶(𝑧 −1 )
                      𝑦(𝑘) =            𝑧 𝑢(𝑘)   + 𝐴(𝑧 −1 ) 𝑣(𝑘)              (2 -34)
                               𝐴(𝑧 −1 )

                                                                                  26
Donde los distintos polinomios y variables tienen el siguiente significado:


                      𝐴(𝑧 −1 ) = 1 + 𝑎1 𝑧 −1 + 𝑎2 𝑧 −2 + ⋯ + 𝑎𝑛 𝑧 −𝑛
                      𝐵(𝑧 −1 ) = 𝑏1 𝑧 −1 + 𝑏2 𝑧 −2 + ⋯ + 𝑏𝑛 𝑧 −𝑛              (2 – 35)
                       𝐶(𝑧 −1 ) = 1 + 𝑐1 𝑧 −1 + 𝑐2 𝑧 −2 + ⋯ + 𝑐𝑛 𝑧 −𝑛


    Siendo y(k) la secuencia de salida, u(k) la señal de control del sistema, v(k) una
    señal aleatoria independiente con distribución gaussiana 𝑁(0, 𝜑), des el retardo
    del sistema y 𝑧 −1 es el operador retardo tal que 𝑦(𝑘) = 𝑧 −1 𝑦(𝑘 + 1).
            En cuanto al criterio de diseño, pueden dividirse en dos tipos, según el
    planteamiento del problema sea: estocástico o no estocástico. Cuando el
    planteamiento es estocástico, se consideran sistemas cuyas señales no se pueden
    conocer exactamente y tampoco se pueden predecir.
            En el diseño con planteamiento estocástico, normalmente se minimiza
    un cierto índice de actuación, como por ejemplo para el caso de mínima
    varianza, se trata de minimizar las variaciones con respecto a cero, ya que se
    trata de un problema de regulación.

                                  𝒥 = 𝐸{𝑦 2 (𝑘 + 𝑑 + 1)}                      (2 – 36)
    O bien puede plantearse un índice más general de la forma:

                     𝒥 = 𝐸{(𝑃𝑦(𝑘 + 𝑑 + 1) + 𝑄𝑢(𝑘) − 𝑅𝑟(𝑘))2 }                 (2 – 37)

            Mediante el planteamiento no estocástico, se considera que las
    perturbaciones que inciden sobre un sistema son exactamente conocidas,
    pudiéndose describir estos sistemas analíticamente por medio de un sistema
    dinámico determinista.
            En este caso el índice de actuación se da en función de unas
    especificaciones que debe cumplir la salida del sistema, lo que normalmente se
    traduce en especificar una función de transferencia deseada en bucle cerrado,
    como es el caso de asignación de polos. En la actualidad, se ha demostrado en
    numerosos casos, que ambos planteamientos conducen a resultados similares
    [23].

                                                                                   27
2.3.3.1.- Asignación de Polos y ceros
        Astrom y Wittenmark (1980) proponen una estructura de
control con diseño por asignación de polos como la dada en la figura
12. Esta estructura puede interpretarse como un compensador en
adelanto y un compensador en bucle cerrado.
        También puede demostrarse que dicha estructura corresponde a
un controlador lineal por realimentación del estado y a un observador.
La ley de control puede diseñarse para unos polos deseados del sistema
en bucle cerrado, preservando los ceros inestables del sistema en bucle
abierto [5], [23].




         Figura 12: Estructura de control por asignación de polos y ceros.


        El problema que se plantea consiste en hacer que la función de
transferencia, desde la salida a la referencia, del sistema (figura 12), sea
de la forma:
                                        𝑅𝑚
                              𝑦(𝑘) =         𝑧 −𝑑 𝑤(𝑘)                       (2 – 38)
                                        𝑃𝑚



Donde los polinomios Rm y Pm no tienen factores comunes y el grado
de Pm es mayor o igual a Rm. Esto permitirá dar las especificaciones
del problema de seguimiento en términos de la respuesta deseada a una
señal de referencia. También habrá que especificar la dinámica del
observador mediante el polinomio Ao .



                                                                                  28
          El método de diseño elegido es el de síntesis algebraica
directa. La solución consiste básicamente en resolver una ecuación
polinomial con ciertas restricciones en los órdenes de los polinomios
para asegurar que el regulador propuesto sea causal y con realización
mínima [23].
       A partir de la figura 12, la función de transferencia en bucle
cerrado que se obtiene es:


                    𝑆𝐵𝑧 −𝑑                   𝐶𝑀
       𝑦(𝑘) =                𝑤(𝑘) +                   𝑣(𝑘)     (2 – 39)
                 𝐴𝑀+𝐵𝐺𝑧 −𝑑                𝐴𝑀+𝐵𝐺𝑧 −𝑑



Factorizando B como 𝐵 − 𝐵+ , donde el superíndice – corresponde a los
ceros inestables y el + a los ceros estables, tenemos:


                             𝑅𝑚 = 𝐵 − 𝑅𝑚1
                             𝑀 = 𝑀1 𝐵 +                        (2 – 40)
                             𝑆 = 𝐴0 𝑅𝑚1


La ecuación característica del bucle cerrado es de la forma:


       𝐴𝑀 + 𝐵𝐺𝑧 −𝑑 = 𝐴𝑀1 𝐵 + + 𝐵 − 𝐵 + 𝐺𝑧 −𝑑 = 𝐵 + 𝐴0 𝑃𝑚       (2 – 41)


       Luego dicha ecuación tiene como ceros suyos, los ceros estables
del sistema en bucle abierto, los ceros del observador y los polos del
modelo deseado. La estructura del regulador diseñado puede
interpretarse como seguimiento a un modelo de referencia, para obtener
S/M y sustituyendo en la expresión del regulador [23].


                             1
                    𝑢(𝑘) = 𝑀 (𝑆𝑤(𝑘) − 𝐺𝑦(𝑘))                   (2 – 42)

       Se tiene que:


                       𝐴              𝐺
               𝑢(𝑘) = 𝐵 𝑦𝑟 (𝑘 + 𝑑) + 𝑀 (𝑦𝑟 (𝑘) − 𝑦(𝑘))         (2 – 43)

                                                                    29
Que corresponde a la estructura de la figura:




             Figura 13: Interpretación como modelo de referencia.


         En dicha estructura se puede observar que el regulador está
compuesto de dos partes, un controlador en adelanto (feedforward) y un
controlador en bucle cerrado.
         Si la señale es igual a cero, la acción del bloque G/M desaparece
y la relación que liga la entrada con la salida es justamente el modelo
de referencia (2-38). Por otro lado es de notar que el bloque A/B no es
realizable pero s lo es 𝑅𝑚 𝐴/𝑃𝑚 𝐵 [23].


2.3.3.2.- Predicción Óptima
         El problema de control estocástico está íntimamente ligado con
el de predicción. Por ello vamos a desarrollar el predictor óptimo
(Astrom 1970, Wittenmark 1974), de d pasos de la salida de un sistema,
el cual será necesario posteriormente [23].
Dado el proceso estocástico en tiempo discreto:


         𝐴(𝑧 −1 )𝑦(𝑘 + 𝑑) = 𝐵(𝑧 −1 )𝑢(𝑘) + 𝐶(𝑧 −1 )𝑣(𝑘 + 𝑑)         (2 – 44)


Dónde:
           𝐴(𝑧 −1 ) = 1 + 𝑎1 𝑧 −1 + 𝑎2 𝑧 −2 + ⋯ + 𝑎𝑛 𝑧 −𝑛
           𝐵(𝑧 −1 ) = 𝑏1 𝑧 −1 + 𝑏2 𝑧 −2 + ⋯ + 𝑏𝑛 𝑧 −𝑛               (2 –45 )
           𝐶(𝑧 −1 ) = 1 + 𝑐1 𝑧 −1 + 𝑐2 𝑧 −2 + ⋯ + 𝑐𝑛 𝑧 −𝑛
                                                                         30
               Consideramos el problema de encontrar la predicción de la
      salida en el instante k + d con la información disponible en el instante
      k, tal que la esperanza matemática de y(k + d) - y(k + d/k) al cuadrado
      sea mínima, siendo y(k) la secuencia de salida, u(k) la señal de control
      del sistema y v(k) una señal aleatoria independiente con distribución
      gaussiana 𝑁(0, 𝜎) [23].


      Predictor Óptimo [23]
      La ecuación del sistema 2 – 44 puede escribirse como:
                                    𝐵(𝑧 −1 )                𝐶(𝑧 −1 )
                 𝑦(𝑘 + 𝑑) =               −1 )
                                               𝑢(𝑘) +                  𝑣(𝑘 + 𝑑)        (2 – 46)
                                    𝐴(𝑧                     𝐴(𝑧 −1 )

      Tomando la esperanza matemática del error de predicción.
                  𝐸(𝑦(𝑘 + 𝑑) − 𝑦̂(𝑘 + 𝑑⁄𝑘))2 =
                                                                               2
                  𝑧 −1 𝐺        𝐵𝐹
   𝐸 (𝐹𝑣(𝑘 + 𝑑) +        𝑦(𝑘) +    𝑢(𝑘) − 𝑦̂(𝑘 + 𝑑 ⁄𝑘 )) =
                    𝐶            𝐶
                                                                                   2
                  2  𝑧 −1 𝐺        𝐵𝐹
= 𝐸(𝐹𝑣(𝑘 + 𝑑)) + 𝐸 (        𝑦(𝑘) +    𝑢(𝑘) − 𝑦̂(𝑘 + 𝑑 ⁄𝑘)) +
                       𝐶           𝐶

                       𝑧 −1 𝐺            𝐵𝐹
    2𝐸 (𝐹𝑣(𝑘 + 𝑑) (             𝑦(𝑘) +         𝑢(𝑘) − 𝑦̂(𝑘 + 𝑑⁄𝑘)))                     (2 -47)
                         𝐶                𝐶


               El último termino es cero puesto que v(k +d) es independiente,
      y sobre el primer término no podemos influir, luego la mejor predicción
      de la salida se obtiene igualando a cero el segundo término, con lo que
      resulta que:
                                  𝑧 −1 𝐺(𝑧 −1 )             𝐵(𝑧 −1 )𝐹(𝑧 −1 )
               𝑦̂(𝑘 + 𝑑 ⁄𝑘 ) =                    𝑦(𝑘) +                       𝑢(𝑘)    (2 – 48)
                                    𝐶(𝑧 −1 )                    𝐶(𝑧 −1 )

      O bien
                                     𝐺(𝑧 −1 )              𝑧𝐵(𝑧 −1 )𝐹(𝑧 −1 )
                 𝑦̂(𝑘 + 𝑑⁄𝑘 ) =                 𝑦(𝑘) +                         𝑢(𝑘)     (2 -49)
                                     𝐶(𝑧 −1 )                  𝐶(𝑧 −1 )

      siendo el error de predicción .

               𝑦(𝑘 + 𝑑 + 1) − 𝑦̂(𝑘 + 𝑑 + 1⁄𝑘) = 𝐹(𝑧−1 )𝑣(𝑘 + 𝑑 + 1)                     (2 -50)




                                                                                            31
2.3.3.3.- Regulación de mínima Varianza.
         Este regulador óptimo pretende reducir el efecto de las
perturbaciones sobre la salida. Para ello la estrategia de control consiste
en calcular la señal de control u(k), como una función de los valores
disponibles en ese instante, o sea, 𝑢(𝑘 − 1), 𝑢(𝑘 − 2), … , 𝑦(𝑘), 𝑦(𝑘 −
1), …, de tal forma que se minimice el criterio:


                              𝐽 = 𝐸 (𝑦 2 (𝑘 + 𝑑⁄𝑘))                 (2 -51)


         Se supone que sobre el sistema actúan perturbaciones
estocásticas, por lo que el proceso estará descrito por su modelo
ARMA [17], [23], de la siguiente forma:

         𝐴(𝑧 −1 )𝑦(𝑘 + 𝑑) = 𝐵(𝑧 −1 )𝑢(𝑘) + 𝐶(𝑧 −1 )𝑣(𝑘 + 𝑑)         (2 -52)


Donde los distintos polinomios y variables tienen el significado dado
en el apartado anterior.


El mínimo valor se obtendrá cuando:

                                       𝑧 −1 𝐺(𝑧 −1 )
                           𝑢(𝑘) = − 𝐹(𝑧 −1 )𝐵(𝑧 −1 ) 𝑦(𝑘)           (2 -53)

𝑜 𝑏𝑖𝑒𝑛
                                          𝐺(𝑧 −1 )
                           𝑢(𝑘) = − 𝑧𝐵(𝑧 −1 )𝐹(𝑧 −1 ) 𝑦(𝑘)          (2 -54)




         A la vista de las expresiones obtenidas y comparándolas con la
deducción del predictor optimo en el apartado anterior, se puede
interpretar el problema del regulador de mínima varianza como la
determinación del predictor y busca la señal de control tal que la
predicción coincida con la salida, en este caso 𝑦̂(𝑘 + 𝑑 ⁄𝑘) = 0.




                                                                        32
2.3.3.4.- Control Predictivo Generalizado
       El Control predictivo generalizado (GPC) fue propuesto por
Clarke et al. (Clarke 1987a) [14],[23], y se ha convertido en uno de los
métodos más populares en el ámbito del Control Predictivo tanto en el
mundo industrial como en el académico. Se ha empleado con éxito en
numerosas aplicaciones industriales (Clarke 1988), mostrando buenas
prestaciones, a la vez que un cierto grado de robustez respecto a
sobreparametrización o retardos mal conocidos. Puede resolver muchos
problemas de control diferentes para un amplio campo de procesos con
un número razonable de variables de diseño que son especificadas por
el operario dependiendo del conocimiento previo del proceso y de los
objetivos de control.
       Pero a pesar de este éxito en la práctica, este método adolece de
la ausencia de un análisis teórico completo que estudie la influencia de
los parámetros de diseño (horizontes, secuencias de ponderación) sobre
la estabilidad del bucle cerrado así como de resultados de robustez.
       La idea básica del GPC es calcular una secuencia de futuras
acciones de control de tal forma que minimice una función de coste
multipaso. El índice a minimizar es la esperanza matemática de una
función cuadrática que mide por un lado la distancia entre la salida
predicha del sistema y una cierta trayectoria de referencia hasta el
horizonte de predicción, y por otro el esfuerzo de control necesario para
obtener dicha salida. Esta idea ha sido usada para la obtención de un
controlador por asignación de polos generalizado que pertenece a la
clase de los controladores de horizonte extendido y es una extensión de
los bien conocidos controladores por asignación de polos.
       El GPC tiene muchas ideas en común con otros controladores
predictivos, ya que está basado en las mismas ideas pero posee a su vez
algunas diferencias. Es capaz de proporcionar una solución explícita
(en ausencia de restricciones), puede trabajar con procesos inestables o
de fase no mínima e incorpora el concepto de horizonte de control así
como la consideración en la función de coste de ponderación de los

                                                                       33
                        incrementos en las acciones de control. Las diversas posibilidades
                        disponibles para el GPC conducen a una gran variedad de objetivos de
                        control comparado con otras realizaciones, algunas de las cuales
                        pueden ser consideradas como subconjuntos o casos límites del GPC
                        [23].




       2.4.    IDENTIFICACIÓN DE SISTEMAS


                        Cuando nosotros interactuamos con un sistema necesitamos algunos
               conceptos de como las variables se relacionan unas a otras, llamaremos a las
               relaciones entre las señales observadas un modelo                 del sistema [17] 7 . Los
               modelos matemáticos pueden ser caracterizados con varios adjetivos (de tiempo
               continuo o discreto, lineal o no lineal, determinístico o estocástico, total o
               distribuido, etc.) [5] 8 significando el tipo de ecuación diferencial o en
               diferencias usado, el uso de los modelos matemáticos es inherente en todos los
               campos de la ingeniería y la física.
                        El modelo usado en una simulación por computador es un programa,
               para sistemas complejos donde un modelo es construido por muchos
               programas, tablas y subrutinas interconectadas se llama más apropiadamente
               un modelo software.


               2.4.1.   Modelo ARX [17]
                        La relación más básica entre la entrada y la salida es la ecuación
               diferencial lineal:
                                     𝑦(𝑘) + 𝑎1 𝑦(𝑘 − 1) + ⋯ + 𝑎𝑛 𝑦(𝑘 − 𝑛) =
                                       𝑏1 𝑢(𝑘 − 1) + ⋯ + 𝑏𝑚 𝑢(𝑘 − 𝑚)                                 (2 -55)

                        Una forma pragmática de ver la ecuación (2-55) es como una forma de
               determinar el siguiente valor de la salida a partir de las observaciones previas.
                                     𝑦(𝑘) = −𝑎1 𝑦(𝑘 − 1) − ⋯ − 𝑎𝑛 𝑦(𝑘 − 𝑛)

7
    System Identification – Theory for the User. Lennart Ljung .
8
    Apuntes de Ingeniería de Control – Identificación de Sistemas ,Control Adaptativo ,Control Predictivo
                                                                                                            34
                           + 𝑏1 𝑢(𝑘 − 1) + ⋯ + 𝑏𝑚 𝑢(𝑘 − 𝑚)                  (2 -56)


Para una notación más compacta, definimos los vectores:
                            𝜃 = [𝑎1 𝑎2 … 𝑎𝑛 𝑏1 … 𝑏𝑚 ]𝑇                     (2 – 57)
              𝜑(𝑘) = [−𝑦(𝑘 − 1) … − 𝑦(𝑘 − 𝑛) 𝑢(𝑘 − 1) … 𝑢(𝑘 − 𝑚)]𝑇         (2 – 58)
         Así podemos escribir:
                                        𝑦(𝑘) = 𝜑 𝑇 (𝑘)𝜃                     (2 -59)
         Para realzar el cálculo de y(k) a partir de los datos pasados , depende de
los parámetros en 𝜃 , nosotros llamaremos este cálculo como 𝑦̂(𝑘|𝜃) y
escribiremos como :
                                           𝑦̂(𝑘|𝜃) = 𝜑 𝑇 (𝑘)𝜃              (2 – 60)


2.4.2.    Procedimiento de identificación de sistemas
         La construcción de un modelo de datos [5], [17] consta de tres pasos:
         1. Un conjunto de datos.
         2. Un conjunto de modelos candidatos.
         3.    Una regla por la cual los modelos candidatos pueden ser evaluados
               utilizando los datos.
          1.       El registro de datos .-Los datos de entrada – salida          son
                   algunas veces registradas durante un especifico experimento de
                   identificación,     donde   el   usuario     puede    determinar
                   específicamente cual señal medir y cuando medir ,así como
                   también puede elegir la señal de entrada, el objetivo del
                   experimento de diseño es hacer que los datos elegidos
                   contengan la mayor información posible del sistema.
          2.       El conjunto de modelos o estructura del modelo.- Un
                   conjunto de modelos candidatos son obtenidos por especificar
                   dentro de cual colección de modelos nosotros vamos a buscar
                   uno adecuado. Esto es sin duda lo más importante y al mismo
                   tiempo la elección más difícil del proceso de identificación de
                   sistemas. Algunas veces el conjunto de modelos son obtenidos
                   después de un cuidadoso modelado. En este caso un modelo con

                                                                                 35
                 algunos parámetros físicos desconocidos es construido a partir
                 de leyes de física básica y otras relaciones establecidas. En otros
                 casos, los modelos lineales estándar se pueden emplear, sin
                 referencia al fondo físico. Tal conjunto de modelos cuyos
                 parámetros son básicamente vistos como vehículos para ajustar
                 el ajuste a los datos y no reflejan las consideraciones físicas en
                 el sistema, se llaman modelos de caja negra. El conjuntos de
                 modelos con parámetros ajustables con interpretación física
                 pueden en consecuencia ser llamados de caja gris. Generalmente
                 hablando una estructura del modelo es una aplicación con
                 parámetros de entrada y salida pasadas 𝑍 𝑡−1 [17].
         3.      Determinando los mejores modelos en el conjunto guiado
                 por los datos. este es el método de identificación. La
                 evaluación de la calidad del modelo se basa generalmente en la
                 forma en que los modelos realizan cuando intentan reproducir
                 los datos de medición.


2.4.3.   Validación del Modelo
         Después de haber realizado las tres elecciones anteriores, tenemos por lo
menos implícitamente un modelo en particular: el que está en el conjunto que
mejor describe los datos de acuerdo con el criterio elegido, queda entonces a la
prueba de si este modelo es lo suficientemente bueno, es decir si es válido para
su fin. Estas pruebas se conocen como la validación del modelo, involucran a
varios procedimientos para evaluar cómo el modelo se refiere a los datos
observados para el conocimiento previo, y para el uso previsto. Un
comportamiento deficiente del modelo en estos aspectos hace que rechacemos
el modelo, mientras que un buen rendimiento desarrollará una cierta confianza
en él. Un modelo no puede ser aceptado como una descripción definitiva y
verdadera del sistema, más bien, se puede en el mejor de los casos ser
considerado como una buena descripción suficiente de ciertos aspectos que son
de especial interés para nosotros [5], [6],[17].



                                                                                 36
2.4.4.   El bucle de identificación de sistemas
         El procedimiento de identificación de sistemas tiene un flujo lógico
natural: primero recopilar datos, a continuación, elegir un modelo, a
continuación, elegir el mejor modelo de esta serie. Es bastante probable que el
primer modelo obtenido no pasará la prueba de validación del modelo .Nosotros
debemos volver atrás y realizar las distintas etapas del procedimiento [5], [17].
         El modelo puede ser deficiente por varias razones:
                El procedimiento numérico no puede encontrar el mejor modelo
                 de acuerdo a nuestro criterio.
                El criterio no fue bien elegido.
                El conjunto de modelos no fue apropiado, ya que no contiene
                 una descripción lo suficientemente buena para el sistema.
                El conjunto de datos no era lo suficientemente informativo para
                 orientar en la selección de buenos modelos.
La mayor parte de una aplicación de identificación, de hecho, consiste en hacer
frente a estos problemas, en particular, la tercera, de una manera iterativa
guiado por la información previa y los resultados de los intentos anteriores [17].




                     Figura 14:El bucle de identificación de sistemas.



                                                                               37
2.4.5.   Métodos recursivos de estimación de parámetros
         En muchos casos es necesario tener un modelo del sistema disponible
on-line mientras que el sistema está en funcionamiento. El modelo se debe
basar en observaciones del momento actual. La necesidad de construir un
modelo on-line típicamente surge ya que se requiere un modelo con el fin de
tomar alguna decisión sobre el sistema [1], [5], [6][14] ,[17],. Esto podría ser:
                Qué entrada debe aplicarse en el siguiente instante de muestreo.
                Cómo deben ajustarse los parámetros de un filtro adaptable?
                Cuál es la mejor predicción de las siguientes salidas?
                Ha ocurrido alguna falla? de que tipo ?
         Los métodos para hacer frente a estos problemas mediante un modelo
ajustado en línea de algún tipo se llaman adaptativos, estos se aplican en el
control adaptativo, filtrado adaptativo, procesamiento de señal adaptativo,
predicción adaptativa [17].




                         Figura 15:El método adaptativo.



         El cálculo on-line del modelo tiene que ser hecho de tal forma que el
que el procesamiento de la medición de una muestra con certeza pueda ser
completado durante un intervalo de muestreo, de lo contrario la construcción
del modelo no podrá mantener la correspondencia con el flujo de información.
         Las técnicas de identificación que cumplen con este requisito se llaman
métodos de identificación recursiva, ya que los datos de entrada y salida de
medición se procesan de forma recursiva (secuencialmente) a medida que estén
disponibles [1], [17].

                                                                                    38
           Otros términos comúnmente usados para estas técnicas son la
  identificación on-line o en tiempo real, la estimación de parámetros
  adaptativos, o estimación de parámetros secuencial. Además de la utilización
  de métodos recursivos en los sistemas adaptativos, estos son importantes por las
  dos razones siguientes:
           1.-Tipicamente como nosotros veremos estos tomaran su propia
  estimación de la varianza de parámetros [5], [17] .Esto significa que los datos
  pueden ser completados desde el sistema y procesados hasta que se haya
  alcanzado un suficiente grado de exactitud del modelo.
           2.-Los algoritmos de estimación on-line también servirán para la
  estimación de parámetros off-line.


  2.4.6.   El algoritmo de los mínimos cuadrados recursivos.
           Para calcular el criterio que minimiza la estimación de los mínimos
  cuadrados ponderados [17], hacemos:
                  𝜃̂𝑡 = 𝑎𝑟𝑔𝜃 𝑚𝑖𝑛 ∑𝑡𝐾=1 𝛽(𝑡, 𝑘)[𝑦(𝑘) − 𝜑 𝑇 (𝑘)𝜃]2           (2 -61)
Si hacemos que
                    𝜃̂𝑡 = 𝑅̅ −1 (𝑡)𝑓(𝑡)                                  (2 -62a)
                   𝑅̅ = ∑𝑡𝐾=1 𝛽(𝑡, 𝑘)𝜑(𝑘) 𝜑 𝑇 (𝑘)                        (2 -62b)
                    𝑓(𝑡) = ∑𝑡𝐾=1 𝛽(𝑡, 𝑘)𝜑(𝑘) 𝑦(𝑘)                         (2 -62c)

           Para calcular Ec. 2-62, debemos formar la matriz y el vector en el
  tiempo t a partir de 𝑍 𝑡 y resolver Ec. 2-62a .Si hemos calculado previamente
  𝜃̂𝑡−1 esto no será una ayuda inmediata, sin embargo está claro que 𝜃̂𝑡 y 𝜃̂𝑡−1
  están muy relacionados.


           2.4.6.1. Algoritmo Recursivo [17]
                  Supongamos       que la secuencia de pesos tiene la siguiente
           propiedad:
                 𝛽(𝑡, 𝑘) = 𝜆(𝑡)𝛽(𝑡 − 1, 𝑘)          0≤𝑘 ≤𝑡−1
                  𝛽(𝑡, 𝑡) = 1;                                             (2 -63)



                                                                               39
Esto significa que:
                  𝛽(𝑡, 𝑘) = ∏𝑡𝑘+1 𝜆(𝑗)                                         (2 -64)
Esto implica que:
                𝑅̅ (𝑡) = 𝜆(𝑡)𝑅̅ (𝑡 − 1) + 𝜑(𝑡)𝜑 𝑇 (𝑡)                      (2 -65a)
                𝑓(𝑡) = 𝜆(𝑡)𝑓(𝑡 − 1) + 𝜑(𝑡)𝑦(𝑡)                             (2 -65b)
Entonces:
            𝜃̂𝑡 = 𝑅̅ −1 (𝑡)𝑓(𝑡) = 𝑅̅ −1 (𝑡)[𝜆(𝑡)𝑓(𝑡 − 1) + 𝜑(𝑡)𝑦(𝑡)]
            𝜃̂𝑡 = 𝜃̂𝑡−1 + 𝑅̅ −1 (𝑡)𝜑(𝑡)[𝑦(𝑡) − 𝜑 𝑇 (𝑘)𝜃̂𝑡−1 ]                  (2 -66)
Y luego tenemos:
                  𝜃̂𝑡 = 𝜃̂𝑡−1 + 𝑅̅ −1 (𝑡)𝜑(𝑡)[𝑦(𝑡) − 𝜑 𝑇 (𝑘)𝜃̂𝑡−1 ]        (2 -67a)
                  𝑅̅ (𝑡) = 𝜆(𝑡)𝑅̅ (𝑡 − 1) + 𝜑(𝑡)𝜑 𝑇 (𝑡)                    (2 -67b)
El cual es el algoritmo recursivo.


        2.4.6.2. Usando una Matriz de inversión eficiente
        Para evitar invertir 𝑅̅ (𝑡) en cada paso, es conveniente introducir:


                                 𝑃(𝑡) = 𝑅̅ −1 (𝑡)                              (2 -68)


        Y aplicar el lema de inversión de matrices [1], [17]:


               [𝐴 + 𝐵𝐶𝐷]−1 = 𝐴−1 − 𝐴−1 𝐵[𝐷𝐴−1 𝐵 + 𝐶 −1 ]−1 𝐷𝐴−1                (2 -69)


        A la Ec. 2-66, haciendo que 𝐴 = 𝜆(𝑡)𝑅̅ (𝑡 − 1) ;𝐵 = 𝐷𝑇 = 𝜑(𝑡) y C=1,
        nos da:
                             1                𝑃(𝑡−1)𝜑(𝑡)𝜑 𝑇 (𝑡)𝑃(𝑡−1)
                    𝑃(𝑡) = 𝜆(𝑡) [𝑃(𝑡 − 1) −                            ]       (2 -70)
                                               𝜆(𝑡)+𝜑𝑇 (𝑡)𝑃(𝑡−1)𝜑(𝑡)



                   1                   1 𝑃(𝑡 − 1)𝜑(𝑡)𝜑 𝑇 (𝑡)𝑃(𝑡 − 1)𝜑(𝑡)
𝑅̅ −1 (𝑡)𝜑(𝑡) =        𝑃(𝑡 − 1)𝜑(𝑡) −
                  𝜆(𝑡)                𝜆(𝑡) 𝜆(𝑡) + 𝜑 𝑇 (𝑡)𝑃(𝑡 − 1)𝜑(𝑡)


                     𝑃(𝑡−1)𝜑(𝑡)
          =                                                                    (2 -71)
              𝜆(𝑡)+𝜑𝑇 (𝑡)𝑃(𝑡−1)𝜑(𝑡)



                                                                                   40
                    Resumiendo tenemos:


                           𝜃̂(𝑡) = 𝜃̂ (𝑡 − 1) + 𝐿(𝑡)[𝑦(𝑡) − 𝜑 𝑇 (𝑡)𝜃̂(𝑡 − 1)]                    (2 -72a)


                                             𝑃(𝑡−1)𝜑(𝑡)
                            𝐿(𝑡) =                                                               (2 -72b)
                                      𝜆(𝑡)+𝜑𝑇 (𝑡)𝑃(𝑡−1)𝜑(𝑡)



                                       1                     𝑃(𝑡−1)𝜑(𝑡)𝜑𝑇 (𝑡)𝑃(𝑡−1)
                           𝑃(𝑡) =            [𝑃(𝑡 − 1) −                                    ]    (2 -72c)
                                      𝜆(𝑡)                       𝜆(𝑡)+𝜑 𝑇 (𝑡)𝑃(𝑡−1)𝜑(𝑡)



                    2.4.6.3. Caso Multivariable
                    Consideremos el caso para sistemas multivariables [17]:


                          1
           𝜃̂𝑡 = 𝑎𝑟𝑔𝜃 𝑚𝑖𝑛 2 ∑𝑡𝐾=1 𝛽(𝑡, 𝑘)[𝑦(𝑘) − 𝜑 𝑇 (𝑘)𝜃]𝑇 Ʌ𝑘 −1 [𝑦(𝑘) − 𝜑 𝑇 (𝑘)𝜃] (2 -73)


                    Análogamente al caso de una sola variable, tenemos:


                         𝜃̂ (𝑡) = 𝜃̂(𝑡 − 1) + 𝐿(𝑡)[𝑦(𝑡) − 𝜑 𝑇 (𝑡)𝜃̂(𝑡 − 1)]                       (2 -74)


                        𝐿(𝑡) = 𝑃(𝑡 − 1)𝜑(𝑡)[𝜆(𝑡)Ʌ𝑡 + 𝜑 𝑇 (𝑡)𝑃(𝑡 − 1)𝜑(𝑡)]−1                       (2 -75)


                                                                            −1
                              𝑃(𝑡−1)−𝑃(𝑡−1)𝜑(𝑡)[𝜆(𝑡)Ʌ𝑡 +𝜑𝑇 (𝑡)𝑃(𝑡−1)𝜑(𝑡)]        𝜑 𝑇 (𝑡)𝑃(𝑡−1)
                     𝑃(𝑡) =                                                                       (2 -76)
                                                          𝜆(𝑡)



    2.5.   Mecánica analítica de Euler-LaGrange-Hamilton
                   La dinámica analítica [10] 9 , [26] 10 comprende una serie de métodos
           cuya característica principal es el tratamiento puramente abstracto, analítico, de
           los sistemas mecánicos. De esta forma, se separan al máximo las
           consideraciones físicas y geométricas necesarias para definir el movimiento, de
           las puramente matemáticas para plantear y solucionar las ecuaciones. Las


9
  Comportamiento dinámico de un péndulo triple plano. Iván Jesús Rivas Campero, José Manuel Salcedo
Solorio .
10
   Introducción a la mecánica de Lagrange Hamilton. Terencio Soldovieri C.
                                                                                                      41
primeras son necesarias para formular las coordenadas, enlaces y magnitudes
cinéticas de un sistema dado; una vez realizada definición de un sistema
mediante la adecuada selección de las magnitudes anteriores, los métodos de la
mecánica analítica permiten obtener las ecuaciones de la dinámica (o las
condiciones de la estática en su caso) de forma casi automática [26].


2.5.1.   Sistemas con ligaduras
         Los sistemas de partículas están, en general, sujetos a tres tipos de
condiciones que determinan su movimiento en el espacio y en el tiempo [26].
Hasta ahora hemos considerado solamente dos tipos de estas condiciones:
          Las condiciones dinámicas expresadas mediante las fuerzas que
         actúan sobre el sistema mediante las ecuaciones del movimiento.
          Las condiciones iniciales expresadas habitualmente por los valores
         iniciales de la posición y la velocidad y/o por los valores de ciertas
         cantidades dinámicas conservadas.
          Las leyes de Newton están perfectamente diseñadas para investigar
         el comportamiento de sistemas sujetos a los dos tipos de condiciones
         anteriores. La situación es completamente distinta cuando el sistema
         está sujeto a ligaduras.
          Las condiciones geométricas o ligaduras aparecen cuando las
         coordenadas están sujetas a restricciones independientes de las fuerzas
         actuantes (por ejemplo partículas obligadas a moverse sobre una curva).
         Aparecen así fuerzas llamadas fuerzas de ligadura.
         Si tales fuerzas fueran conocidas, bastaría sumarlas a las fuerzas del
         sistema para determinar su comportamiento. Sin embargo lo más
         frecuente es que conozcamos las ligaduras pero no las fuerzas
         resultantes. El procedimiento de LaGrange se adapta perfectamente a
         estos casos. Supongamos que el sistema tiene n grados de libertad y que
         lo hemos descrito por m coordenadas generalizadas. Existirán por tanto
         k = m - n ligaduras. Las ligaduras son susceptibles de clasificarse desde
         distinto puntos de vista, aquí adoptaremos los siguientes:



                                                                               42
  2.5.1.1.- Ligaduras holónomas
         Son las que pueden expresarse como una relación entre las
  coordenadas.
                        𝑓𝑖 (𝑞𝑗 , 𝑡) = 0         𝑖 = 1…𝑘         𝑗 = 1…𝑚    (2 - 77)
  En tal caso, estas k ecuaciones permiten eliminar k coordenadas [26].


  2.5.1.2.- Ligaduras no holónomas
         Son aquellas en que las ligaduras sólo pueden expresarse en
  términos de las velocidades, es decir:


                        ∑𝑚
                         𝑗=1 𝑎𝑖𝑗 𝑞̇ 𝑗 = 𝑎𝑖                 𝑖 = 1…𝑘         (2 -78 )

  Para trabajar con este tipo de ligaduras empleamos los multiplicadores
  de LaGrange definidos como k coeficientes 𝜆𝑖 tales que:


                                ∑𝑘𝑖=1 𝜆𝑖 𝑎𝑖𝑗 = 0                          (2 - 79)
 y por tanto :


        ∑𝑘𝑖=1 𝜆𝑖 ∑𝑚
                  𝑗=1 𝑎𝑖𝑗 𝛿𝑞𝑗        = ∑𝑚    𝑘
                                        𝑗=1 ∑𝑖=1 𝜆𝑖 𝑎𝑖𝑗 𝛿𝑞𝑗 = 0            (2 - 80)


 Teniendo en cuenta que el principio de Hamilton es:


                            𝑚
                   𝑡                 𝜕𝐿        𝑑 𝑑𝐿
         𝛿𝑆 = ∫𝑡 2 ∑             [        −(              )]𝛿𝑞𝑗 𝑑𝑡 = 0     (2 - 81)
                    1       𝑗=1 𝜕𝑞𝑗            𝑑𝑡 𝑑𝑞̇ 𝑗

 Podemos introducir (2 -79) en (2 -81 ) como:

            𝑚
         𝑡2     𝜕𝐿               𝑑 𝑑𝐿
𝛿𝑆 =   ∫𝑡 ∑ [𝜕𝑞            −(              ) − ∑𝑘𝑖=1 𝜆𝑖 𝑎𝑖𝑗 ]𝛿𝑞𝑗 𝑑𝑡 = 0 (2 - 82)
         1  𝑗=1   𝑗             𝑑𝑡 𝑑𝑞̇ 𝑗

 Tenemos pues las m ecuaciones:


            𝜕𝐿          𝑑 𝑑𝐿
                  − (𝑑𝑡 𝑑𝑞̇ ) − ∑𝑘𝑖=1 𝜆𝑖 𝑎𝑖𝑗 = 0              𝑗 = 1…𝑚      (2 -83)
            𝜕𝑞𝑗             𝑗




                                                                                43
         Que junto con las k ligaduras (2 -78) determinan las m coordenadas 𝑞𝑗 y

         los k multiplicadores 𝜆𝑖 [26].
         Conocidos los multiplicadores se pueden determinar las fuerzas de
         ligadura como:

                              (𝐹𝑙 )𝑗 = ∑𝑘𝑖=1 𝜆𝑖 𝑎𝑖𝑗                        (2 -84)


2.5.2.   Coordenadas generalizadas
         Un planteamiento básico de la mecánica analítica es la descripción de
los sistemas mediante «coordenadas generalizadas». Se denominan coordenadas
generalizadas a un conjunto cualquiera de parámetros {𝑞𝑖 , 𝑖 = 1,2, … , 𝑛 }, que
sirven para determinar de manera unívoca la configuración del sistema [26].
         Estos parámetros en principio pueden ser cualesquiera, sin necesitar ser
homogéneos en cuanto a dimensiones. Por ejemplo, se pueden mezclar
longitudes, ángulos, etc. Una idea clave, subyacente en la elección de
coordenadas generalizadas, es que éstas pueden englobar en su propia elección
los enlaces del sistema (todos o al menos una parte de ellos). De esta forma se
consigue una doble ventaja: por una parte, el número de parámetros es menor
que el correspondiente directamente a las coordenadas de todas las partículas.
Por otra parte, el número de ecuaciones de enlace se ve igualmente reducido.
         Un conjunto de coordenadas       {𝑞𝑖 } se denomina «libre» cuando se
pueden variar de forma independiente entre sí; es decir, si las variaciones de las
mismas, {𝛿𝑞𝑖 } se pueden escoger de forma arbitraria. Caso de que no sea así,
será porque existe alguna ligadura que relacione dichas coordenadas, bien de
tipo holónomo o no holónomo.
         Cuando las coordenadas generalizadas no sean libres, se deberá a que
subsisten condiciones de enlace formuladas de manera explícita. Estas se
traducirán en relaciones entre las 𝑞𝑖 (y también sus derivadas 𝑞̇ 𝑖 para enlaces
no holónomos). Debido a estas ligaduras el número de grados de libertad es en
realidad menor que n. Por el contrario, si las coordenadas son libres, su número
es precisamente el número de grados de libertad del sistema [26].



                                                                               44
        Por ejemplo, en el sistema plano rígido de la figura 16, al tener una
articulación, basta con una única coordenada angular (𝑛 = 1 ; 𝑞1 ≡ 𝜃 ) .
        En esta elección ya quedan englobados implícitamente los enlaces, tanto
los internos (ligaduras de sólido rígido) como los externos (articulación). El
sistema tiene un grado de libertad.
        Supongamos ahora el caso general de un sistema con un número finito
de partículas (N), sujeto a m ligaduras holónomas y k no holónomas. Será
posible su descripción mediante un conjunto más reducido de n = 3N - m
parámetros o coordenadas generalizadas.




  Figura 16: El movimiento del sólido articulado de la figura queda descrito por una única
   coordenada generalizada, el ángulo 𝜃. De esta forma se engloban todos los enlaces, tanto
         internos (ligaduras de sólido rígido) como externos (rótula cilíndrica en O).


        Esquemáticamente:




                                                                                              45
       Esta reducción en el número de coordenadas se efectúa gracias a la
eliminación de los m enlaces holónomos, que quedarán implícitos en la elección
de las coordenadas generalizadas. Por el contrario, los k enlaces anholónomos
no es posible eliminarlos, debiendo quedar planteados de forma expresa [26].
       Un caso extremo de reducción en el número de coordenadas es el del
sólido rígido. Considerado como un medio continuo, es infinitamente
subdivisible, teniendo por tanto un número infinito de partículas y por tanto de
coordenadas. Sin embargo, recordemos que los enlaces internos del sólido
(distancia constante entre dos partículas cualesquiera) permiten reducir el
número de coordenadas generalizadas del sólido a 6.
       En general, existirán unas relaciones entre los vectores de posición de
cada partícula y las coordenadas generalizadas del tipo:

                     𝑟𝑖 = 𝑟𝑖 (𝑞𝑗 , 𝑡)    (𝑖 = 1, … , 𝑁 ; 𝑗 = 1, … , 𝑛)             (2 – 85)


       A los vectores de posición de cada partícula los denominaremos, por
extensión, «coordenadas vectoriales». Está claro que éstas son equivalentes a
definir las 3N coordenadas cartesianas correspondientes. Por otra parte, éstas
sólo serán libres para un sistema sin ligadura ninguna; en cualquier otro caso,
no formarán un conjunto libre.
       Podrá existir dependencia del tiempo en la definición de las coordenadas
generalizadas (2 – 85) cuando se hayan tomado sistemas de coordenadas
móviles, o bien cuando haya enlaces móviles.
       A partir de las relaciones (2 – 85), las velocidades se obtienen
derivando:


                                 𝑑𝒓𝑖              𝜕𝒓𝑖 𝑑𝑞𝑗       𝜕𝒓𝑖
                        𝑣𝑖 =            = ∑𝑛𝑗=1             +                      (2 – 86)
                                 𝑑𝑡               𝜕𝑞𝑗 𝑑𝑡        𝜕𝑡



                                                            𝑑𝑞𝑗
Llamadas «velocidades generalizadas» a los términos                   = 𝑞̇ 𝑗   [26].
                                                            𝑑𝑡




                                                                                        46
               2.5.3.   El principio de D’Alembert en coordenadas generalizadas
                        El principio de d'Alembert [35]11, enunciado por Jean d'Alembert en
               su obra maestra Tratado de dinámica de 1743, establece que la suma de las
               fuerzas externas que actúan sobre un cuerpo y las denominadas fuerzas de
               inercia forman un sistema de fuerzas en equilibrio. A este equilibrio se le
               denomina equilibrio dinámico, expresado por:
                                  ∑𝒊(𝒑̇𝒊 − 𝑭𝒊 ). 𝜹𝑟𝒊 = 𝟎                                    (2 – 87)

                                  ∑𝑁
                                   𝑖=1(𝑓𝑖 − 𝑚𝑖 𝑟̈𝑖 ). 𝜹𝑟𝒊 = 𝟎 , ∀ {𝜹𝑟𝒊 }    𝑐𝑜𝑚𝑝𝑎𝑡𝑖𝑏𝑙𝑒𝑠 .   (2 – 88)

               Donde la suma se extiende sobre todas las partículas del sistema, siendo:

                        𝒑𝑖 , : Momentum de la partícula i-ésima.
                        𝑭𝒊 , : Fuerza externa sobre la partícula i-ésima.
                        𝜹𝑟𝒊 ,: Cualquier campo vectorial de desplazamientos.


                        El principio de d'Alembert es realmente una generalización de la
               segunda ley de Newton en una forma aplicable a sistemas con ligaduras, ya que
               incorpora el hecho de que las fuerzas de ligadura no realizan trabajo en un
               movimiento compatible. Por otra parte el principio equivale a las ecuaciones de
               Euler-LaGrange. LaGrange usó este principio bajo el nombre de principio de
               velocidades generalizadas, para encontrar sus ecuaciones, en la memoria sobre
               las libraciones de la Luna de 1764, abandonando desde entonces el principio de
               acción y basando todo su trabajo en el principio de D'Alembert durante el resto
               de su vida y de manera especial en su Mécanique Analytique. Tal cambio de
               actitud pudo estar influido por dos razones:
                           En primer lugar, el principio de acción estacionaria está ligado a la
               existencia de una función potencial, cuya existencia no requiere en el principio
               de d'Alembert.
                           En segundo lugar, el principio de acción se presta a interpretaciones
               filosóficas y teleológicas que no le gustaban a Lagrange.




11
     http://es.wikipedia.org/wiki/Principio_de_d'Alembert
                                                                                                 47
         Finalmente debe señalarse que el principio de d'Alembert es
peculiarmente útil en la mecánica de sólidos donde puede usarse para plantear
las ecuaciones de movimiento y cálculo de reacciones usando un campo de
desplazamientos virtuales que sea diferenciable. En ese caso el cálculo
mediante el principio de D'Alembert, que también se llama en ese
contexto principio de los trabajos virtuales es ventajoso sobre el enfoque más
simple de la mecánica newtoniana.

         El principio de D’Alembert queda expresado en coordenadas
generalizadas como:
               𝑑   𝜕𝑇       𝜕𝑇
         ∑𝑛𝒋=𝟏 [ ( ) −    − 𝑄𝑗 ] 𝛿 𝑞𝑗 = 0 , ∀ {𝜹𝑞𝒋 }      𝑐𝑜𝑚𝑝𝑎𝑡𝑖𝑏𝑙𝑒𝑠       (2 – 89)
                𝑑𝑡 𝜕𝑞̇
                    𝑗  𝜕𝑞    𝑗

         Esta expresión, al tratarse del principio de D’alembert, puede ser
considerada por tanto como ecuación fundamental de la dinámica [26].
         Conviene notar que en (2-89) no se emplean fuerzas físicas en ningún
término. Tan sólo entran los coeficientes 𝑄𝑗 , fuerzas generalizadas, calculadas
directamente, o como coeficientes del trabajo virtual 𝜹𝑾. Al igual que en el
principio de D’Alembert, en la definición de 𝑄𝑗 tampoco intervienen las fuerzas
de reacción de los enlaces lisos, que no realizan trabajo virtual [26], [35].


2.5.4.    Forma básica de las ecuaciones de LaGrange
         La expresión (2-89) es completamente general por lo que se puede
aplicar a cualquier sistema, tanto con enlaces holónomos como no holónomos.
En el caso en que todos los enlaces sean holónomos, será posible siempre
establecer un conjunto de coordenadas libres {𝑞𝒋 }, en el que las variaciones
{𝜹𝑞𝒋 } se puedan escoger de manera arbitraria, manteniendo la compatibilidad
con los enlaces. En este caso, (2-89) equivale a enunciar que cada uno de los
coeficientes de las {𝜹𝑞𝒋 }ha de anularse:
                        𝑑   𝜕𝑇    𝜕𝑇
                          ( ) − 𝜕𝑞 = 𝑄𝑗 , (𝑗 = 1, … , 𝑛).
                        𝑑𝑡 𝜕𝑞̇
                                                                            (2 – 90)
                             𝑗      𝑗




Estas expresiones son las llamadas ecuaciones de LaGrange, en su forma básica
[26].

                                                                                 48
 CAPITULO III
MÉTODO DE INVESTIGACIÓN
3.1.   TIPO Y DISEÑO DE INVESTIGACIÓN


                El presente proyecto tiene un enfoque de investigación cuantitativo, ya
       que presenta un proceso secuencial y probatorio siguiendo un orden riguroso en
       los pasos para resolver el problema de investigación, realizando la recolección
       de datos, mediciones numéricas y análisis estadísticos con el fin de probar las
       hipótesis y teorías que explican el comportamiento del proceso estudiado. [31]

       3.1.1.    Tipo de Investigación.
                Esta investigación, es del tipo Experimental-Aplicada, la investigación
       experimental se caracteriza por ser el más complejo y eficaz de los métodos
       empíricos, por lo que a veces se utiliza erróneamente como sinónimo de método
       empírico. Algunos lo consideran una rama tan elaborada que ha cobrado fuerza
       como otro método científico independiente con su propia lógica, denominada
       lógica experimental. Se emplea cuando la ciencia requiere de la
       experimentación para comprobar sus hipótesis y el investigador interviene,
       manipula las variables independientes y prepara las condiciones para abordar el
       problema.
                Una investigación experimental tiene dos requisitos, el primero es la
       manipulación intencional de una o más variables independientes, y el segundo
       consiste en medir el efecto que la variable o variables independientes tienen en
       la variable dependiente. Esto es igualmente importante y como en la variable
       dependiente se observa el efecto, la medición debe de ser válida y confiable.
                Una investigación experimental comprende los siguientes pasos
       principales a seguir durante su proceso de ejecución:
               Delimitar y definir el objeto de la investigación o problema.
               Plantear una hipótesis de trabajo.
               Elaborar el diseño experimental.
               Realizar el experimento.
               Analizar los resultados.
               Obtener conclusiones.
               Elaborar un informe por escrito.

                                                                                       50
         Además, una investigación experimental se lleva a cabo para analizar si
una o más variables independientes afectan a una o más variables dependientes,
y por qué; considerando que una variable dependiente se mide, no se manipula.
También en una investigación experimental pura, se permite la consulta de
experimentos anteriores similares a lo que se está desarrollando, para poder
verificar y validar el análisis que se va a efectuar, así como el de realizar un
control interno de la situación experimental, con la finalidad de conocer la
relación causal entre las variables propias al proyecto de investigación.
         Es del tipo Aplicada, es la utilización de los conocimientos en la
práctica, para aplicarlos, en la mayoría de los casos, en provecho de la sociedad,
también conocida como practica o empírica, busca la aplicación o utilización
de los conocimientos que se adquieren, depende de los avances y resultados de
la investigación básica, lo que le interesa a investigador son las consecuencias
prácticas, esta investigación tiene aplicaciones en el campo de la robótica,
estabilización de misiles ,estudio de vibraciones sísmicas, etc.


3.1.2.   Nivel de Investigación.
         El nivel de la investigación es del tipo Analítica y Descriptiva, porque se
fundamenta en base a las teorías y formulaciones estudiadas y establecidas
anteriormente por otros investigadores.
         La investigación descriptiva se refiere a la etapa preparatoria del trabajo
científico que permita ordenar el resultado de las observaciones de las
conductas, las características, los factores, los procedimientos y otras variables
de fenómenos y hechos. Este tipo de investigación no tiene hipótesis exacta. Ya
que se fundamenta en una serie de análisis y prueba para llevar a cabo la
valoración de la física. La investigación descriptiva busca especificar
propiedades, características y rasgos importantes de cualquier fenómeno que se
analice (Hernández, Fernández y Baptista [22], 2003, pp. 119).
         La investigación analítica es un procedimiento que es más complejo con
respecto a la investigación descriptiva, que consiste fundamentalmente en
establecer la comparación de variables entre grupos de estudio y de control sin
aplicar o manipular las variables, estudiando éstas según se dan naturalmente en

                                                                                 51
       los grupos. Sin embargo, se refiere a la proposición de hipótesis que el
       investigador trata de probar o negar.


       3.1.3.        Diseño de Investigación.
                    Es una investigación experimental, en el que se manipulan
       deliberadamente una o más variables independiente (supuestas causa), para
       analizar las consecuencias de esa manipulación sobre una o más variables
       dependientes (supuestos efectos), dentro de una situación de control para el
       investigador. Es un procedimiento metodológico en el cual un grupo de
       individuos o conglomerado, son divididos en forma aleatoria en grupos de
       estudio, control y son analizados con respecto a un factor o medida que el
       investigador introduce para estudiar y evaluar.


       3.1.4.        Tema de Investigación.
                    El presente proyecto titulado : "DISEÑO E IMPLEMENTACIÓN DE
       UN CONTROLADOR ADAPTATIVO AUTOSINTONIZADO PARA EL
       CONTROL DE UN PENDULO TRIPLE"; corresponde al área de Ingeniería
       Electrónica en las especialidades de Instrumentación y control; en el que se
       aborda distintos conocimientos referentes a la             teoría de control avanzado,
       identificación de sistemas, dinámica analítica y programación.




3.2.   TÉCNICAS E INSTRUMENTOS DE RECOLECCIÓN DE DATOS


                    Para la recolección de datos se utilizo las siguientes técnicas e
       instrumentos:

            Cuadro 1. Técnicas e Instrumentos De Recolección De Datos
                    TECNICAS                             INSTRUMENTOS
                     Registro bibliográfico         Tesis y fuentes secundarias de
                                                      información.
                     Análisis bibliográfico
                                                     Hojas de datos          de    los
                                                      componentes.

                                                                                          52
3.3.   FASES DE LA INVESTIGACIÓN

       La metodología utilizada para el desarrollo de la tesis se divide en las
       siguientes fases:
            Fase 1. Revisión bibliográfica y estudio de proyectos antecedentes; Se
             realiza el estudio y análisis de la teoría de control clásico y avanzado,
             estudio de identificación de sistemas, mecánica analítica de Euler –
             Lagrange – Hamilton, se estudia y analiza la dinámica del péndulo
             simple, doble y triple y los algoritmos de autolevantamiento.
            Fase 2. Modelamiento matemático del péndulo triple; Se realiza el
             modelamiento matemático usando la mecánica analítica de Euler –
             Lagrange – Hamilton del péndulo triple tanto en su forma estable como
             en su condición de autolevantamiento, además se integra este modelado
             con el modelo matemático del sistema motor – polea.
            Fase 3. Diseño y simulación del controlador adaptativo autosintonizado;
             Se diseña el controlador adaptativo y se simula en los programas de
             Matlab 7.10 ® y LabVIEW 2012 ®. En esta fase se comprueba el uso
             del control adaptativo en distintos sistemas dinámicos como péndulo
             simple, doble y triple para una mayor comprensión de la teoría de control
             avanzado.
            Fase 4. Diseño del software y hardware necesario e implementación del
             sistema del péndulo triple; En esta fase a partir de los resultados del
             diseño y las simulaciones realizadas, se procede a implementar el
             hardware necesario tanto la parte física como la circuitería electrónica
             necesaria para lectura de datos de los sensores de posición y envío de la
             señal de control hacia el motor haciendo uso de los distintos programas
             de diseño electrónico, también se diseña el software en LabVIEW 2012
             Professional Development System que realizará los algoritmos
             necesarios para el control de la estabilidad del péndulo triple invertido.
            Fase 5.       Experimentación del sistema desarrollado; Se realiza las
             pruebas de funcionamiento del sistema de control desarrollado, para esto
             usamos la técnica de prueba – error, que nos ayudara a corregir los


                                                                                          53
             posibles errores que provoquen un mal funcionamiento del sistema ; de
             ser necesario se corregirá o rediseñara el controlador, software y
             hardware hasta alcanzar la respuesta deseada.
            Fase 6. Corroboración de la verdad o falsedad de las hipótesis
             Una vez obtenido el correcto funcionamiento del sistema se validara o
             negara las hipótesis planteadas en el perfil de tesis.
            Fase 7. Conclusión de datos de la investigación.
             Finalmente se realiza la conclusión de datos y recomendación para
             futuros trabajos.




3.4.   CONDICIONES DE PRUEBA Y EVALUACIÓN DEL SISTEMA


              El desarrollo y evaluación del presente proyecto de investigación se
       llevó a cabo bajo las siguientes condiciones de hardware y software:
            Computador Core i3 a 2.20Ghz con 4GB de RAM.
            Las simulaciones se realizaron utilizando el programa de Matlab 7.10 ®,
             la programación de los Microcontroladores se hizo en el PICC ,el diseño
             de los circuitos impresos y las placas se construyeron utilizando el
             programa Eagle 6.4.0, el software de control del sistema se realizó en
             LabVIEW 2012 Professional Development System, además se hizo uso
             de otros programas como el Proteus 7.10 , PICKIT 2 de microchip para
             la grabación de los programas en los PICs.
            La comunicación entre la PC y el sistema físico se realiza por medio del
             microcontrolador PIC 18F4550, el envío y recepción de datos se realiza
             vía el puerto USB mediante el protocolo Bulk Transfer.
            Se utiliza 4 señales de entrada analógica que corresponden a las
             posiciones lineal del carro y posiciones angulares de las varillas, la señal
             de control proveniente del algoritmo adaptativo se envía al PIC en un
             dato de un Byte, este dato es transferido al puerto B del PIC 16F877
             ,para ser procesado con el fin de obtener las señales de sentido de giro y



                                                                                      54
             porcentaje PWM que se envían al driver STK 6875 que controla el
             motor.
            Se utilizaron dos fuentes de alimentación, para esto se hace uso de dos
             transformadores simétricos de 12 V y 1 A, una es exclusivamente para la
             etapa de control del sistema, este comprende a los Microcontroladores
             PIC 18F4550 y 16F877, alimentación de los sensores y voltajes
             necesarios para el funcionamiento del driver STK 6875, la segunda
             fuente de alimentación es de 24 V. y es exclusiva para alimentar al driver
             de potencia que controla el motor .
            El módulo mecánico se construyó a base de aluminio, los sensores
             utilizados son potenciómetros, para medir la posición del carro se utilizó
             un potenciómetro multivueltas ya que su desplazamiento es de
             aproximadamente 80 centímetros, los ángulos de las varillas son medidas
             con potenciómetros comerciales, el actuador es un motor DC de imán
             permanente de 24 voltios.




3.5.   ÁMBITO DE ESTUDIO


              El   presente    trabajo   de     investigación   titulado:   “DISEÑO   E
       IMPLEMENTACIÓN            DE        UN     CONTROLADOR               ADAPTATIVO
       AUTOSINTONIZADO PARA EL CONTROL DE UN PENDULO TRIPLE”
       elaborado por el tesista Bach. Wilson Beto Mendoza Ccoa, se llevó a cabo en
       el domicilio del Investigador y en los laboratorios de la escuela profesional de
       Ingeniería Electrónica de la Universidad Nacional del Altiplano, ubicados en la
       Ciudad Universitaria, Puno, Perú.


              Ubicación geográfica:
              Latitud Sur                : 15° 54’
              Longitud Oeste             : 70° 08’
              Altitud                    : 3827 m.s.n.m.



                                                                                      55
                Ubicación política:
                Departamento                : Puno
                Provincia                   : Puno
                Distrito                    : Puno




3.6.   RECURSOS


       3.6.1.   Recursos Humanos
                El   presente    proyecto   de   investigación   titulado    “DISEÑO   E
       IMPLEMENTACIÓN               DE      UN       CONTROLADOR            ADAPTATIVO
       AUTOSINTONIZADO PARA EL CONTROL DE UN PENDULO TRIPLE”
       fue elaborado por el tesista Bach. Wilson Beto Mendoza Ccoa, con la
       supervisión de el director de investigación Ing. Marco Antonio Quispe Barra así
       como por el asesor Ing. Pedro Bejar Muñoz.


       3.6.2.   Recursos Materiales
                Para la realización de este proyecto de investigación se utilizó los
       siguientes materiales y equipos:
                    Computadora personal Acer ASPIRE :
                            Procesador Intel(R) Core i3 CPU 2.20 GHz.
                            4GB de RAM.
                            Sistema operativo Windows 7 Ultimate de 32 bits.
                    Estructura de aluminio para el sistema mecánico del péndulo triple.
                    Microcontroladores PIC 18F4550 y PIC 16F877.
                    Grabador de PICs , PICKIT 2 .
                    Amplificadores operacionales TL081.
                    Optoaclopadores 4N25.
                    Driver de potencia STK 6875.
                    Transformado simétrico de 12 V y 1A.
                    Reguladores de voltaje 7805,7815, 7915 y 7824.


                                                                                       56
            Resistencias, condensadores, cristales de cuarzo de 4Mhz y
             20MHz, diodos, diodos LED, placas de cobre, cable, estaño y
             demás componentes para armas el sistema de control electrónico .
            Software de MatLab 7.10 ® para la simulación y diseño del
             controlador.
            Software LabVIEW 2012 Professional Development System como
             interfaz grafica para el control y monitoreo de las señales del
             péndulo triple .
            Proteus 7.10 SP0 para las simulaciones de los circuitos de control,
             PIC-C para la programación de los PICs, Eagle 6.4.0. para el
             diseño del circuito impreso, entre otros.
            Instrumentos de medición (Tarjeta de adquisición de datos,
             voltímetro,     frecuencímetro,      osciloscopio,       capacímetro,
             ohmímetro), componentes y herramientas de instrumentación
             electrónica.
            Otras herramientas básicas de construcción.




3.7. FINANCIAMIENTO DEL PROYECTO


       El    presente   proyecto   de   investigación    titulado    “DISEÑO    E
IMPLEMENTACIÓN              DE     UN     CONTROLADOR               ADAPTATIVO
AUTOSINTONIZADO PARA EL CONTROL DE UN PENDULO TRIPLE”
elaborado por el tesista Bach. Wilson Beto Mendoza Ccoa, es autofinanciado
por el investigador.
       En el siguiente cuadro se muestra el presupuesto utilizado para llevar a
cabo este proyecto.




                                                                               57
                          Cuadro 2: Financiamiento de la investigación.
                Descripción                      Cantidad                 Costo (S/.)
Laptop       Acer     Aspire     con
procesador intel(R) Core i3 de
2.20GHz , 4 GB de RAM ,500                            1                      2000
GB de ROM, con sistema
operativo Windows 7 Ultimate
de 32 bits .
Software utilizados :
     Matlab 2010 ® .
     LabVIEW                     2012
     Professional        Development
     System.
     Eagle 6.4.0.                                     1            Versiones de prueba.
     PIC C Compiler version
     4.033.
     Proteus 7.10 .
     PICKIT 2 de microchip.
                           Sistema mecánico del péndulo triple .
Estructura de Aluminio                               1                        200
Base de madera                                       1                        20

Tornillos,     tuercas      y    otros                                        30
elementos de unión.
Motor DC de imán permanente                          1                        30
de 24 V.
Engranajes y correa dentada                                                   20

Sub Total                                                                    300
                                         Sistema electrónico
Transformadores simétricos de                        2                        40
15 V - 1 A .
Microcontrolador PIC                                 1                        45
18F4550 de microchip
Microcontrolador PIC                                 1                        20
16F877 de microchip
Potenciómetro multivueltas (25                       1                         5
vueltas ) de 10K
Potenciómetro de 10 K                                3                         4


                                                                                          58
Condensadores de 2200 uF/50V         2    8

Condensador de 4700 uF/50V           1    6
Puente de diodos de 6 A.             2    5

Reguladores de voltaje 7805, 7815    1    6
,7915 y 7824.
Disipadores                          4    6

Optoacopladores 4N25                 2    4
Cristal de 4MHz y 20MHz              1    4

Conector de puerto USB tipo B        1    2
Cable USB apantallado de 2 mts       1    7
Zócalos de 40 y 8 pines              2    3

Pulsador normalmente abierto         1    2
Driver de potencia para el control
bidireccional de motor DC            1    5
STK 6875
Switch de inicio                     1    3

Caja de control                      1    6

Borneras de 3 pines                  2    2
Conectores (molex) de 4 pines        6    3

Conectores (molex) de 6 pines        1    1
Capacitores de distintos valores.         20

Resistencias de distintos valores.        20

Diodos LED                                2
Cables                                    10

Estaño                                    4

Placas de cobre                      3    6

Acido Férrico                        1    3

Tiñer                                1    3

Cable de Extensión 220 V AC          1    3

Otros                                     20

Sub Total                                278


TOTAL                                    2578



                                                59
   CAPITULO IV
EXPOSICIÓN, DISEÑO Y ANÁLISIS
       DE RESULTADOS
4.1.   GENERALIDADES


                Es este capítulo, se desarrollan y describen todos los procesos, cálculos
       matemáticos, métodos, algoritmos y técnicas empleadas en el desarrollo de la
       investigación, también se proporcionan los diagramas esquemáticos y códigos
       de programa, con la finalidad de facilitar y permitir su uso para futuras
       investigaciones.
                El desarrollo de esta investigación comprende, el modelamiento
       matemático del sistema del péndulo triple, diseño del controlador adaptativo,
       simulación del sistema, diseño del sistema mecánico y circuito electrónico de
       control así como el diseño del software de control del sistema.




4.2.   MODELAMIENTO MATEMÁTICO DEL PÉNDULO TRIPLE.


       4.2.1.   Modelamiento matemático del subsistema carro – péndulo triple.




                            Figura 17: Subsistema carro – péndulo triple.


                A diferencia del modelamiento dinámico clásico de sistemas usando el
       equilibrio de fuerzas establecido por la segunda ley de Newton, para este caso
       usaremos la formulación Lagrangiana que es un planteamiento alternativo para
       la obtención del modelo, basado en consideraciones energéticas, y está dada por
       la ecuación 2- 90:


                                                                                      61
                             𝑑   𝜕𝐿           𝜕𝐿
                               ( ) − 𝜕𝑞 = 𝑄𝑗 , (𝑗 = 1, … , 𝑛).              (5 – 1)
                             𝑑𝑡 𝜕𝑞̇  𝑗         𝑗




       Donde L es conocido como el Lagrangiano del sistema y está dado por:
                                              𝐿 = 𝐸𝑐 − 𝐸𝑝                   (5 – 2)
       𝐸𝑐 ∶ 𝐸𝑛𝑒𝑟𝑔𝑖𝑎 𝑐𝑖𝑛𝑒𝑡𝑖𝑐𝑎 𝑑𝑒𝑙 𝑠𝑖𝑠𝑡𝑒𝑚𝑎 .
       𝐸𝑝 : 𝐸𝑛𝑒𝑟𝑔𝑖𝑎 𝑝𝑜𝑡𝑒𝑛𝑐𝑖𝑎𝑙 𝑑𝑒𝑙 𝑠𝑖𝑡𝑒𝑚𝑎 .
       𝑞𝑗 ∶ 𝐶𝑜𝑜𝑟𝑑𝑒𝑛𝑎𝑑𝑎𝑠 𝑔𝑒𝑛𝑒𝑟𝑎𝑙𝑖𝑧𝑎𝑑𝑎𝑠 .
       𝑄𝑗 ∶ 𝐹𝑢𝑒𝑟𝑧𝑎𝑠 𝑜 𝑝𝑎𝑟𝑒𝑠 𝑎𝑝𝑙𝑖𝑐𝑎𝑑𝑜𝑠 𝑠𝑜𝑏𝑟𝑒 𝑒𝑙 𝑔𝑟𝑎𝑑𝑜 𝑑𝑒 𝑙𝑖𝑏𝑒𝑟𝑡𝑎𝑑 𝑞𝑗 .


       Para el péndulo triple tenemos:
                                     𝐸𝑐 = 𝐸𝑐0 + 𝐸𝑐1 + 𝐸𝑐2 + 𝐸𝑐3             (5 – 3)
                                 𝐸𝑝 = 𝐸𝑝0 + 𝐸𝑝1 + 𝐸𝑝2 + 𝐸𝑝3                 (5 – 4)
       Donde los subíndices 0, 1,2 y 3 indican la articulación referida a la
posición, ángulo de la primera, segunda y tercera varilla de péndulo
respectivamente.
       Para la articulación 𝑞0 referida a la posición tenemos que la energía
cinética está dada por:
                1
       𝐸𝑐0 = 2 𝑚𝑣 2 , donde denotaremos a la masa del carro como 𝑚0 y la
                𝑑𝑞0
velocidad 𝑣 =            = 𝑞̇ 0 por tanto nos resulta que:
                    𝑑𝑡
                                                          1
                                                   𝐸𝑐0 = 2 𝑚0 𝑞̇ 0 2        (5 – 5)

       Para la articulación 𝑞1 la energía cinética será:
                1
       𝐸𝑐1 =        𝑚1 𝑣1 2 ; Donde la masa 𝑚1 representa la masa de la primera
                2

varilla del péndulo triple, y la velocidad 𝑣1 representa la velocidad a la que gira
esta varilla, y está dada por:
                𝑑𝑥 2          𝑑𝑦 2
       𝑣1 2 = ( 𝑑𝑡 ) + ( 𝑑𝑡 )            donde:

       𝑥 = 𝑞0 + 𝑙1 sen(𝑞1 )               y
        𝑦 = 𝑙1 cos(𝑞1 )


       Donde 𝑙1es la longitud al centro de masa de la varilla.

                                                                                62
       Reemplazando y resolviendo tenemos que:
                     1             1          2
            𝐸𝑐1 = 2 𝑚1 𝑞̇ 0 2 + 2 𝑚1 𝑙1 2 𝑞̇ 0 + 𝑚1 𝑞̇ 0 𝑞̇ 1 𝑙1 cos(𝑞1 )              (5 – 6)

       Para la articulación 𝑞2 la energía cinética será:
                1
       𝐸𝑐2 =        𝑚2 𝑣2 2 ; Donde la masa 𝑚2 representa la masa de la segunda
                2

varilla del péndulo triple, y la velocidad 𝑣2 representa la velocidad a la que gira
esta varilla, y está dada por:


                 𝑑𝑥 2       𝑑𝑦 2
       𝑣2 2 = ( 𝑑𝑡 ) + ( 𝑑𝑡 ) , Donde:

       𝑥 = 𝑞0 + 𝐿1 sen(𝑞1 ) + 𝑙2 sen(𝑞2 )y
       𝑦 = 𝐿1 cos(𝑞1 ) + 𝑙2 cos(𝑞2 )


       Donde 𝑙1 y 𝑙2 son las longitud al centro de masa de las varillas de los
péndulos, y 𝐿1 =2𝑙1 es la longitud de la varilla 1.
       Reemplazando y resolviendo tenemos que:
            1
    𝐸𝑐2 =     𝑚2 𝑞̇ 0 2 + 𝑚2 𝐿1 𝑞̇ 0 𝑞̇ 1 cos(𝑞1 ) + 𝑚2 𝑙2 𝑞̇ 0 𝑞̇ 2 cos(𝑞2 ) +
            2
                                             𝑚2 𝐿1 𝑙2 cos(𝑞1 − 𝑞2 ) 𝑞̇ 1 𝑞̇ 2 + 𝑚2 𝐿1 2 𝑞̇ 1 2 +
                                                   𝑚2 𝑙2 2 𝑞̇ 2 2                      (5 – 7)


       Para la articulación 𝑞3 la energía cinética será:
                1
       𝐸𝑐2 =        𝑚3 𝑣3 2 ; Donde la masa 𝑚3 representa la masa de la tercera
                2

varilla del péndulo triple, y la velocidad 𝑣3 representa la velocidad a la que gira
esta varilla, y está dada por:
                 𝑑𝑥 2       𝑑𝑦 2
       𝑣3 2 = ( 𝑑𝑡 ) + ( 𝑑𝑡 ) , donde:

       𝑥 = 𝑞0 + 𝐿1 sen(𝑞1 ) + 𝐿2 sen(𝑞2 ) + 𝑙3 sen(𝑞3 ) y
       𝑦 = 𝐿1 cos(𝑞1 ) + 𝐿2 cos(𝑞2 ) + 𝑙3 cos(𝑞3 )


Donde 𝑙3 es la longitud al centro de masa de la varilla 3, y 𝐿1 𝑦 𝐿2 son las
longitud de la varilla 1 y 2 respectivamente.



                                                                                            63
         Reemplazando y resolviendo tenemos que:
                  1
         𝐸𝑐3 = 2 𝑚3 (𝑞̇ 0 2 + 2𝐿1 𝑞̇ 0 𝑞̇ 1 cos(𝑞1 ) + 2𝐿2 𝑞̇ 0 𝑞̇ 2 cos(𝑞2 ) +

        2𝑙3 𝑞̇ 0 𝑞̇ 3 cos(𝑞3 ) + 2 𝐿1 𝐿2 cos(𝑞2 − 𝑞1 ) 𝑞̇ 1 𝑞̇ 2 + 2𝐿1 𝑙3 cos(𝑞3 −
        𝑞1 ) 𝑞̇ 1 𝑞̇ 3 + 2𝐿2 𝑙3 cos(𝑞3 − 𝑞2 ) 𝑞̇ 2 𝑞̇ 3 + 𝐿1 2 𝑞̇ 1 2 + 𝐿2 2 𝑞̇ 2 2 + 𝑙3 2 𝑞̇ 3 2 )
        (5– 8)


         Finalmente:
        1             1            1              1
 𝐸𝑐 = 2 𝑎0 𝑞̇ 0 2 + 2 𝑏1 𝑞̇ 1 2 + 2 𝑏2 𝑞̇ 2 2 + 2 𝑏3 𝑞̇ 3 2 + 𝑎1 𝑞̇ 0 𝑞̇ 1 cos(𝑞1 ) +

 𝑎2 𝑞̇ 0 𝑞̇ 2 cos(𝑞2 ) + 𝑎3 𝑞̇ 0 𝑞̇ 3 cos(𝑞3 ) + 𝑎2 𝐿1 cos(𝑞2 − 𝑞1 ) 𝑞̇ 1 𝑞̇ 2 + 𝑎3 𝐿1 cos(𝑞3 −
 𝑞1 ) 𝑞̇ 1 𝑞̇ 3 + 𝑎3 𝐿2 cos(𝑞3 − 𝑞2 ) 𝑞̇ 2 𝑞̇ 3
 (5 – 9)
         Dónde:
            𝑎0 = 𝑚0 + 𝑚1 + 𝑚2 + 𝑚3
            𝑎1 = 𝑚2 𝐿1 + 𝑚3 𝐿1 + 𝑚1 𝑙1
            𝑎2 = 𝑚2 𝑙2 + 𝑚3 𝐿2
            𝑎 3 = 𝑚3 𝑙 3
            𝑏1 = 𝑚1 𝐿1 + 𝑚3 𝐿1 + 𝑚1 𝑙1
            𝑏2 = 𝑚2 𝑙2 2 + 𝑚3 𝐿2 2
            𝑏3 = 𝑚3 𝑙3 2
         Para desarrollar el Lagrangiano necesitamos la energía potencial del
sistema, esta está dada por:
                               𝐸𝑝 = 𝐸𝑝0 + 𝐸𝑝1 + 𝐸𝑝2 + 𝐸𝑝3
         Donde la energía potencial 𝐸𝑝0 expresa la energía potencial del carro ,y
está dado por :                                   𝐸𝑝0 = 0 .


         Para la primera varilla del péndulo, la energía potencial será:
                                       𝐸𝑝1 = 𝑚1 𝑔𝑙1 cos(𝑞1 )                                    (5 – 10)


         Para la segunda varilla del péndulo, la energía potencial será :
                            𝐸𝑝2 = 𝑚1 𝑔𝐿1 cos(𝑞1 ) + 𝑚2 𝑔𝑙2 cos(𝑞2 )                             (5 – 11)



                                                                                                      64
       Para la tercera varilla del péndulo, la energía potencial será:


           𝐸𝑝3 = 𝑚1 𝑔𝐿1 cos(𝑞1 ) + 𝑚2 𝑔𝐿2 cos(𝑞2 ) + 𝑚3 𝑔𝑙3 cos(𝑞3 )                   (5 – 12)
       𝐸𝑝 = (𝑚1 𝑔𝑙1 + 𝑚2 𝑔𝐿1 + 𝑚3 𝑔𝐿1 ) cos 𝑞1 + (𝑚2 𝑔𝑙2 + 𝑚3 𝑔𝐿2 )cosq 2 +
        𝑚3 𝑔𝑙3 𝑐𝑜𝑠𝑞3                                                                   (5 – 13)


       Ordenando tenemos:
                        𝐸𝑝 = 𝑐1 𝑐𝑜𝑠𝑞1 + 𝑐2 cos 𝑞2 + 𝑐3 cos 𝑞3                          (5 – 14)


       Donde:


        𝑐1 = 𝑚1 𝑔𝑙1 + 𝑚2 𝑔𝐿1 + 𝑚3 𝑔𝐿1
        𝑐2 = 𝑚2 𝑔𝑙2 + 𝑚3 𝑔𝐿2
        𝑐3 = 𝑚3 𝑔𝑙3                                                                    (5 – 15)


       Para formar el Lagrangiano usamos las ecuaciones (5 - 9) y (5-14) y
reemplazamos en las ecuaciones (5 – 1) y (5 – 2)


                             𝑑 𝜕𝐿        𝜕𝐿
                               (      )−     = 𝑄𝑗 , (𝑗 = 1, … , 𝑛).
                             𝑑𝑡 𝜕𝑞̇ 𝑗    𝜕𝑞𝑗


       Para la articulación 𝑞0 tenemos:


       𝑑       𝜕𝐿       𝜕𝐿
           (        ) − 𝜕𝑞 = 𝐹 , donde F es la fuerza que se le imprime al carro.
       𝑑𝑡 𝜕𝑞̇ 0           𝑗




       Resolviendo las derivadas y ordenando tenemos:


                    𝑎0 𝑞̈ 0 + 𝑎1 (𝑐𝑜𝑠𝑞1 𝑞̈ 1 − 𝑠𝑒𝑛𝑞1 𝑞̇ 1 2 ) + 𝑎2 (𝑐𝑜𝑠𝑞2 𝑞̈ 2 − 𝑠𝑒𝑛𝑞2 𝑞̇ 2 2 ) +
                    𝑎3 (𝑐𝑜𝑠𝑞3 𝑞̈ 3 − 𝑠𝑒𝑛𝑞3 𝑞̇ 3 2 ) = 𝐹                                (5 – 16)




                                                                                              65
        Para la articulación 𝑞1 tenemos:


        𝑑       𝜕𝐿       𝜕𝐿
            (        ) − 𝜕𝑞 = 0, despreciaremos las fricciones de desplazamiento del
        𝑑𝑡 𝜕𝑞̇ 1           1

carro así como al movimiento de las articulaciones de los péndulos así como las
inercias rotatorias de los ejes.
        Resolviendo las derivadas y ordenando tenemos que:


            𝑎1 (𝑐𝑜𝑠𝑞1 𝑞̈ 0 − 𝑔𝑠𝑒𝑛𝑞1 ) + 𝑎4 (𝑐𝑜𝑠(𝑞2 − 𝑞1 )𝑞̈ 2 − 𝑠𝑒𝑛(𝑞2 − 𝑞1 )𝑞̇ 2 2 ) +
            𝑎5 (𝑐𝑜𝑠(𝑞3 − 𝑞1 )𝑞̈ 3 − 𝑠𝑒𝑛(𝑞3 − 𝑞1 )𝑞̇ 3 2 + 𝑏1 𝑞̈ 1 ) = 0       (5 – 17)


        Para la articulación 𝑞2 tenemos:
        𝑑       𝜕𝐿       𝜕𝐿
            (        ) − 𝜕𝑞 = 0, despreciaremos las fricciones de desplazamiento del
        𝑑𝑡 𝜕𝑞̇ 2           2

carro así como al movimiento de las articulaciones de los péndulos así como las
inercias rotatorias de los ejes.
        Resolviendo las derivadas y ordenando tenemos que:


            𝑎2 (𝑐𝑜𝑠𝑞2 𝑞̈ 0 − 𝑔𝑠𝑒𝑛𝑞2 ) + 𝑎4 (𝑐𝑜𝑠(𝑞2 − 𝑞1 )𝑞̈ 1 + 𝑠𝑒𝑛(𝑞2 − 𝑞1 )𝑞̇ 1 2 ) +
            𝑎6 (𝑐𝑜𝑠(𝑞3 − 𝑞2 )𝑞̈ 3 − 𝑠𝑒𝑛(𝑞3 − 𝑞2 )𝑞̇ 3 2 + 𝑏2 𝑞̈ 2 ) = 0       (5 – 18)


        Para la articulación 𝑞3 tenemos:


        𝑑       𝜕𝐿       𝜕𝐿
            (        ) − 𝜕𝑞 = 0, despreciaremos las fricciones de desplazamiento del
        𝑑𝑡 𝜕𝑞̇ 3           3

carro así como al movimiento de las articulaciones de los péndulos así como las
inercias rotatorias de los ejes.


        Resolviendo las derivadas y ordenando tenemos que:
            𝑎3 (𝑐𝑜𝑠𝑞3 𝑞̈ 0 − 𝑔𝑠𝑒𝑛𝑞3 ) + 𝑎5 (𝑐𝑜𝑠(𝑞3 − 𝑞1 )𝑞̈ 1 + 𝑠𝑒𝑛(𝑞3 − 𝑞1 )𝑞̇ 1 2 ) +
            𝑎6 (𝑐𝑜𝑠(𝑞3 − 𝑞2 )𝑞̈ 2 − 𝑠𝑒𝑛(𝑞3 − 𝑞2 )𝑞̇ 2 2 + 𝑏3 𝑞̈ 3 ) = 0       (5 – 19)


        Donde 𝑎4 = 𝑎2 𝐿1 ; 𝑎5 = 𝑎3 𝐿1 ; 𝑎6 = 𝑎3 𝐿2 .

                                                                                    66
         Resumiendo tenemos:
          𝑎0 𝑞̈ 0 + 𝑎1 (𝑐𝑜𝑠𝑞1 𝑞̈ 1 − 𝑠𝑒𝑛𝑞1 𝑞̇ 1 2 ) + 𝑎2 (𝑐𝑜𝑠𝑞2 𝑞̈ 2 − 𝑠𝑒𝑛𝑞2 𝑞̇ 2 2 ) +
          𝑎3 (𝑐𝑜𝑠𝑞3 𝑞̈ 3 − 𝑠𝑒𝑛𝑞3 𝑞̇ 3 2 ) = 𝐹


          𝑎1 (𝑐𝑜𝑠𝑞1 𝑞̈ 0 − 𝑔𝑠𝑒𝑛𝑞1 ) + 𝑎4 (𝑐𝑜𝑠(𝑞2 − 𝑞1 )𝑞̈ 2 − 𝑠𝑒𝑛(𝑞2 − 𝑞1 )𝑞̇ 2 2 ) +
          𝑎5 (𝑐𝑜𝑠(𝑞3 − 𝑞1 )𝑞̈ 3 − 𝑠𝑒𝑛(𝑞3 − 𝑞1 )𝑞̇ 3 2 + 𝑏1 𝑞̈ 1 ) = 0


          𝑎2 (𝑐𝑜𝑠𝑞2 𝑞̈ 0 − 𝑔𝑠𝑒𝑛𝑞2 ) + 𝑎4 (𝑐𝑜𝑠(𝑞2 − 𝑞1 )𝑞̈ 1 + 𝑠𝑒𝑛(𝑞2 − 𝑞1 )𝑞̇ 1 2 ) +
          𝑎6 (𝑐𝑜𝑠(𝑞3 − 𝑞2 )𝑞̈ 3 − 𝑠𝑒𝑛(𝑞3 − 𝑞2 )𝑞̇ 3 2 + 𝑏2 𝑞̈ 2 ) = 0


          𝑎3 (𝑐𝑜𝑠𝑞3 𝑞̈ 0 − 𝑔𝑠𝑒𝑛𝑞3 ) + 𝑎5 (𝑐𝑜𝑠(𝑞3 − 𝑞1 )𝑞̈ 1 + 𝑠𝑒𝑛(𝑞3 − 𝑞1 )𝑞̇ 1 2 ) +
          𝑎6 (𝑐𝑜𝑠(𝑞3 − 𝑞2 )𝑞̈ 2 − 𝑠𝑒𝑛(𝑞3 − 𝑞2 )𝑞̇ 2 2 + 𝑏3 𝑞̈ 3 ) = 0


4.2.2.    Modelamiento matemático del subsistema Motor – Polea.
         El modelamiento matemático para el subsistema motor polea se hará
usando la ley de voltajes de Kirchhoff .Ya que la inductancia del motor es
pequeña despreciaremos el efecto causado por este en el modelo:




                         Figura 18: Subsistema motor polea.


         De la figura podemos deducir que:
                                    𝑅𝑎 𝑖𝑎 + 𝑉𝑏 = 𝐾𝐴 . 𝑢 = 𝑉𝑎                         (5 – 20)
El voltaje contraelectromotriz está dado por:
                                                   𝑑𝜃
                                         𝑉𝑏 = 𝐾𝑏
                                                   𝑑𝑡
                                                                                     (5 – 21)
         Para el subsistema mecánico aplicamos la segunda ley de Newton a el
movimiento rotatorio, obtenemos:

                                                                                          67
                             𝑇𝑚 = 𝐽𝑒𝑞 𝜃̈𝑚 + 𝐵𝑒𝑞 𝜃̇𝑚 + 𝑛𝐹𝑟𝑝                                       (5 – 22)
       Donde:
                                    𝐽𝑒𝑞 = 𝐽𝑚 + 𝑛2 (𝐽𝑜 + 𝐽𝑝 )                                     (5 – 23)
                                      𝐵𝑒𝑞 = 𝐵𝑚 + 𝑛2 𝐵𝑜                                           (5 – 24)


       El torque producido en el servomotor es proporcional a la corriente de
armadura, por lo tanto obtenemos la ecuación siguiente:
                                              𝑇𝑚 = 𝐾𝑚 𝑖𝑎                                         (5 – 25)
       Sustituyendo la         ecuación 5-22 en 5 - 25                         y despejando para 𝑖𝑎 ,
obtenemos:

                                         𝐽         𝐵          𝑛𝐹𝑟
                                   𝑖𝑎 = 𝐾𝑒𝑞 𝜃̈ 𝑚 + 𝐾𝑒𝑞 𝜃̇ 𝑚 + 𝐾 𝑝                                (5 – 26)
                                             𝑚         𝑚                 𝑚



       Sustituyendo las ecuaciones 5 – 26 y 5 – 22 y despejando para F obtenemos
finalmente:
                          𝐾𝑚 𝐾𝐴         𝐽𝑒𝑞          𝐵    𝐾 𝐾
                  𝐹=               𝑢−         𝜃̈𝑚 − ( 𝑒𝑞 + 𝑚 𝑏 ) 𝜃̇ 𝑚                            (5 – 27)
                          𝑅𝑎 𝑛𝑟𝑝        𝑛𝑟𝑝            𝑛𝑟𝑝            𝑅𝑎 𝑛𝑟𝑝


       Para transformar el desplazamiento angular del motor en movimiento
horizontal del carro en función del radio de la polea y del factor de reducción
del motor, empleamos:
                                                        𝑥
                                                 𝜃𝑚 = 𝑛𝑟                                         (5 – 28)
                                                            𝑝

       Sustituyendo la última relación en 5 – 27 tenemos la ecuación general
del subsistema motor - polea, y está dada por:
                      𝐾𝑚 𝐾𝐴              𝐽𝑒𝑞                    𝐵𝑒𝑞            𝐾𝑚 𝐾𝑏
                𝐹=             𝑢−                  𝑥̈ − (               +                 ) 𝑥̇   (5 –29)
                      𝑅𝑎 𝑛𝑟𝑝            𝑛2 𝑟𝑝    2          𝑛2 𝑟𝑝 2          𝑅𝑎 𝑛2 𝑟𝑝 2


       Asignamos las siguientes variables para nuestra ecuación 5 -27, así:
                 𝐾𝑚
         𝐾𝑥 =
                𝑅𝑎 𝑛𝑟𝑝
                𝐽𝑒𝑞
         𝐽2 =
                𝑛𝑟𝑝
                𝐵𝑒𝑞       𝐾𝑚 𝐾𝑏
         𝐵𝑥 =         +
                𝑛𝑟𝑝       𝑅𝑎 𝑛𝑟𝑝

                                                                                                      68
        Haciendo que 𝑥 = 𝑞0 .
        Nos queda:
                                    𝐹 = 𝐾𝑥 𝐾𝐴 𝑢 − 𝐽2 𝑞̈ 0 − 𝐵𝑥 𝑞̇ 0                               (5 – 30)


        Sustituyendo esta ecuación en la ecuación (5 – 16) del subsistema carro –
péndulo triple, tenemos:
         𝑎0 𝑞̈ 0 + 𝑎1 (𝑐𝑜𝑠𝑞1 𝑞̈ 1 − 𝑠𝑒𝑛𝑞1 𝑞̇ 1 2 ) + 𝑎2 (𝑐𝑜𝑠𝑞2 𝑞̈ 2 − 𝑠𝑒𝑛𝑞2 𝑞̇ 2 2 ) +
         𝑎3 (𝑐𝑜𝑠𝑞3 𝑞̈ 3 − 𝑠𝑒𝑛𝑞3 𝑞̇ 3 2 ) = 𝐾𝑥 𝐾𝐴 𝑢 − 𝐽2 𝑞̈ 0 − 𝐵𝑥 𝑞̇ 0
         (5 – 31)


        Ordenando tenemos finalmente:
     𝑎 +𝐽             𝐵𝑥                  𝑎1                                     𝑎2
    ( 𝐾0 𝐾 2 ) 𝑞̈ 0 + 𝐾        𝑞̇ 0 + 𝐾        (𝑐𝑜𝑠𝑞1 𝑞̈ 1 − 𝑠𝑒𝑛𝑞1 𝑞̇ 1 2 ) + 𝐾         (𝑐𝑜𝑠𝑞2 𝑞̈ 2 −
       𝑥 𝐴            𝑥 𝐾𝐴              𝑥 𝐾𝐴                                     𝑥 𝐾𝐴
                          𝑎3
    𝑠𝑒𝑛𝑞2 𝑞̇ 2 2 ) + 𝐾           (𝑐𝑜𝑠𝑞3 𝑞̈ 3 − 𝑠𝑒𝑛𝑞3 𝑞̇ 3 2 ) = 𝑢
                          𝑥 𝐾𝐴

    (5 – 32)
        Agrupando las ecuaciones (5 – 17), (5 – 18),(5 – 19) y (5 – 27) y
reescribiendo en la forma :
                                       𝐷(𝑞)𝑞̈ + 𝐶(𝑞, 𝑞̇ )𝑞̇ + 𝑔(𝑞) = 𝜏                            (5 – 33)
        Obtenemos el siguiente resultado que representa                               la dinámica del
sistema del péndulo triple:


                      𝑑0                𝑑1 cos 𝑞1                𝑑2 cos 𝑞2 𝑑3 cos 𝑞3
                  𝑎1 cos 𝑞1                 𝑏1         𝑎2 L1 cos(q2 − 𝑞1 ) 𝑎3 L1 cos(q3 − 𝑞1 )
          𝐷(𝑞) =
                  𝑎2 cos 𝑞2
                                                                                                   (5 – 34)
                                   𝑎2 L1 cos(q2 − 𝑞1 )          𝑏2 𝑎3 L2 cos(q3 − 𝑞2 )
                 [𝑎3 cos 𝑞3        𝑎2 L1 cos(q2 − 𝑞1 )          𝑎3 L2 cos(q3 − 𝑞2 ) 𝑏3        ]



        Donde:
              𝑎0 + 𝐽2
         𝑑0 =
               𝐾𝑥 𝐾𝐴
               𝑎1
         𝑑1 =
              𝐾𝑥 𝐾𝐴
               𝑎2
         𝑑2 =
              𝐾𝑥 𝐾𝐴
               𝑎3
         𝑑3 =
              𝐾𝑥 𝐾𝐴

                                                                                                        69
                 𝐵𝑥
                            −𝑑1 sen𝑞1 𝑞̇ 1                −𝑑2 sen𝑞2 𝑞̇ 2   −𝑑3 sen𝑞3 𝑞̇ 3
                𝐾𝑥 𝐾𝐴

  𝐶(𝑞, 𝑞̇ ) =     0               0               𝑎2 L1 sen(q2 − 𝑞1 )𝑞̇ 2 𝑎3 L1 sen(q3 − 𝑞1 )𝑞̇ 3      (5 – 35)
                  0     𝑎2 L1 sen(q2 − 𝑞1 )𝑞̇ 1            0 −𝑎3 L2 sen(q3 − 𝑞2 )𝑞̇ 3
                [ 0     𝑎3 L1 sen(q2 − 𝑞1 )𝑞̇ 1             𝑎3 L2 sen(q3 − 𝑞2 )𝑞̇ 2 0             ]



                                                  0
                                              −𝑐1 𝑠𝑒𝑛𝑞1
                                      𝑔(𝑞) = [−𝑐 𝑠𝑒𝑛𝑞 ]                                               (5 – 36)
                                                2     2
                                              −𝑐3 𝑠𝑒𝑛𝑞3


                                                     𝐹
                                                     0
                                                  𝜏=[ ]                                               (5 – 37)
                                                     0
                                                     0


         Para expresar la ecuación (5 – 33) en su representación en el espacio de
estados, debemos despejar 𝑞̈ , nos queda:


                                             𝑞̈ = 𝐷−1 [𝜏 − 𝐶(𝑞, 𝑞̇ )𝑞̇ − 𝑔(𝑞)]                        (5 – 38)


         La inversa de D existe ya que esta es una matriz cuadrada simétrica
definida positiva, definiremos nuestras variables de estado como:


                                                   𝑥1    𝑞0
                                                   𝑥2    𝑞1
                                                   𝑥3    𝑞2
                                                   𝑥     𝑞3
                                               𝑿 = 𝑥4 = 𝑞̇ 0                                          (5 – 39)
                                                    5
                                                   𝑥6    𝑞̇ 1
                                                   𝑥7    𝑞̇ 2
                                                   𝑥
                                                  [ 8 ] [𝑞̇ ]
                                                                       3




4.2.3.    Modelamiento matemático en MATLAB
         Las ecuaciones anteriormente desarrolladas son llevadas al programa del
MATLAB para las simulaciones respectivas.




                                                                                                           70
%% MODELAMIENTO MATEMATICO DEL PENDULO TRIPLE

clc;close all ;
syms xp u m0 m1 m2 m3 l1 l2 l3;
syms x1 x2 x3 x4 x5 x6 x7 x8;

%Momento de inercia de los links
J1=0;
J2=0;
J3=0;

% longitud al centro de masas
lc1=0.5*l1;
lc2=0.5*l2;
lc3=0.5*l3;

% Coeficiente de gravitación
g=9.81;

% constantes para simplificacion
a0=m0+m1+m2+m3;
a1=m2*l1+m3*l1+m1*lc1;
a2=m2*lc2+m3*l2;
a3=m3*lc3;

b1=J1+(m1*lc1*lc1)+(m2*l1*l1)+(m3*l1*l1);
b2=J2+(m2*lc2*lc2)+(m3*l2*l2);
b3=J3+m3*lc3*lc3;

c1=g*a1;
c2=g*a2;
c3=g*a3;

% Fricción Viscosa
 bc=0; k1=0; k2=0; k3=0;

%   Matriz de Inercia M(q)
%   Definimos los estados como
%   q =[x1 x2 x3 x4]
%   qp=[x5 x6 x7 x8]
%   donde x1:=posicion del carro, x2:=posicion angular 1
%   x3:=posicion angular 2 , x4:=posicion angular 3
%   x5:=velocidad del carro x6:=velocidad angular 1
%   x7:=velocidad angular 2 x8:=velocidad angular 3

% PARAMETROS DEL MOTOR
rp = 0.019; n = 11/75;Jo = 0;
Jm = 6.37e-6;mp = 0.045;
Jp = mp*rp^2/2;
Jeq = Jm + n^2*(Jo + Jp);
Bm = 4.23e-6; Bo =4.23e-8; Beq = Bm + n^2*Bo;
Km = 86.02e-3; Kb = 86.47e-3; Ra = 37.38; KA = 4.8;



                                                           71
J2 = Jeq/(n^2*rp^2);
Kx = Km/(Ra*n*rp);
Bx = Beq/(n^2*rp^2) + Kb*Km/(n^2*rp^2*Ra);
KxA=Kx*KA;

%Elementos de la matriz de Inercias
M11=a0/KxA+J2/KxA;
M12=a1/KxA*cos(x2);
M13=a2/KxA*cos(x3);
M14=a3/KxA*cos(x4);

M21=a1*cos(x2);
M22=b1;
M23=a2*l1*cos(x3-x2);
M24=a3*l1*cos(x4-x2);

M31=a2*cos(x3);
M32=a2*l1*cos(x3-x2);
M33=b2;
M34=a3*l2*cos(x4-x3);

M41=a3*cos(x4);
M42=a3*l1*cos(x4-x2);
M43=a3*l2*cos(x4-x3);
M44=b3;

%Vector de Fuerzas de Coriolis y de Fuerzas Centripetas

C11=bc/KxA+Bx/KxA;
C12=a1/KxA*sin(x2)*x6;
C13=a2/KxA*sin(x3)*x7;
C14=a3/KxA*sin(x4)*x8;

C21=0;
C22=k1+k2;
C23=-k2-a2*l1*sin(x3-x2)*x7;
C24=-a3*l1*sin(x4-x2)*x8;

C31=0;
C32=-k2+a2*l1*sin(x3-x2)*x6;
C33=k2+k3;
C34=-k3-a3*l2*sin(x4-x3)*x8;

C41=0;
C42=a3*l1*sin(x4-x2)*x6;
C43=-k3+a3*l2*sin(x4-x3)*x7;
C44=k3;

%Matriz de Gravedad
G1=0;
G2=-c1*sin(x2);
G3=-c2*sin(x3);
G4=-c3*sin(x4);


                                                          72
% %Matriz de Fricción Viscosa y Seca
% Fr1=b1*x2+k1*tanh(beta*x2);
% Fr2=b2*x4+k2*tanh(beta*x4);

% Variables Articulares y Derivadas
q=[x1;x2;x3;x4];
qp=[x5;x6;x7;x8];

% Matrices
M=[M11,M12,M13,M14;
M21,M22,M23,M24;
M31,M32,M33,M34;
M41,M42,M43,M44];

C=[C11,-C12,-C13,-C14;
C21,C22,C23,C24;
C31,C32,C33,C34;
C41,C42,C43,C44];

G=[G1;G2;G3;G4];
% w=1;
% f=5*sin(w*t);
f=u;
T=[f;0;0;0];

N=C*qp+G;

% Ecuaciones de Estado
qpp=inv(M)*(T-N);

% Sustituyendo en el punto de equilibrio.
Equi=subs(qpp,{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0})
;

xp=[x5; x6;   x7; x8; qpp(1);qpp(2);qpp(3); qpp(4)];




                                                            73
4.2.4.    Variables y parámetros del proceso
          El siguiente cuadro muestra las variables y los valores de los parámetros
del péndulo triple.


                    Cuadro 3. Variables y parámetros del Péndulo Triple.
Símbolo                            Descripción                      Valor /Formula
  𝒒𝟎          Posición del carro                                             M
  𝒒𝟏          Posición angular de la primera varilla                        Rad
  𝒒𝟐          Posición angular de la segunda varilla                        Rad
  𝒒𝟑          Posición angular de la tercera varilla                        Rad
  U           Señal de control                                              Volts.
  𝒎𝟎          Masa del carro                                           0.370 Kg
  𝒎𝟏          Masa de la primera varilla                               0.073 Kg
  𝒎𝟐          Masa de la segunda varilla                               0.087 Kg
  𝒎𝟑          Masa de la tercera varilla                               0.096 Kg
  𝒎𝒑          Masa de la polea                                             0.045Kg
  𝑳𝟏          Longitud de la primera varilla                               0.25mts
  𝑳𝟐          Longitud de la segunda varilla                               0.27mts
  𝑳𝟑          Longitud de la tercera varilla                               0.29mts
  G           gravedad                                                 9.81 𝑚⁄𝑠 2
  𝑹𝒂          Resistencia de armadura del motor DC                          37Ω
  𝑳𝒂          Inductancia del motor                                   Se despreció
  𝑲𝒃          Constante contraelectromotriz                        86.47𝑥10−3 𝑉/𝑟𝑎𝑑
  𝑲𝒎          Constante de torque del motor                        86.02𝑥10−3 𝑉/𝑟𝑎𝑑
  𝑱𝒎          Inercia del eje primario del motor                  6.37𝑥10−6 𝑘𝑔 − 𝑚2
  𝑩𝒎          Fricción viscosa del eje primario                                    𝑁−𝑚
                                                                   4.23𝑥10−6
                                                                                   𝑟𝑎𝑑/𝑠
  𝑱𝒐          Inercia del eje secundario                          1.22𝑥10−6 𝑘𝑔 − 𝑚2
  𝑩𝒐          Fricción viscosa del eje secundario                                  𝑁−𝑚
                                                                   2.13𝑥10−8
                                                                                   𝑟𝑎𝑑/𝑠
  N           Factor de reducción de velocidad de los engranes             0.1467
  𝒓𝒑          Radio de la polea                                            0.019m
  𝑱𝒑          Momento de inercia de la polea                     8.1225𝑥10−6 𝑘𝑔 − 𝑚2
  𝑲𝑨          Ganancia del amplificador                                      4.8
  T           Periodo de muestreo                                           0.01




                                                                                       74
4.2.5.   Linealización del sistema.
         Una vez obtenido el modelo no lineal del sistema péndulo triple, es
necesario linealizar el sistema alrededor de un punto de equilibrio, para nuestro
caso linealizaremos alrededor del punto {𝑥1 , 𝑥2 , 𝑥3 , 𝑥4 , 𝑥5 , 𝑥6 , 𝑥7 , 𝑥8 , 𝑢} =
{0,0,0,0,0,0,0,0,0} ya que las variaciones de los ángulos 𝑞1 , 𝑞2 , 𝑞3           son
pequeñas alrededor de 0.
         El código utilizado en el MATLAB para realizar esta tarea es :
         % Linealización

         A1=diff(xp,x1);
         A2=diff(xp,x2);
         A3=diff(xp,x3);
         A4=diff(xp,x4);
         A5=diff(xp,x5);
         A6=diff(xp,x6);
         A7=diff(xp,x7);
         A8=diff(xp,x8);
         A=subs([A1 A2 A3 A4 A5 A6 A7
         A8],{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0});

         B1=diff(xp(1),u);
         B2=diff(xp(2),u);
         B3=diff(xp(3),u);
         B4=diff(xp(4),u);
         B5=diff(xp(5),u);
         B6=diff(xp(6),u);
         B7=diff(xp(7),u);
         B8=diff(xp(8),u);
         B=subs([B1 B2 B3 B4 B5 B6 B7
         B8]',{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0});
         %% Parámetros .
         % masa del carrito

         m0=0.370;

         % masas de los péndulos
         m1=0.073;
         m2=0.087;
         m3=0.096;

         % longitud de los péndulos
         l1=0.25;
         l2=0.27;
         l3=0.29;

         %Momento de inercia de los links
         J1=0;
         J2=0;
         J3=0;

                                                                                  75
% longitud al centro de masas
lc1=0.5*l1;
lc2=0.5*l2;
lc3=0.5*l3;

% Coeficiente de gravitación
g=9.81;

% constantes para simplificación
a0=m0+m1+m2+m3;
a1=m2*l1+m3*l1+m1*lc1;
a2=m2*lc2+m3*l2;
a3=m3*lc3;
a4=a2*l1;
a5=a3*l1;
a6=a3*l2;

b1=J1+(m1*lc1*lc1)+(m2*l1*l1)+(m3*l1*l1);
b2=J2+(m2*lc2*lc2)+(m3*l2*l2);
b3=J3+m3*lc3*lc3;

% MODELO LINEAL     DEL PROCESO

A=subs(A);
B=subs(B);

C=[1 0 0 0 0 0 0 0
    0 1 0 0 0 0 0 0
    0 0 1 0 0 0 0 0
    0 0 0 1 0 0 0 0];

D=[0];


Dándonos los siguientes resultados:




                                            76
     1     0     0   0   0   0   0    0                              0
𝐶 = [0     1     0   0   0   0   0    0]   ;                    𝐷 = [0]
     0     0     1   0   0   0   0    0                              0
     0     0     0   1   0   0   0    0                              0



  4.2.6.       Modelo en espacio de estado discreto
           Utilizaremos el Matlab para obtener el modelo discreto del sistema, para
  esto usamos la siguiente instrucción:


                                     [G,H]=c2d(A,B,T)


  Donde A es la matriz de estado en tiempo continuo, B es la matriz de entrada en
  tiempo continuo y T representa el periodo de muestreo, para obtener el periodo
  de muestreo se hizo pruebas experimentales en el sistema físico real, en el que
  se pudo observar que se adquirían aproximadamente 100 muestras por segundo,
  por lo tanto se consideró un periodo de muestreo de 10ms o 0.01 segundos.


  La matriz de estado y entrada en tiempo discreto se muestra a continuación:




                                                                                77
4.3.   ESTIMADOR DE PARÁMETROS DEL PROCESO


               El controlador adaptativo utilizado necesita de un bloque de estimación
       o identificación     de parámetros del proceso, de modo que los parámetros
       estimados coincidan con los parámetros reales. Para estimar los parámetros de
       un proceso es común utilizar el método de los mínimos cuadrados recursivos
       ,pero este método presenta problemas numéricos ya que su algoritmo tiene
       características divergentes, es decir que en cada iteración las variables usadas
       tienden a tomar valores muy grandes hasta el punto de tender al infinito,
       causando problemas al programa de control ; para evitar esto se utilizo una
       mejora de este algoritmo ,además al estimar para varias salidas es necesario
       usar el Método de los Mínimos Cuadrados Recursivos Mejorados
       Multivariable.


        Para nuestro sistema, tenemos:
                                    𝑥(𝑘 + 1) = 𝐺𝑥(𝑘) + 𝐻𝑢(𝑘)
                                          𝑦(𝑘) = 𝐶𝑥(𝑘)                                  (5 - 40)


               En este paso estimaremos las matrices de estado G y H a partir de las
       señales de entrada 𝑢(𝑘) y las variables de salida, en este caso tomaremos las
       variables de estado {𝑥1 (𝑘), 𝑥2 (𝑘), 𝑥3 (𝑘), 𝑥4 (𝑘), 𝑥5 (𝑘), 𝑥6 (𝑘), 𝑥7 (𝑘), 𝑥8 (𝑘)} y las
       denotaremos por 𝐺̂ , 𝐻
                            ̂ ,para esto reordenaremos la ecuación (5 – 40) de la forma
       siguiente:


                                    𝑌(𝑘) = 𝜃̂(𝑘)𝜑 𝑇 (𝑘)                                 (5 - 41)
                                                                                              78
       El método de los MCRM consta de los siguientes pasos:
       1.- Obtener el vector de parámetros inicial a partir de los datos del
            modelo del proceso.
                                   𝜃̂(0) = [𝐺 𝐻 𝟎]                             (5 - 42)


       2.- Obtener el valor inicial del parámetro 𝜁(0) = [𝟎] .
            Y el regresor está dado por:



𝜑(𝑘) = [𝑥1 (𝑘) 𝑥2 (𝑘) 𝑥3 (𝑘) 𝑥4 (𝑘) 𝑥5 (𝑘) 𝑥6 (𝑘) 𝑥7 (𝑘) 𝑥8 (𝑘) 𝑢(𝑘) 𝟏]        (5 - 43)



       3.-Denotaremos la matriz de covarianza inicial como P= 𝛼𝐼, donde 𝐼
          es la matriz identidad de orden 10 y 𝛼 es una constante que debe
          ser mucho mayor a 1, se tomo un valor de 𝛼 = 1000.


       4.-Tomar     nuevas    mediciones     de      las   variables    de    salida
          ( 𝑥1 (𝑘), 𝑥2 (𝑘), 𝑥3 (𝑘), 𝑥4 (𝑘), 𝑥5 (𝑘), 𝑥6 (𝑘), 𝑥7 (𝑘), 𝑥8 (𝑘) ) y de la
          señal de entrada 𝑢(𝑘) y expresar en la forma 𝑌(𝑘) = 𝜃̂(𝑘)𝜑 𝑇 (𝑘) .


       5.-Computar el valor de:
                      𝜌(𝑘) = max(1, ‖𝜓(𝑘)‖) ; 𝜓𝑛 = 𝜓/𝜌(𝑘)                    (5 - 44)



       6.-Determinar la matriz 𝑁(𝑘) aplicando la factorización de cholesky
          en:

                                        𝑁(𝑘)𝑁(𝑘)𝑇 = 𝑃(𝑘)                     (5 - 45)



       7.-Calcular la matriz de escalamiento 𝑆(𝑘) que minimiza el numero
          condicional del producto 𝑆(𝑘)𝑁(𝑘).


       8.-Computar:
                                                                                        79
                                                                    (5 - 46)
         9.-Implementar el criterio para parar la estimación y encontrar una
           nueva matriz de escalamiento.


4.3.1.    Pasos para la estimación en el MATLAB.
         Los pasos 1,2 y 3 se dan por:




Los pasos 4,5,6,7y 8 se muestran a continuación :




                                                                               80
El paso 9, el criterio para parar la estimación y encontrar una nueva matriz de
escalamiento está dada por:




                                    Para probar la eficacia de este algoritmo de identificación de
parámetros, se varían los parámetros en t=4 y luego en t=8 segundos, estos
resultados se muestran a continuación:


                         2.5
                                                                                                a1
                                                                                                a2
                           2                                                                    a3
                                                                                                a4
                                                                                                a5
                         1.5                                                                    a6
                                                                                                a7
                                                                                                a8

                           1
  PARAMETROS ESTIMADOS




                         0.5



                           0



                         -0.5



                          -1



                         -1.5



                          -2
                                0       1    2       3      4         5        6   7    8   9        10
                                                                 Tiempo (seg


                                                 Figura 19: Identificación de parámetros.

                                                                                                          81
              De acuerdo con los resultados obtenidos, el estimador de parámetros es
       capaz de identificar el sistema frente a los cambios en la dinámica del proceso
       debidos a perturbaciones e incertidumbres no modeladas.



4.4.   DISEÑO DEL CONTROLADOR ADAPTATIVO


              Una vez obtenido las matrices de estado y entrada estimados diseñamos
       el controlador, el controlador adaptativo utilizará como estructura o ley de
       control un control proporcional integral óptimo cuadrático con realimentación
       de estados.
       El esquema del controlador propuesto se muestra a continuación.




             Figura 20: Estructura del sistema de control Adaptativo del Péndulo Triple.


       Del grafico podemos observar que.


                                  𝑥(𝑘 + 1) = 𝐺̂ 𝑥(𝑘) + 𝐻
                                                       ̂ 𝑢(𝑘)                              (5 - 47)
                                         𝑦(𝑘) = 𝐶𝑥(𝑘)                                      (5 - 48)
                                 𝑣(𝑘) = 𝑣(𝑘 − 1) + 𝑟(𝑘) − 𝑦(𝑘)                             (5 - 49)
                                     𝑢(𝑘) = −𝐾𝑥(𝑘) + 𝐾𝐼𝑣(𝑘)                                (5 - 50)
       𝑑𝑜𝑛𝑑𝑒 ∶                        𝐾 = [𝑘1 𝑘2 𝑘3 𝑘4 𝑘5 𝑘6 𝑘7 𝑘8 ]                       (5 - 51)


       De la ecuación (5 – 49) obtenemos:
                           𝑣(𝑘 + 1) = 𝑣(𝑘) + 𝑟(𝑘 + 1) − 𝑦(𝑘 + 1)

                                                                                                82
Sustituyendo (5 – 48) para 𝑦(𝑘 + 1) tenemos:


                    = 𝑣(𝑘) + 𝑟(𝑘 + 1) − 𝐶[𝐺̂ 𝑥(𝑘) + 𝐻
                                                    ̂ 𝑢(𝑘) ]

                          = 𝐶𝐺̂ 𝑥(𝑘) + 𝑣(𝑘) − 𝐶𝐻
                                               ̂ 𝑢(𝑘) + 𝑟8𝑘 + 1)           (5 - 52)


Definiendo nuevas variables de estado tenemos:


          𝑥(𝑘 + 1)     ̂        𝟎] [𝑥(𝑘)] + [ 𝐻
                                              ̂             𝟎
      [            ]=[𝐺                           ] 𝑢(𝑘) + [ ] 𝑟(𝑘 + 1)    (5 - 53)
          𝑣(𝑘 + 1)    𝐶𝐺̂       𝟏   𝑣(𝑘)     −𝐶𝐻̂           𝟏


Si la entrada de referencia se toma constante tenemos que:
                                 𝑟(𝑘)    = 𝑟(𝑘 + 1) = 𝑟                    (5 - 54)
Entonces cuando 𝑘 se aproxima a infinito:


                  𝑥(∞)     ̂      𝟎] [𝑥(∞)] + [ 𝐻
                                                ̂             𝟎
              [        ]=[𝐺                         ] 𝑢(∞) + [ ] 𝑟(∞)      (5 - 55)
                  𝑣(∞)    𝐶𝐺̂     𝟏   𝑣(∞)     −𝐶𝐻̂           𝟏


Si definimos:
                                  𝑥𝑒 (𝑘) = 𝑥(𝑘) − 𝑥(∞)
                                 𝑣𝑒 (𝑘) = 𝑣(𝑘) − 𝑣(∞)                      (5 - 56)


Entonces la ecuación de error se convierte en:


                          𝑥𝑒 (𝑘 + 1)     ̂    𝟎] [𝑥𝑒 (𝑘)] + [ 𝐻
                                                              ̂
                      [              ]=[𝐺                        ] 𝑢 (𝑘)   (5 - 57)
                          𝑣(𝑘 + 1)      𝐶𝐺̂   𝟏 𝑒 𝑣  (𝑘)     −𝐶𝐻̂ 𝑒


Donde:
                                                          𝑥𝑒 (𝑘)
      𝑢𝑒 (𝑘) = −𝑲𝑥𝑒 (𝑘) + 𝑲𝑰𝑣𝑒 (𝑘) = −[𝑲 − 𝑲𝑰 ] [                ]         (5 - 58)
                                                          𝑣𝑒 (𝑘)
Ahora definimos nuevas ecuaciones de estado, tenemos:

                                      ̂ = [ 𝐺̂ 𝟎]
                                      𝐺1                                   (5 - 59)
                                           𝐶𝐺̂ 𝟏
                                       ̂ =[ 𝐻 ̂
                                      𝐻1          ]                        (5 - 60)
                                            −𝐶𝐻 ̂

                                                                                83
La nueva matriz de ganancia de retroalimentación de estados será:


                                     𝑲𝟏 = −[𝑲 − 𝑲𝑰 ]                (5 - 61)


La señal de control estará dada por:
                                        𝑤(𝑘) = 𝑢𝑒 (𝑘)               (5 - 62)
Las variables de estado serán:
                                              𝑥1𝑒 (𝑘)
                                              𝑥2𝑒 (𝑘)
                                              𝑥3𝑒 (𝑘)
                                              𝑥4𝑒 (𝑘)
                                   𝑥𝑒 (𝑘)
                          𝜀(𝑘) = [        ] = 𝑥5𝑒 (𝑘)               (5 - 63)
                                   𝑣(𝑘)
                                              𝑥6𝑒 (𝑘)
                                              𝑥7𝑒 (𝑘)
                                              𝑥8𝑒 (𝑘)
                                             [𝑥9𝑒 (𝑘)]
Entonces nos queda:


                              ̂ 𝜀(𝑘) + 𝐻1
                   𝜀(𝑘 + 1) = 𝐺1       ̂ 𝑤(𝑘)
                         𝑤(𝑘) = −𝑲𝟏𝜀(𝑘)                             (5 - 64)


El problema consiste en determinar la matriz 𝑲𝟏 que minimice el siguiente
índice de desempeño cuadrático:
                                 1
                           𝐽 = 2 ∑∞    𝑇      𝑇
                                  𝑘=0[𝜀 𝑄𝜀 + 𝑤 𝑅𝑤]                  (5 - 65)

Donde Q y R se escogen como:




Y 𝑅 = [100]


                                                                         84
Donde Q es una matriz hermitiana semidefinida positiva que pondera la
importancia del vector de estados 𝜀(𝑘), en este caso se da mayor peso a las
posiciones angulares del péndulo con valores de 100, mientras que a la posición
del carro se le da una valor de 1 ya que el sensor del carro es más exacto que los
sensores usados para medir los ángulos, al integrador se le asigna un valor de 1
para evitar la saturación. La matriz R pondera la importancia de la señal de
control 𝑢(𝑘) por tanto este valor será de 100 para evitar la saturación en los
amplificadores y así evitar las no linealidades en el sistema.


4.4.1.      Diseño del controlador en Matlab
         En el siguiente programa el sistema se fija un Set Point de 0.5 metros
para la posición del carro y 0 radianes para las posiciones angulares de las
varillas.




                                                                               85
4.4.2.                                                 Respuestas Gráficas
Las respuestas del sistema sujetas a un Set Point de 0.5 metros para la posición
del carro y 0 radianes para las posiciones angulares de los péndulos, se
muestran a continuación:

                                            0.6                                                                               0.04                                                                              0.04
               Posición del carro [mts.]




                                                                                 Posición Angular 1 [rad]




                                                                                                                                                                    Posición Angular 2 [rad]


                                            0.4
                                                                                                                              0.02                                                                              0.02
                                            0.2
                                                                                                                                 0                                                                                                0
                                              0

                                            -0.2                                                                              -0.02                                                                    -0.02
                                                   0   2   4        6   8   10                                                        0   2   4        6   8   10                                                                      0   2   4        6   8   10
                                                           Tiempo (s)                                                                         Tiempo (s)                                                                                       Tiempo (s)
                                                                                                                                                                    Velocidad Angular 1 [rad/s]
                                                                                                Velocidad del carro [mts/s]




                                           0.04                                                                                0.3                                                                              0.15
Posición Angular 3 [rad]




                                                                                                                               0.2                                                                                               0.1
                                           0.02
                                                                                                                               0.1                                                                              0.05
                                              0
                                                                                                                                 0                                                                                                0

                                           -0.02                                                                               -0.1                                                                    -0.05
                                                   0   2   4        6   8   10                                                        0   2   4        6   8   10                                                                      0   2   4        6   8   10
                                                           Tiempo (s)                                                                         Tiempo (s)                                                                                       Tiempo (s)
                                                                                                                                                                                                  Señal de Control U(t)[Volts]
Velocidad Angular 2 [rad/s]




                                                                                 Velocidad Angular 3 [rad/s]




                                           0.15                                                                               0.15                                                                                                2

                                            0.1                                                                                0.1
                                                                                                                                                                                                                                  1
                                           0.05                                                                               0.05
                                                                                                                                                                                                                                  0
                                              0                                                                                  0

                                           -0.05                                                                              -0.05                                                                                               -1
                                                   0   2   4        6   8   10                                                        0   2   4        6   8   10                                                                      0   2   4        6   8   10
                                                           Tiempo (s)                                                                         Tiempo (s)                                                                                       Tiempo (s)
                                              Figura 21: Respuestas del sistema a un Set Point de 0.5 m. (carro) y 0 radianes (varillas).




                                                                                                                                                                                                                                                                86
                                                                                             0.6                                                                                                                                         0.3




                                                                                             0.5                                                                                                                                        0.25




                                                                                             0.4                                                                                                                                         0.2




                                                                                                                                                                     Velocidad del carro [mts/s]
                                                                Posición del carro [mts.]




                                                                                             0.3                                                                                                                                        0.15




                                                                                             0.2                                                                                                                                         0.1




                                                                                             0.1                                                                                                                                        0.05




                                                                                                  0                                                                                                                                        0




                                                                                             -0.1                                                                                                                                       -0.05
                                                                                                      0       1       2   3    4       5        6   7   8   9   10                                                                              0   1   2   3   4           5         6       7       8       9       10
                                                                                                                                   Tiempo (s)                                                                                                                           Tiempo (s)

                                                                                                                                         Figura 22: Posición y velocidad lineal del carro .

                                                                  0.035                                                                                                                                                                 0.12



                                                                                0.03                                                                                                                                                     0.1


                                                                  0.025
                                                                                                                                                                                                                                        0.08
                                                                                                                                                                     Velocidad Angular de la Primera Varilla [rad/s]
Posición Angular de la Primera Varilla [rad]




                                                                                0.02
                                                                                                                                                                                                                                        0.06

                                                                  0.015
                                                                                                                                                                                                                                        0.04

                                                                                0.01

                                                                                                                                                                                                                                        0.02
                                                                  0.005

                                                                                                                                                                                                                                           0
                                                                                              0


                                                                                                                                                                                                                                        -0.02
                                                                -0.005



                                                                        -0.01                                                                                                                                                           -0.04



                                                                -0.015                                                                                                                                                                  -0.06
                                                                                                  0       1       2       3    4       5        6   7   8   9   10                                                                              0   1   2   3   4           5         6       7       8       9        10
                                                                                                                                   Tiempo (s)                                                                                                                           Tiempo (s)


                                                                                                                              Figura 23: Posición y velocidad angular de la primera varilla.


                                                                            0.035                                                                                                                                                        0.08



                                                                                            0.03
                                                                                                                                                                                                                                         0.06

                                                                            0.025
                                                                                                                                                                                      Velocidad Angular de la Segunda Varilla [rad/s]
                 Posición Angular de la Segunda Varilla [rad]




                                                                                                                                                                                                                                         0.04
                                                                                            0.02



                                                                            0.015
                                                                                                                                                                                                                                         0.02

                                                                                            0.01

                                                                                                                                                                                                                                            0
                                                                            0.005



                                                                                              0
                                                                                                                                                                                                                                        -0.02


                                                                   -0.005

                                                                                                                                                                                                                                        -0.04
                                                                                  -0.01



                                                                   -0.015                                                                                                                                                               -0.06
                                                                                                   0      1       2       3    4       5        6   7   8   9   10                                                                              0   1   2   3       4        5            6       7       8       9    10
                                                                                                                                   Tiempo (s)                                                                                                                            Tiempo (s)

                                                                                                                              Figura 24: Posición y velocidad angular de la segunda varilla.




                                                                                                                                                                                                                                                                                                                            87
                                                       0.03                                                                                                                                                     0.08



                                               0.025
                                                                                                                                                                                                                0.06


                                                       0.02




                                                                                                                                            Velocidad Angular de la Tercera Varilla [rad/s]
Posición Angular de la Tercera Varilla [rad]


                                                                                                                                                                                                                0.04
                                               0.015


                                                                                                                                                                                                                0.02
                                                       0.01



                                               0.005
                                                                                                                                                                                                                  0


                                                                 0
                                                                                                                                                                                                         -0.02

                                               -0.005


                                                                                                                                                                                                         -0.04
                                                  -0.01



                                               -0.015                                                                                                                                                    -0.06
                                                                     0       1       2       3       4       5         6   7   8   9   10                                                                              0   1   2   3   4       5        6   7   8   9   10
                                                                                                         Tiempo (s)                                                                                                                        Tiempo (s)

                                                                                                     Figura 25: Posición y velocidad angular de la tercera varilla.


                                                                 100                                                                                                                                               2



                                                                 90



                                                                 80                                                                                                                                              1.5



                                                                 70
                                                                                                                                                                                 Señal de Control U(t)[Volts]




                                                                 60                                                                                                                                                1
                                               Acción Integral




                                                                 50



                                                                 40                                                                                                                                              0.5



                                                                 30



                                                                 20                                                                                                                                                0



                                                                 10



                                                                     0                                                                                                                                          -0.5
                                                                         0       1       2       3   4        5        6   7   8   9   10                                                                              0   1   2   3   4       5        6   7   8   9   10
                                                                                                          Tiempo (s)                                                                                                                       Tiempo (s)

                                                                                                                Figura 26: Acción integral y señal de control u(k).




                                                                                                                                                                                                                                                                             88
4.4.3.                                           Prueba de la adaptatibilidad del controlador.
                                                Para probar la adaptatibilidad del controlador frente a cambios en los
parámetros y en la señal de entrada, se realiza variaciones en los parámetros del
sistema en los tiempos de 15, 27, 45, 60 y 75 segundos. En la siguiente gráfica
se muestra cómo evolucionan los parámetros estimados del controlador.

                                    40
                                                                                                                         masa del carro
                                                                                                                         masa de la pendulo 1
                                                                                                                         masa de la pendulo 2
                                                                                                                         masa de la pendulo 3
                                    30                                                                                   longitud del pendulo 1
                                                                                                                         longitud del pendulo 2
                                                                                                                         longitud del pendulo 3


                                    20
            PARAMETROS ESTIMADOS




                                    10




                                      0




                                    -10




                                    -20
                                          0          10        20        30       40                  50   60   70         80                     90
                                                                                       Tiempo (seg)

                                                              Figura 27: Estimador de parámetros.

                                                 La respuesta del controlador adaptativo se muestra a continuación:


                                   1.5
                                                                                                                           Posicion del carro
                                                                                                                           Señal de referencia


                                     1




                                   0.5
Posición del carro [mts.]




                                     0




                                   -0.5




                                    -1




                                   -1.5
                                          0          10       20        30        40                  50   60   70        80                      90
                                                                                        Tiempo (s)



                                              Figura 28: Sistema lineal variable con Control Adaptativo (Posición del carro).


                                                De la figura se observa que el controlador adaptativo responde a las
variaciones en la señal de entrada.



                                                                                                                                                 89
                                             Las siguientes figuras muestran el comportamiento de las señales de
                           posición angular de las varillas, se puede observar que a pesar de los cambios
                           en la señal de entrada los péndulos no superan los 0.15 radianes o 8.5 grados,
                           por lo tanto el sistema responde según lo esperado.


                                0.08



                                0.06



                                0.04



                                0.02
    Posición Angular 1 [rad]




                                   0



                               -0.02



                               -0.04



                               -0.06



                               -0.08



                                -0.1



                               -0.12
                                       0         10        20        30        40                50   60     70        80     90
                                                                                    Tiempo (s)


                                           Figura 29: Sistema lineal variable con Control Adaptativo (Posición angular 1).


                               0.08



                               0.06



                               0.04



                               0.02
Posición Angular 2 [rad]




                                  0



                               -0.02



                               -0.04



                               -0.06



                               -0.08



                                -0.1
                                       0         10        20        30        40                50   60     70        80     90
                                                                                    Tiempo (s)



                                             Figura 30: Sistema lineal variable con Control Adaptativo(Posición angular 2).




                                                                                                                              90
                            0.06




                            0.04




                            0.02




                                     0
Posición Angular 3 [rad]




                            -0.02




                            -0.04




                            -0.06




                            -0.08




                             -0.1
                                         0        10         20          30      40                50      60          70      80                  90
                                                                                      Tiempo (s)

                                             Figura 31: Sistema lineal variable con Control Adaptativo(Posición angular 3).


                                              La señal de control se muestra a continuación:
          0.15
                                                                                                                                    Señal de control u



                           0.1




          0.05




                            0




  -0.05




                -0.1




  -0.15




                -0.2
                                 0                     500        1000        1500                  2000        2500        3000                     3500

                                             Figura 32: Sistema lineal variable con Control Adaptativo (Señal de control).




                                                                                                                                                            91
4.4.4.   Diseño del observador de estados.

         El controlador adaptativo diseñado utiliza una ley de control
proporcional integral óptimo cuadrática variable, esta estructura de control
necesita de la realimentación de todas las variables de estado, sin embargo en
la práctica esto no siempre es posible, ya que no todas están disponibles para la
medición directa ,en nuestro proyecto solo las variables de salida son medibles,
mientras que las velocidades angulares y lineal no tienen una lectura por parte
de los sensores, por lo tanto será necesario estimar estas variables. La
estimación suele llamarse observación, en un sistema práctico es necesario
observar o estimar las variables de estado no medibles a partir de las variables
de salida y control. Un observador de estados es un subsistema del sistema de
control, estos se pueden diseñar si y solo si satisfacen la condición de
observabilidad.




                  Figura 33: Sistema de regulación con observador de estados.


         En muchos casos prácticos, sólo unas cuantas variables del vector de
estado x(k) del proceso son susceptibles de ser medidas en forma directa. En
tales situaciones necesitamos estimar dicho vector de estado; es decir,
requerimos hallar un vector de estado estimado 𝑥̂(𝑘) . Esto puede lograrse
mediante el empleo de un observador discreto de estados. El diseño de dicho
observador implica determinar su matriz de ganancia Ke, que puede ser
calculada a partir de la minimización de una función de costo cuadrática. El
                                                                                92
      diagrama de bloques del observador de estados se representa en la figura 26,
      donde podemos notar que el observador emplea las mediciones de la salida y(k)
      y de la señal de control u(k).
      De la figura podemos formular:
                                  𝑥(𝑘 + 1) = 𝐺𝑥(𝑘) + 𝐻𝑢(𝑘)                                   (5 - 66)
                                        𝑦(𝑘) = 𝐶𝑥(𝑘)                                         (5 - 67)
      Mientras que la ecuación del observador de estados toma la forma:

                      𝑥̂(𝑘 + 1) = 𝐺𝑥̂(𝑘) + 𝐻𝑢(𝑘) + 𝐾𝑒[𝑦(𝑘) − 𝐶𝑥̂(𝑘)]                         (5 - 68)
              Donde 𝑥̂(𝑘) es el vector de estado estimado de dimensión 8, 𝑦̂(𝑘)
      representa el vector de salida estimado de dimensión 4, Ke es la matriz de
      ganancia de realimentación del observador con dimensión 8 × 4 y C es la
      matriz de salida de dimensión 4 × 8. Reemplazando la ecuación (5 – 67) en (5 –
      68) y restando la ecuación resultante de (5 – 66 ), podemos obtener la ecuación
      del error del observador:

                                             𝑒(𝑘 + 1) = [𝐺 − 𝐾𝑒𝐶]𝑒(𝑘)
                                         𝑒(𝑘) = 𝑥(𝑘) − 𝑥̂(𝑘)                                 (5 - 69)

      mientras que su ecuación característica toma la forma:
                                         𝑑𝑒𝑡[𝑍𝐼 − 𝐺 + 𝐾𝑒𝐶] = 0                               (5 - 70)
            En donde la matriz Ke debe ser escogida apropiadamente para que el error
      tienda a cero con una velocidad adecuada. Cabe mencionar también que las
      raíces de dicha ecuación característica deben posicionarse dentro del círculo
      unitario para operación satisfactoria del observador.
              El observador que nos ocupa requiere que el proceso sea completamente
      observable; es decir, que cualquier estado inicial pueda determinarse a partir de
      la observación de los vectores de salida y de control, en un número finito de
      períodos de muestreo. Ya es conocido que el criterio para observabilidad
      completa requiere construir la siguiente matriz de observabilidad:

𝑁 = [𝐶 𝑇 𝐺 𝑇 𝐶 𝑇 (𝐺 𝑇 )2 𝐶 𝑇 (𝐺 𝑇 )3 𝐶 𝑇 (𝐺 𝑇 )4 𝐶 𝑇 (𝐺 𝑇 )5 𝐶 𝑇 (𝐺 𝑇 )6 𝐶 𝑇 (𝐺 𝑇 )7 𝐶 𝑇 ]   (5 - 71)



                                                                                                  93
            La condición necesaria y suficiente para que el sistema sea
   completamente observable es que la matriz N posea rango 8 (rango completo).
   Es decir, el rango de N debe ser igual al orden del proceso.
            Para calcular la matriz Ke podemos proceder en la misma forma en que
   lo hicimos con la matriz de ganancia K del controlador; es decir, podemos
   utilizar las ecuaciones que describen al sistema de control óptimo,
   convenientemente modificadas, para que nos permitan calcular Ke.
   Entonces la correspondiente ecuación de Riccati toma la forma:


                   𝑃𝑒 = 𝑄𝑒 + 𝐺𝑃𝑒𝐶 𝑇 − 𝐺𝑃𝑒𝐶 𝑇 [𝑅𝑒 + 𝐶𝑃𝑒𝐶 𝑇 ]−1 𝐶𝑃𝑒𝐺 𝑇                         (5 - 72)


   y la matriz de ganancia Ke viene dada por:


                                     𝐾𝑒 = [𝑅𝑒 + 𝐶𝑃𝑒𝐶 𝑇 ]−1 𝐶𝑃𝑒𝐺 𝑇                            (5 - 73)


   Para determinar Pe utilizaremos la siguiente ecuación recursiva:


        𝑃𝑒(𝑘 + 1) = 𝑄𝑒 + 𝐺𝑃𝑒(𝑘)𝐶 𝑇 − 𝐺𝑃𝑒(𝑘)𝐶 𝑇 [𝑅𝑒 + 𝐶𝑃𝑒(𝑘)𝐶 𝑇 ]−1 𝐶𝑃𝑒(𝑘)𝐺 𝑇
                                                                                             (5 - 74)


             4.4.4.1.- Diseño del observador de estados en Matlab
            Primero determinaremos si el proceso es completamente observable,
   para ello formamos la matriz de observabilidad:


𝑁 = [𝐶 𝑇 𝐺 𝑇 𝐶 𝑇 (𝐺 𝑇 )2 𝐶 𝑇 (𝐺 𝑇 )3 𝐶 𝑇 (𝐺 𝑇 )4 𝐶 𝑇 (𝐺 𝑇 )5 𝐶 𝑇 (𝐺 𝑇 )6 𝐶 𝑇 (𝐺 𝑇 )7 𝐶 𝑇 ]


   Donde :


        1      0   0    0   0    0    0   0
   𝐶 = [0      1   0    0   0    0    0   0]
        0      0   1    0   0    0    0   0
        0      0   0    1   0    0    0   0



                                                                                                  94
  y




       Utilizamos la instrucción rank de matlab:
       rangoN=Rank(N)


       El resultado es 8 ,por lo tanto el sistema si es completamente observable.
       Para calcular la matriz de ganancia Ke del observador óptimo definimos
las siguientes matrices de ponderación:




       Para calcular la matriz Ke calculamos previamente la matriz Pe a partir
de:


  𝑃𝑒(𝑘 + 1) = 𝑄𝑒 + 𝐺𝑃𝑒(𝑘)𝐶 𝑇 − 𝐺𝑃𝑒(𝑘)𝐶 𝑇 [𝑅𝑒 + 𝐶𝑃𝑒(𝑘)𝐶 𝑇 ]−1 𝐶𝑃𝑒(𝑘)𝐺 𝑇




                                                                              95
Esta parte del programa se puede observar en el siguiente código:




Dándonos los siguientes resultados:




                                                                    96
4.4.5.   Simulación en Simulink.

         Se desarrolló una simulación del sistema de control adaptativo
empleando Simulink de MATLAB, el controlador se diseño de a cuerdo a los
pasos realizados anteriormente, se puede observar los bloques de la Planta, el
bloque del identificador de parámetros y el bloque de la ley del controlador.




         Figura 34: Simulación del controlador adaptativo usando Simulink de MATLAB.


         De la grafica podemos observar los bloques que componen el
controlador adaptativo, este consta de el modelo no lineal de la planta, está el
bloque de identificador de sistemas utilizando el método de los mínimos
cuadrados, además tenemos el bloque de la ley de control, que en este caso se
utilizó un regulador PI óptimo cuadrático. Podemos observar las siguientes
graficas:


1. Bloque del modelo matemático:




                         Figura 35: Modelo No lineal del Péndulo Triple.

                                                                                       97
El código interno de este bloque se muestra a continuación:

       %Momento de inercia de los links
       J1=0;
       J2=0;
       J3=0;

       % longitud al centro de masas
       lc1=0.5*l1;
       lc2=0.5*l2;
       lc3=0.5*l3;

       % Coeficiente de gravitación
       g=9.81;

       % longitud al centro de masas
       lc1=0.5*l1;
       lc2=0.5*l2;
       lc3=0.5*l3;

       % Coeficiente de gravitación
       g=9.81;

       % constantes para simplificación
       a0=m0+m1+m2+m3;
       a1=m2*l1+m3*l1+m1*lc1;
       a2=m2*lc2+m3*l2;
       a3=m3*lc3;

       b1=J1+(m1*lc1*lc1)+(m2*l1*l1)+(m3*l1*l1);
       b2=J2+(m2*lc2*lc2)+(m3*l2*l2);
       b3=J3+m3*lc3*lc3;

       c1=g*a1;
       c2=g*a2;
       c3=g*a3;

       % Fricción Viscosa
        bc=0; k1=0; k2=0; k3=0;

       %   Matriz de Inercia M(q)
       %   Definimos los estados como
       %   q =[x1 x2 x3 x4]
       %   qp=[x5 x6 x7 x8]
       %   donde x1:=posicion del carro, x2:=posicion angular 1
       %   x3:=posicion angular 2 , x4:=posicion angular 3
       %   x5:=velocidad del carro x6:=velocidad angular 1
       %   x7:=velocidad angular 2 x8:=velocidad angular 3
       %   Parametros del Motor

       rp = 0.019; n = 11/75;Jo = 0;
       Jm = 6.37e-6;mp = 0.045;
       Jp = mp*rp^2/2;
       Jeq = Jm + n^2*(Jo + Jp);
       Bm = 4.23e-6; Bo =4.23e-8; Beq = Bm + n^2*Bo;
       Km = 86.02e-3; Kb = 86.47e-3; Ra = 37.38; KA = 4.8;

                                                                  98
J2 = Jeq/(n^2*rp^2);
Kx = Km/(Ra*n*rp);
Bx = Beq/(n^2*rp^2) + Kb*Km/(n^2*rp^2*Ra);
KxA=Kx*KA;

M11=a0/KxA+J2/KxA;
M12=a1/KxA*cos(x2);
M13=a2/KxA*cos(x3);
M14=a3/KxA*cos(x4);

M21=a1*cos(x2);
M22=b1;
M23=a2*l1*cos(x3-x2);
M24=a3*l1*cos(x4-x2);

M31=a2*cos(x3);
M32=a2*l1*cos(x3-x2);
M33=b2;
M34=a3*l2*cos(x4-x3);

M41=a3*cos(x4);
M42=a3*l1*cos(x4-x2);
M43=a3*l2*cos(x4-x3);
M44=b3;

%Vector de Fuerzas de Coriolis y de Fuerzas Centrípetas

C11=bc/KxA+Bx/KxA;
C12=a1/KxA*sin(x2)*x6;
C13=a2/KxA*sin(x3)*x7;
C14=a3/KxA*sin(x4)*x8;

C21=0;
C22=k1+k2;
C23=-k2-a2*l1*sin(x3-x2)*x7;
C24=-a3*l1*sin(x4-x2)*x8;

C31=0;
C32=-k2+a2*l1*sin(x3-x2)*x6;
C33=k2+k3;
C34=-k3-a3*l2*sin(x4-x3)*x8;

C41=0;
C42=a3*l1*sin(x4-x2)*x6;
C43=-k3+a3*l2*sin(x4-x3)*x7;
C44=k3;

%Matriz de Gravedad

G1=0;
G2=-c1*sin(x2);
G3=-c2*sin(x3);
G4=-c3*sin(x4);

% %Matriz de Fricción Viscosa y Seca
% Fr1=b1*x2+k1*tanh(beta*x2);

                                                          99
      % Fr2=b2*x4+k2*tanh(beta*x4);

      % Variables Articulares y Derivadas

      q=[x1;x2;x3;x4];
      qp=[x5;x6;x7;x8];

      % Matrices del robot
      M=[M11,M12,M13,M14;
      M21,M22,M23,M24;
      M31,M32,M33,M34;
      M41,M42,M43,M44];

      C=[C11,-C12,-C13,-C14;
      C21,C22,C23,C24;
      C31,C32,C33,C34;
      C41,C42,C43,C44];

      G=[G1;G2;G3;G4];

      f=u;
      T=[f;0;0;0];

      N=C*qp+G;

      % Ecuaciones de Estado
      qpp=inv(M)*(T-N);
      qpp0=qpp(1);
      qpp1=qpp(2);
      qpp2=qpp(3);
      qpp3=qpp(4);


2. Bloque del identificador de parámetros:




                          Figura 36: Identificador del sistema.


      Este bloque consta principalmente del método de los mínimos
cuadrados.
                                                                  100
El código interno del identificador de parámetros es:


function [m0,m1,m2,m3,l1,l2,l3,Param] = fcn(Regresor,T)

persistent R R_1 R_2 R_3 R_4
persistent t t_1 t_2 t_3 t_4
persistent flag

if isempty(R)
    R=zeros(4,10);
end
if isempty(R_1)
    R_1=zeros(4,10);
end
if isempty(R_2)
    R_2=zeros(4,10);
end
if isempty(R_3)
    R_3=zeros(4,10);
end
if isempty(R_4)
    R_4=zeros(4,10);
end

if isempty(t)
    t=zeros(4,1);
end
if isempty(t_1)
    t_1=zeros(4,1);
end
if isempty(t_2)
    t_2=zeros(4,1);
end
if isempty(t_3)
    t_3=zeros(4,1);
end
if isempty(t_4)
    t_4=zeros(4,1);
end
if isempty(flag)
    flag=0;
end


R_4=R_3;
R_3=R_2;
R_2=R_1;
R_1=R;
R=Regresor;

t_4=t_3;
t_3=t_2;
t_2=t_1;
t_1=t;
t=T;


                                                          101
      R_ext=vertcat(R,R_1,R_2,R_3,R_4);
      t_ext=vertcat(t,t_1,t_2,t_3,t_4);

      theta_est=pinv(R_ext)*t_ext;

      a0=theta_est(1);
      a1=theta_est(2);
      a2=theta_est(3);
      a3=theta_est(4);
      a4=theta_est(5);
      a5=theta_est(6);
      a6=theta_est(7);
      b1=theta_est(8);
      b2=theta_est(9);
      b3=theta_est(10);


      l2=a6/a3;
      l1=a5/a3;

      % Ecuaciones a resolver para calcular m2 y m3
      % eq1: a2=(m2*(l2/2)+m3*l2);
      % eq2: b2=(m2*(l2/2)^2+m3*(l2^2));

      sol=inv([l2/2 l2;(l2/2)^2 l2^2])*[a2;b2];

      m2=sol(1);
      m3=sol(2);

      l3=2*(a3/m3);

      % a1=m2*l1+m3*l1+m1*lc1;

      m1=(a1-(m2*l1)-(m3*l1))/(l1/2);

      m0=a0-m1-m2-m3;

      Param=[m0;m1;m2;m3;l1;l2;l3];




3. Bloque de la ley de control:




                           Figura 37: Diseño del controlador.

                                                                102
       El código interno se muestra a continuación:


function [K,KI]     = fcn(m0,m1,m2,m3,l1,l2,l3)




Cc=[1 0 0 0 0 0 0 0];
A=[A0 zeros(8,1)
    -Cc 0];
B=[B0 ; 0];

AA=A^9+139.98*A^8+7094.2*A^7+1.6306e+005*A^6+1.8723e+006*A^5+1.0
942e+007*A^4+3.1875e+007*A^3+4.3451e+007*A^2+3.1017e+007*A+6.359
5e+006*eye(9);

AB=[B A*B A^2*B A^3*B A^4*B A^5*B A^6*B A^7*B A^8*B];

k=[0 0 0 0 0 0 0 0 1]*inv(AB)*AA;

K=[k(1:8)];
KI=[-k(9)];



       Del código podemos observar lo siguiente:


       Una vez identificado los parámetros del sistema (m0, m1, m2, m3, l1, l2,
l3); estos valores se reemplazan en las ecuaciones de estado (A) y salida (B),
para luego incluirse en las matrices aumentadas (A0 y B0). Para calcular la

                                                                           103
matriz de ganancia de realimentación de estados no utilizamos la instrucción
lqr ya que esta no es permitida en Simulink, por lo tanto optamos utilizar el
método de asignación de polos, que está dada por:


                                               𝐾 = [0 0 0 0 0 0 0 0 1 ][𝐴 𝐴𝐵 … 𝐴8 𝐵]𝜑(𝐴)


       Donde 𝜑(𝐴) representa el polinomio característico.


1. Respuestas del sistema frente a condiciones variables
       Las respuestas del sistema a una señal de entrada variable se muestran a
continuación.


                                    1.5
                                                                                                             Posicion del carro
                                                                                                             Señal de referencia


                                      1




                                    0.5
        Posición del carro [mts.]




                                      0




                                    -0.5




                                     -1




                                    -1.5
                                           0   10       20       30      40                50   60   70      80                    90
                                                                              Tiempo (s)



                                       Figura 38: Respuesta del controlador Adaptativo a una señal de entrada variable.




       De la figura se observa que el controlador adaptativo responde a las
variaciones en la señal de entrada.


       Las siguientes figuras muestran el comportamiento de las señales de
posición angular de las varillas, se puede observar que a pesar de los cambios
en la señal de entrada los péndulos no superan los 0.15 radianes o 8.5 grados,
por lo tanto el sistema responde según lo esperado.




                                                                                                                              104
                                                  0.08



                                                  0.06



                                                  0.04



                                                  0.02
Posición Angular 1 [rad]




                                                        0



                                          -0.02



                                          -0.04



                                          -0.06



                                          -0.08



                                                      -0.1



                                          -0.12
                                                             0            10        20        30        40                   50    60    70     80       90
                                                                                                              Tiempo (s)


                                                                     Figura 39: Sistema lineal variable con Control Adaptativo (Posición angular 1).


                                                       0.08



                                                       0.06



                                                       0.04



                                                       0.02
                   Posición Angular 2 [rad]




                                                             0



                                                      -0.02



                                                      -0.04



                                                      -0.06



                                                      -0.08



                                                       -0.1
                                                                 0         10        20        30        40                   50    60    70     80       90
                                                                                                               Tiempo (s)



                                                                       Figura 40: Sistema lineal variable con Control Adaptativo (Posición angular 2).
                                                       0.06




                                                       0.04




                                                       0.02




                                                             0
                           Posición Angular 3 [rad]




                                                       -0.02




                                                       -0.04




                                                       -0.06




                                                       -0.08




                                                        -0.1
                                                                 0         10        20        30        40                   50    60    70     80       90
                                                                                                                Tiempo (s)

                                                         Figura 41: Sistema lineal variable con Control Adaptativo (Posición angular 3).



                                                                                                                                                         105
                                                 La señal de control se muestra a continuación:
0.15
                                                                                                                                          Señal de control u



 0.1




0.05




   0




-0.05




 -0.1




-0.15




 -0.2
          0                                          500              1000        1500                   2000          2500        3000                    3500

                                                 Figura 42: Sistema lineal variable con Control Adaptativo (Señal de control).

                                                 Se realiza una variación en los parámetros del sistema como son: la
  masa del carro, masa del primer péndulo, masa del segundo péndulo, masa del
  tercer péndulo, longitud del primer péndulo, longitud del segundo péndulo y
  longitud del tercer péndulo, las cantidades y los instantes en que se realiza estos
  cambios se muestran en la siguiente grafica:

                                      0.1



                                     0.08



                                     0.06



                                     0.04
    Modificacion de los parametros




                                     0.02



                                        0



                                     -0.02



                                     -0.04



                                     -0.06



                                     -0.08



                                      -0.1
                                             0        10         20          30          40                  50   60          70           80                  90
                                                                                              Tiempo (seg)


                                                           Figura 43: Cantidad y tiempos en que varían los parámetros


                                                 Se puede observar que desde el instante en que t=0 hasta t=15 segundos
  los parámetros tienen un decremento de 0.1 unidades, desde t=15 a t=27 los
  parámetros se incrementan, del mismo modo se tiene un incremento desde t=27
  a t=45 en 0.1 unidades, de t=45 a t=60 los parámetros sufren un decremento en
  sus valores, de t=60 a t=75 los parámetros se incrementan en 0.04 unidades,
  finalmente desde t=75 hasta t=90 segundos los parámetros vuelven a tomar sus
  valores originales.
                                                                                                                                                           106
       En la siguiente grafica se muestra cómo evolucionan los parámetros
estimados del controlador.
                       40




                                                                                                  masa del carro
                       30
                                                                                                  masa de la pendulo 1
                                                                                                  masa de la pendulo 2
                                                                                                  masa de la pendulo 3
                                                                                                  longitud del pendulo 1
                       20                                                                         longitud del pendulo 2
PARAMETROS ESTIMADOS




                                                                                                  longitud del pendulo 3




                       10




                        0




                       -10




                       -20
                             0        10      20       30       40                 50   60   70                  80         90
                                                                     Tiempo (seg

                                                    Figura 44: Estimador de parámetros.

                                   De la gráfica se observa que los parámetros son capaces de adaptarse a
los cambios en la dinámica del sistema, las variaciones se dan en los tiempos de
15, 27, 45,60 y 75 segundos.


                                   Programa completo del controlador Adaptativo.
                                   El siguiente código muestra el programa completo del controlador
adaptativo diseñado en los pasos antes descritos.


                                 %% PROGRAMA DEL CONTROLADOR ADAPTATIVO AUTOSINTONIZADO
                                 APLICADO
                                 %% AL CONTROL DE UN PENDULO TRIPLE.

                                 clc;close all ;
                                 syms xp u m0 m1 m2 m3 l1 l2 l3;
                                 syms x1 x2 x3 x4 x5 x6 x7 x8;

                                 %Momento de inercia de los links
                                 J1=0;
                                 J2=0;
                                 J3=0;

                                 % longitud al centro de masas
                                 lc1=0.5*l1;
                                 lc2=0.5*l2;
                                 lc3=0.5*l3;

                                 % Coeficiente de gravitación
                                 g=9.81;

                                 % constantes para simplificacion
                                 a0=m0+m1+m2+m3;

                                                                                                                           107
a1=m2*l1+m3*l1+m1*lc1;
a2=m2*lc2+m3*l2;
a3=m3*lc3;

b1=J1+(m1*lc1*lc1)+(m2*l1*l1)+(m3*l1*l1);
b2=J2+(m2*lc2*lc2)+(m3*l2*l2);
b3=J3+m3*lc3*lc3;

c1=g*a1;
c2=g*a2;
c3=g*a3;

% Fricción Viscosa
 bc=0; k1=0; k2=0; k3=0;

%   Matriz de Inercia M(q)
%   Definimos los estados como
%   q =[x1 x2 x3 x4]
%   qp=[x5 x6 x7 x8]
%   donde x1:=posicion del carro, x2:=posicion angular 1
%   x3:=posicion angular 2 , x4:=posicion angular 3
%   x5:=velocidad del carro x6:=velocidad angular 1
%   x7:=velocidad angular 2 x8:=velocidad angular 3

% PARAMETROS DEL MOTOR
rp = 0.019; n = 11/75;Jo = 0;
Jm = 6.37e-6;mp = 0.045;
Jp = mp*rp^2/2;
Jeq = Jm + n^2*(Jo + Jp);
Bm = 4.23e-6; Bo =4.23e-8; Beq = Bm + n^2*Bo;
Km = 86.02e-3; Kb = 86.47e-3; Ra = 37.38; KA = 4.8;

J2 = Jeq/(n^2*rp^2);
Kx = Km/(Ra*n*rp);
Bx = Beq/(n^2*rp^2) + Kb*Km/(n^2*rp^2*Ra);
KxA=Kx*KA;

%Elementos de la matriz de Inercias
M11=a0/KxA+J2/KxA;
M12=a1/KxA*cos(x2);
M13=a2/KxA*cos(x3);
M14=a3/KxA*cos(x4);

M21=a1*cos(x2);
M22=b1;
M23=a2*l1*cos(x3-x2);
M24=a3*l1*cos(x4-x2);

M31=a2*cos(x3);
M32=a2*l1*cos(x3-x2);
M33=b2;
M34=a3*l2*cos(x4-x3);

M41=a3*cos(x4);
M42=a3*l1*cos(x4-x2);
M43=a3*l2*cos(x4-x3);
M44=b3;

                                                           108
 %Vector de Fuerzas de Coriolis y de Fuerzas Centripetas

C11=bc/KxA+Bx/KxA;
C12=a1/KxA*sin(x2)*x6;
C13=a2/KxA*sin(x3)*x7;
C14=a3/KxA*sin(x4)*x8;

C21=0;
C22=k1+k2;
C23=-k2-a2*l1*sin(x3-x2)*x7;
C24=-a3*l1*sin(x4-x2)*x8;

C31=0;
C32=-k2+a2*l1*sin(x3-x2)*x6;
C33=k2+k3;
C34=-k3-a3*l2*sin(x4-x3)*x8;

C41=0;
C42=a3*l1*sin(x4-x2)*x6;
C43=-k3+a3*l2*sin(x4-x3)*x7;
C44=k3;

%Matriz de Gravedad
G1=0;
G2=-c1*sin(x2);
G3=-c2*sin(x3);
G4=-c3*sin(x4);

% %Matriz de Fricción Viscosa y Seca
% Fr1=b1*x2+k1*tanh(beta*x2);
% Fr2=b2*x4+k2*tanh(beta*x4);

% Variables Articulares y Derivadas
q=[x1;x2;x3;x4];
qp=[x5;x6;x7;x8];

% Matrices
M=[M11,M12,M13,M14;
M21,M22,M23,M24;
M31,M32,M33,M34;
M41,M42,M43,M44];

C=[C11,-C12,-C13,-C14;
C21,C22,C23,C24;
C31,C32,C33,C34;
C41,C42,C43,C44];

G=[G1;G2;G3;G4];
% w=1;
% f=5*sin(w*t);
f=u;
T=[f;0;0;0];

N=C*qp+G;




                                                           109
% Ecuaciones de Estado
qpp=inv(M)*(T-N);

% Sustituyendo en el punto de equilibrio.
Equi=subs(qpp,{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0
});

%xp=[x2 ;qpp(1); x4; qpp(2); x6; qpp(3); x8; qpp(4)];
xp=[x5; x6; x7; x8; qpp(1);qpp(2);qpp(3); qpp(4)];


%% LINEALIZACION DEL SISTEMA

A1=diff(xp,x1);
A2=diff(xp,x2);
A3=diff(xp,x3);
A4=diff(xp,x4);
A5=diff(xp,x5);
A6=diff(xp,x6);
A7=diff(xp,x7);
A8=diff(xp,x8);
A=subs([A1 A2 A3 A4 A5 A6 A7
A8],{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0});

B1=diff(xp(1),u);
B2=diff(xp(2),u);
B3=diff(xp(3),u);
B4=diff(xp(4),u);
B5=diff(xp(5),u);
B6=diff(xp(6),u);
B7=diff(xp(7),u);
B8=diff(xp(8),u);
B=subs([B1 B2 B3 B4 B5 B6 B7
B8]',{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0});


%% PARAMETROS DEL PENDULO TRIPLE
% masa del carrito

m0=0.370;

% masas de los pendulos
m1=0.073;
m2=0.087;
m3=0.096;

% longitud de los pendulos
l1=0.25;
l2=0.27;
l3=0.29;

%Momento de inercia de los links
J1=0;
J2=0;
J3=0;


                                                         110
% longitud al centro de masas
lc1=0.5*l1;
lc2=0.5*l2;
lc3=0.5*l3;

% Coeficiente de gravitación
g=9.81;

% constantes para simplificacion
a0=m0+m1+m2+m3;
a1=m2*l1+m3*l1+m1*lc1;
a2=m2*lc2+m3*l2;
a3=m3*lc3;
a4=a2*l1;
a5=a3*l1;
a6=a3*l2;

b1=J1+(m1*lc1*lc1)+(m2*l1*l1)+(m3*l1*l1);
b2=J2+(m2*lc2*lc2)+(m3*l2*l2);
b3=J3+m3*lc3*lc3;


% MODELO LINEAL     DEL PROCESO

Ac=subs(A);
Bc=subs(B);
Cc=[1 0 0 0 0 0 0 0];
Dc=[0];


% MODELO LINEAL DISCRETO DEL PROCESO
T = 0.01; % PERIODO DE MUESTREO

[G,H]=c2d(Ac,Bc,T);%
alfa=1000;N=10; Pi = alfa*eye(10); % MATRIZ P INICIAL
theta_p = [G H ]'; % PARAMETROS DEL PROCESO
thetai = [G H zeros(8,1)]'; % PARAMETROS INICIALES
lambda = 0.99; % FACTOR DE MEMORIA
Y(:,:,1)=[0 0 0 0 0 0 0 0]'; uc(2) = 0;
ref=0.5;
X1(2)=0;X2(2)=0;X3(2)=0;X4(2)=0;X5(2)=0;X6(2)=0;X7(2)=0;X8(2
)=0;

v(1)=0;
Q = [ 100 0 0 0     0   0   0   0 0
        0 150 0 0   0   0   0   0 0
        0 0 150 0   0   0   0   0 0
        0 0 0 150   0   0   0   0 0
        0 0 0 0 1   0   0   0   0
        0 0 0 0 0   1   0   0   0
        0 0 0 0 0   0   1   0   0
        0 0 0 0 0   0   0   1   0
        0 0 0 0 0   0   0   0   1];

R = [100];
K=[0 0 0 0 0 0 0 0];
KI=0;
                                                         111
Ge=G;He=H;
Mm=1000;
uc(1)=0;
X=[0 0 0 0 0 0 0 0]';
for k=2:Mm


%% IDENTIFICADOR DE PARAMETROS
psi_p = [Y(:,:,k-1); uc(k-1)];%9x1
%Y(:,:,k+1) = theta_p'*psi_p; % MODELO LINEAL DEL PROCESO
Y(:,:,k) = X; % MODELO LINEAL DEL PROCESO
psi = [psi_p;1]; % VECTOR DE DATOS
nor = max(1,norm(psi));
psin = psi/nor;
Qch = chol(Pi');
S = inv(diag(Qch*ones(N,1),0));
Ps = S*Pi*S;
psins = inv(S)*psin;
rt = 1 + psins'*Ps*psins;
LF = 1 - (rt-sqrt(rt^2-4*norm(Ps*psins)^2/trace(Ps)))/2;
e = Y(:,:,k)/nor-thetai'*psin; % ERROR DE ESTIMACION
div = psins'*Ps*psins + LF;
theta = thetai'+e*(inv(S)*Ps*psins/div)'; % VECTOR DE
PARAMETROS
Ge = theta(:,1:8); % PARAMETRO G ESTIMADO
He = theta(:,9); % PARAMETRO H ESTIMADO
Ce = theta(:,10);
Hns = Ps*psins/div;
Ps = Ps/LF - Hns*psins'*Ps/LF;
tt = abs(max(eig(Ps))/min(eig(Ps)) );
cmax = 100; cmin = 15;
if tt <= cmin,
thetai = theta'; Pi = Ps;
elseif tt >= cmax,
Qchnew = chol(Ps');
Snew = inv(diag(Qchnew*ones(N,1),0));
Psnew = Snew*Ps*Snew;
Pi = Psnew; thetai = theta';
end

%% DISEÑO DE LA LEY DE CONTROL

Ge1 = [Ge zeros(8,1)
      -Cc*Ge 1];
He1 = [He;-Cc*He];
%M = [He1 Ge1*He1 Ge1^2*He1 Ge1^3*He1 Ge1^4*He1];
%rM = rank(M); % rM=5 => COMPLETAMENTE CONTROLABLE
% CALCULO DE LA GANANCIA DEL CONTROLADOR

P = zeros(9,9);
for i=1:800
P = Q + Ge1'*P*Ge1 -Ge1'*P*He1*inv(R+He1'*P*He1)*He1'*P*Ge1;
end
K1 = inv(R+He1'*P*He1)*He1'*P*Ge1;
%[KK,PP] = dlqr(Ge1,He1,Q,R); % K1=KK, P=PP
KK=K1;
K = [KK(1) KK(2) KK(3) KK(4) KK(5) KK(6) KK(7) KK(8)]; KI =
- KK(9);

                                                            112
     X=[X1(k) X2(k) X3(k) X4(k) X5(k) X6(k) X7(k) X8(k)]';
    y(k)=Cc*X;
    v(k)=v(k-1)+ref-y(k);
    uc(k)=-K*[X1(k) X2(k) X3(k) X4(k) X5(k) X6(k) X7(k)
X8(k)]'+KI*v(k);

    X=Ge*X+He*uc(k);
    X1(k+1)=[1 0 0 0   0   0   0   0   ]*X;
    X2(k+1)=[0 1 0 0   0   0   0   0   ]*X;
    X3(k+1)=[0 0 1 0   0   0   0   0   ]*X;
    X4(k+1)=[0 0 0 1   0   0   0   0   ]*X;
    X5(k+1)=[0 0 0 0   1   0   0   0   ]*X;
    X6(k+1)=[0 0 0 0   0   1   0   0   ]*X;
    X7(k+1)=[0 0 0 0   0   0   1   0   ]*X;
    X8(k+1)=[0 0 0 0   0   0   0   1   ]*X;

  end

%% GRAFICAS DEL SISTEMA
figure(1)
t=linspace(0,T*Mm,Mm);
subplot(3,3,1)
plot(t,X1(1:Mm),t,ref),grid;
ylabel('Posición del carro [mts.]')
xlabel('Tiempo (s)')
subplot(3,3,2)
plot(t,X2(1:Mm),t,0),grid;
ylabel('Posición Angular 1 [rad]')
xlabel('Tiempo (s)')
subplot(3,3,3)
plot(t,X3(1:Mm),t,0),grid;
ylabel('Posición Angular 2 [rad]')
xlabel('Tiempo (s)')
subplot(3,3,4)
plot(t,X4(1:Mm),t,0),grid;
ylabel('Posición Angular 3 [rad]')
xlabel('Tiempo (s)')
subplot(3,3,5)
plot(t,X5(1:Mm)),grid;
ylabel('Velocidad del carro [mts/s]')
xlabel('Tiempo (s)')
subplot(3,3,6)
plot(t,X6(1:Mm)),grid;
ylabel('Velocidad Angular 1 [rad/s]')
xlabel('Tiempo (s)')
subplot(3,3,7)
plot(t,X7(1:Mm)),grid;
ylabel('Velocidad Angular 2 [rad/s]')
xlabel('Tiempo (s)')
subplot(3,3,8)
plot(t,X8(1:Mm)),grid;
ylabel('Velocidad Angular 3 [rad/s]')
xlabel('Tiempo (s)')
subplot(3,3,9)
plot(t,uc(1:Mm)),grid;
ylabel('Señal de Control U(t)[Volts]')
xlabel('Tiempo (s)')


                                                         113
4.5.   DISEÑO DEL SISTEMA MECÁNICO DEL PÉNDULO TRIPLE


              El material a utilizar para construir nuestro péndulo triple es el aluminio
       ya que es un material rígido, económico y de fácil manipulación.
              La base que sirve de soporte para el modulo es de madera con un peso
       de 2.5Kg, evita que el sistema carro – péndulo tenga movimientos indeseados.
              El carro es de aluminio de un peso de 370 gramos y se desliza por dos
       ejes por medio de una correa dentada, los ejes son construidos de tubos de
       aluminio de superficie lisa con el fin de disminuir la fuerza de fricción debida al
       rozamiento entre las superficies.
              Las varilla de los péndulos son construidos también de aluminio, cuyas
       dimensiones son de: 25cm , 27 cm y 29 cm para la primera ,segunda y tercera
       varilla respectivamente.
              La transmisión del movimiento del carro se realiza por medio de una
       correa dentada y engranajes que son a la vez movidas por un motor DC de imán
       permanente fijado en el soporte base de madera.
              Las medidas y el diseño de la vista frontal se muestran a continuación:




                     Figura 45: Diseño mecánico del Péndulo Triple (vista frontal) .


                                                                                       114
       El motor DC usado tiene incorporado un encoder que nos sirve para
medir la posición y velocidad a la que se mueve el carro, además cuenta con
una caja de engranajes con un factor de reducción de 22/60.
   Las medidas y el diseño de la vista superior se muestra a continuación:




                   Figura 46: Diseño mecánico del Péndulo Triple (vista superior).
       El engranaje del eje principal del motor consta de 22 dientes, que
transfiere su movimiento por medio de una pequeña correa a un engranaje de 60
dientes que a su vez es concéntrico con otro engranaje de 20 dientes, este
transfiere su movimiento por medio de una correa dentada a un engranaje de 50
dientes, este está unido por el mismo eje a un engranaje de 38 dientes y es este
último el que transfiere movimiento al carro del péndulo triple. Por lo tanto
podemos deducir que la ganancia final será de:
                              22 20 11   1
                        𝑛=      𝑥  =   =    = 0.1467
                              60 50 75 6.82
       Es decir por una vuelta que da el eje primario del motor, el eje final dará
aproximadamente 0.1457 vueltas, o equivalentemente si el eje final gira 6.82
vueltas el eje primario del motor girara tan solo 1 vuelta.
       Ahora para el movimiento del carro tenemos que 5 vueltas del eje final
hacen que el carro se mueva 57 centímetros.
       Por tanto podemos decir que por 10 vueltas del eje primario del motor el
carro se moverá:
                                        22 20 57
                       𝐷𝑋𝑐𝑚 = 10𝑥         𝑥 𝑥    = 16.7𝑐𝑚
                                        60 50 5
       Esto se puede corroborar prácticamente con una muy alta precisión.



                                                                                     115
       Para medir la posición primero se utilizo el encoder incorporado en el
motor, se obtuvo con éxito la medición de la posición haciendo uso de un
microcontrolador PIC, sin embargo se observó que a medida que la velocidad a
la que giraba el motor aumentaba conforme aumentaba el voltaje de armadura
empezaban a mostrar errores en la medida esto debido a que el encoder ya no
contaba todos los pulsos haciendo que perdiera datos que ocasionaban una
lectura inferior a la medida real.
       Entonces se decidió usar como sensor de posición un potenciómetro
lineal de precisión multivueltas que fue acoplado solidario al eje del engranaje
secundario del motor, de este modo se consiguió medir el desplazamiento del
carro el resultado es muy bueno.
       Para poder medir los ángulos que giran las varillas de los péndulos se
hizo uso de potenciómetros comerciales, estos tienen una limitación en cuanto
a su movimiento ya que no son potenciómetros multivueltas, además presentan
un momento de inercia considerable que no permiten un comportamiento ideal
del sistema, sin embargo el resultado es aceptable.




                       Figura 47: Sistema mecánico del Péndulo Triple.




                                                                            116
4.6.   DISEÑO ELECTRÓNICO DEL CONTROLADOR.


       4.6.1.   Sistema de control

       El sistema de control electrónico del péndulo triple está formado por las
       siguientes partes:
       1- Fuente de Alimentación.- Para alimentar nuestro sistema de control
           utilizaremos una fuente simétrica de 15V, además de ello necesitaremos una
           fuente de 5V para la alimentación de los PICs, para esto hacemos uso de
           reguladores de voltaje 7815 ,7915 y 7805.




                              Figura 48: Fuente de alimentación para el controlador.


           Para la etapa de alimentación al driver de control del motor, emplearemos
           otra fuente de alimentación de 24V, para ello usamos un regulador de
           voltaje 7824 con su respectivo disipador de calor.




                            Figura 49: Fuente de alimentación para el driver de potencia.
                                                                                            117
2- Controlador .-Los dispositivos que procesarán los algoritmos de control
   están compuestos por los Microcontroladores PIC 18F4550 y 16F877 en
   conjunto con el software creado en el LabVIEW 2012, el circuito se muestra
   a continuación:




             Figura 50: Controlador del sistema, compuesto por los PIC16F877,
              PIC 18F4550 y enlazado vía el puerto USB con el LabVIEW 2012.


3- Etapa de potencia.- Se utilizó el driver STK 6875 de SANYO que es un
   driver de potencia para el control bidireccional de un motor DC ,este driver
   está compuesto principalmente por 4 MOSFETs de potencia y es capaz de
   suministrar 5A a su salida, el circuito equivalente se muestra a
   continuación:




                                                                                118
         Figura 51: Circuito equivalente del driver STK 6875 de SANYO.


Además para aislar la etapa de potencia de la etapa de control se uso
optoaclopadores 4N25.




                         Figura 52: Etapa de potencia




                                                                         119
Figura 53: Circuito electrónico de control del péndulo triple .


                                                                  120
4.7.   DISEÑO DEL SOFTWARE DE CONTROL.


                En esta sección desarrollaremos los programas utilizados para la interfaz
       de usuario implementado en LabVIEW 2012 y los programas hechos en PICC
       para la comunicación entre el sistema físico y el computador.


       4.7.1.   Interfaz de Usuario.
                La interfaz para el usuario es diseñado en el programa grafico LabVIEW
       2012 Professional Development System. Los criterios para diseñar el programa
       están de acuerdo a los pasos hechos en la simulación realizada con el Matlab.
                Esta interfaz de usuario permite monitorear las señales de salida a si
       como genera la señal de control, está conformado por las siguientes partes:


       1. Ventada Principal.- Muestra una descripción general de todo la interfaz de
          usuario.




                         Figura 54: Ventana principal de la interfaz de usuario.


       2. Ventana de variables y modelado.- Esta ventana muestra una serie de
          controladores numéricos que sirven para variar los parámetros del sistema
          como son las masas y longitudes del carro y las varillas, además muestra las
          ecuaciones de estado y salida del péndulo triple en tiempo continuo y
          tiempo discreto y estas pueden variar a medida que se modifican los valores
          de los controladores numéricos.

                                                                                     121
                       Figura 55: Variables y Dinámica del sistema.



3. Estimador de parámetros.-Esta ventana muestra el proceso de estimacion
   de parámetros a partir de las señales de entrada y salida del sistema.
4. Ventana del controlador .- Esta ventana muestra el controlador diseñado
   durante este proceso de investigación, consta de las siguientes partes:
                 Modelo lineal disctretizado.
                 Estimador de estados.
                 Estrategia de control adaptable.
                 Señal de referencia o Set Point variable online.




                     Figura 56: Estructura del Controlador Adaptativo.




                                                                             122
5. Respuestas del sistema.-Muestra las respuestas del sistema debidas a la
   acción del controlador adaptativo autosintonizado, se observa las señales de
   referencia, posición del carro, posición angular de las varillas y velocidades
   lineales y angulares del sistema.
6. Ventana de adquisición de datos.- Esta ventana muestra la interfaz grafica
   de usuario que permite monitorear las señales de salida y control del
   sistema, esta comunicación entre el LabVIEW y el sistema físico se realiza a
   través del PIC 18F4550 y librerías necesarias para comunicar el
   microcontrolador vía el puerto USB en modo Bulk Transfer, las señales
   tienen una resolución de 10 Bits es decir pueden variar de 0 hasta 1023.
    Para monitorear la señal de control aplicada al motor se visualiza en el
    cluster los boolean que indican el sentido de giro y marcha del motor.
       El Diagrama de bloques es la zona en la cual se realiza la
programación gráfica característica del LabVIEW , se muestra a continuación
el diagrama de bloques diseñado para nuestro sistema :




Figura 57: Diagrama de bloque del Controlador Adaptativo autosintonizado para controlar el
                                      péndulo triple.


       Para entender con mayor detalle el diagrama de bloques diseñado lo
dividiremos en las siguientes partes:




                                                                                      123
1. Modelo matemático.- En esta parte se realiza el modelamiento lineal del
   sistema alrededor del punto de equilibrio, también realiza la discretización
   del sistema del péndulo triple.




    Figura 58: Diagrama de bloques para el modelo lineal en tiempo continuo y discreto.


2. Estimador de parámetros.-Realiza la estimación de parámetros utilizando
   el método de los mínimos cuadrados recursivos mejorados.
3. Ley de control.- El controlador adaptativo utiliza una ley de control
   proporcional integral óptimo cuadrático con realimentación de estados.




                       Figura 59: Diagrama de bloque para la ley de control.
                                                                                          124
4.7.2.        Comunicación entre LabVIEW y el PIC
          Para realizar la comunicación entre el LabVIEW y el sistema físico se
hizo uso del microcontrolador PIC 18F4550 de Microchip y las librerías
necesarias para la comunicación vía el puerto USB, los pasos para realizar esta
tarea se muestran a continuación:




         Figura 60: Diagrama de bloque para la comunicación entre LabVIEW y el PIC.




1. Comunicación entre la PC y el PIC.
   Para realizar la comunicación entre la PC y un PIC vía el puerto USB
   utilizando el protocolo Bulk Transfer Microchip puso a disposición una
   DLL que permite comunicar Windows con sus Microcontroladores
   18Fxxxx, esta DLL es la mpusbapi.dll cuyas funciones principales son las
   siguientes:


               MPUSGETDLLVERSION ( ).-Lee la versión del mpusbapi.dll.
               MPUSBGETDEVICECOUNT( ).-Devuelve el VID y PID asignado
                al dispositivo .
               MPUSBOPEN( ).-Devuelve el acceso al pipe del EndPoint con el
                VID_PID asignado .
               MPUSBREAD( ).-Lee el dato guardado en el EndPoint .
               MPUSBWRITE( ).-Escribe el dato en el EndPoint respectivo .

                                                                                      125
          MPUSBREADINT( ).- Lee el dato guardado en el EndPoint en caso
           se haya realizado una interrupción .
          MPUSBCLOSE( ).- Termina la comunicación con el respectivo
           EndPoint .


     Para el correcto funcionamiento es necesario contar con el driver
mchpusb.sys     y mchpusb64.sys en caso se esté trabajando con un sistema
operativo de 64 bits.
     Para nuestra interfaz de usuario desarrollado en LabVIEW las funciones de
la DLL se muestran a continuación:
          MPUSBGETDEVICECOUNT( ).-Devuelve el VID y PID asignado
           al dispositivo ,en nuestro caso el VID es 04D8 y el PID es 000B .




   Figura 61: Diagrama de bloque para el MPUSBGETDEVICECOUNT del mpusbapi.dll




       Figura 62: Configuración de parámetros para el MPUSBGETDEVICECOUNT
                                  del mpusbapi.dll
                                                                            126
   MPUSBREAD( ).-En esta parte leemos los datos provenientes del
    PIC 18F4550 como son las señales de posición del carro y los
    ángulos de los péndulo.




      Figura 63: Diagrama de bloque para el MPUSBREAD del mpusbapi.dll




        Figura 64: Configuración de parámetros para el MPUSBREAD del
                                 mpusbapi.dll .




                                                                       127
   MPUSBWRITE( ).-Escribe el dato en el EndPoint respectivo .




    Figura 65: Diagrama de bloque para el MPUSBWRITE del mpusbapi.dll




    Figura 66: Configuración de parámetros para el MPUSBWRITE
                      del mpusbapi.dll




                                                                        128
4.7.3.     Programación del PIC 18F4550.
          Para realizar la comunicación entre PC y PIC utilizando el bus USB,
CCS suministra una serie de librerías que nos permitirán realizar esta tarea, las
librerías suministradas son:
        pic_18usb.h es un driver de capa hardware de la familia PIC18F4550.
        usb.h Realiza definiciones y prototipos utilizados en el driver USB.
        usb.c El USB stack que maneja las interrupciones USB y el USB setup
         requests en Enpoint 0.
        usb_desc_scope.- Es un descriptor que permite realizar una clase de
         dispositivo, en este caso el BULK TRANSFER, aquí es donde definimos
         el VID_PID que llevara nuestro PIC.


         Las funciones más importantes son:
        usb_init():Inicializa el hardware USB .Espera en un bucle infinito hasta
         que el periférico USB es conectado al bus .Habilita y usa la interrupción
         USB.
        usb_task():Se utiliza para detectar la conexión para la inicialización
         ,cuando el PIC es conectado desconectado del bus,esta función incializa
         el periférico USB o resetea el USB stack y el periférico .
        usb_enumerated() : Devuelve un TRUE si el dispositivo ha sido
         enumerado para la PC, y en este caso ,el dispositivo entra en modo de
         operación normal y puede enviar y recibir paquetes de datos .
        usb_kbhit() : Retorna un TRUE si el Endpoint tiene un dato recibido en
         su buffer.
        usb_get_packet() : Recibe un carácter del buffer de transmisión ,en caso
         de estar vacio esperara hasta que se reciba .
        usb_put_packet() : Coloca un carácter en el buffer de transmisión ,en el
         caso de que este lleno esperara hasta que pueda enviarlo .


         Las partes principales que componen el programa del PIC son:
        Asignación del VID_PID para el dispositivo, en el descriptor
         usb_desc_scope.h realizamos el siguiente cambio:

                                                                                129
       Para nuestro caso se asigno al VID el código 04D8, y para el PID el
código 000B .En este mismo descriptor también podemos asignar un nombre a
nuestra tarjeta de adquisición de datos, esto se hace en esta parte del código:




                                                                                  130
       El numero 24 y el nombre ‘DAQ_MENDOZA’             tienen la siguiente
relación, el STRING tiene 11 caracteres, para que esto sea entendido por el
PICC debe de duplicarse el numero de caracteres aumentado en uno, es decir
2x(11+1)=24.


       Una vez realizado esto debemos de llamar esta función desde nuestro
programa en el PIC, de esta manera:




       Parte del programa en el PIC18F4550 se muestra a continuación:




                                                                         131
       Luego compilamos el programa para que genere el código hexadecimal
que se grabara finalmente en el microcontrolador, para esto presionamos la
tecla F9, el resultado se muestra a continuación:




                    Figura 67: Compilación del programa en PICC.


       Una vez obtenido el archivo hexadecimal necesitamos grabarlo al PIC,
para esto haremos uso del grabador PICKIT2 proporcionado por Microchip, al
conectar el grabador y abrir el PICKIT2 aparece la siguiente imagen:




                       Figura 68: Grabador PICKIT 2 de Microchip.



                                                                             132
       Para programar simplemente abrimos el archivo hexadecimal                  y
hacemos click en Write ,la imagen siguiente muestra el resultado de la
grabacion :




                Figura 69: Programación del PIC usando PICKIT 2 de Microchip.


       Una vez programado el PIC procedemos a conectarlo a la PC, la imagen
inicial se muestra a continuación:




                  Figura 70: Conexión del PIC 18F4550 a la PC .


                                                                                133
     En esta imagen podemos apreciar que se reconoce un nuevo dispositivo, y
el nombre que se le asigna es “DAQ_MENDOZA”, que es el nombre que se
dispuso en el descriptor usb_desc_scope.h, ahora nos pedirá instalar el
software de controlador de dispositivo :




                     Figura 71: Instalación del Driver mchpusb.




       Para instalar correctamente el software elegimos la carpeta en la que se
encuentre los siguientes archivos:
       mchpusb.inf
       mchpusb.sys
       mchpusb64.sys


       En el archivo mchpusb.inf debemos de modificar la parte del código en
que asignemos el VID_PID,para nuestro caso debe ser: VID_04D8&PID_000B,
quedándonos esta parte del archivo inf así:




                                                                             134
       También podemos modificar los nombres a nuestro gusto:




       Una vez hecho estas modificaciones instalamos el software del
controlador:




                          Figura 72: Instalación del software de control.


       Si todo se realizó correctamente nos aparecerá la siguiente imagen:




           Figura 73: Instalación exitosa del driver para la comunicación entre PIC y PC.
                                                                                        135
                 En el administrador de dispositivos nuestra tarjeta de adquisición de
       datos se mostrará de la siguiente forma:




                                 Figura 74: Reconocimiento de la DAQ.




4.8.   RESULTADOS DE LA INVESTIGACIÓN.


                 Una vez realizado todo procedemos a experimentar con nuestro sistema
       diseñado, utilizamos la técnica de prueba y error con el fin de corregir los
       errores que impidan el correcto funcionamiento del controlador del péndulo
       triple.
                 El Set Point sirve para controlar la posición deseada del carro,
       manteniendo siempre los ángulos de las varillas en su posición de equilibrio, las
       graficas siguientes muestran las respuestas del controlador adaptativo diseñado:




                                                                                    136
       Figura 75: Respuesta del controlador Adaptativo frente a una señal de entrada
                                         variable.




     Figura 76: Evolución temporal de los ángulos frente a una señal de entrada variable.


       Se puede observar que cuando el Set Point se ajusta para 1 metro o 100
centímetros, este logra estabilizarse alrededor de los 6 segundos, además el
sobreimpulso no supera el 4%, por lo tanto nuestro diseño es correcto, la señal
de control u esta limitada a tener valores dentro del rango para el cual fue
diseñado, esto con el fin de evitar saturar a el driver de potencia y crear no
linealidades que ocasionarian respuestas no deseadas en el controlador.
       Se realizó varias pruebas con el fin de obtener los resultados deseados,
incluso se empezó por probar un control para un péndulo simple, en este
experimento se obtuvo buenos resultados utilizando una ley de control óptimo

                                                                                            137
cuadrático, demostrándonos que el modelado y diseño del controlador fueron
realizados correctamente, inclusive era capaz de estabilizarse cuando se le
aplicaba una perturbación considerable a la varilla del péndulo.
        Sin embargo para controlar un péndulo triple el trabajo es mucho más
difícil, por lo que se realizó varias pruebas con el fin de lograr una respuesta
aceptable del controlador, para mayor claridad resumiremos estas experiencias
en tres partes:


Prueba 1: Correcciones en el hardware y software.
        El controlador diseñado es probado en el sistema mecánico, el
controlador parece que responde y trata de corregir los errores, sin embargo no
es capaz de estabilizarse por sí solo, es decir para lograr la estabilización es
necesario que un agente externo limite el movimiento angular de las varillas
con el fin de impedir que los péndulos salgan fuera del punto de equilibrio en la
cual fueron diseñados. Es necesario aplicar un agente externo para que el
péndulo logre una estabilización, ya que de otro modo el péndulo se
desequilibra.
        Al realizar este experimento se entendió el porqué la ganancia
correspondiente al ángulo de la segunda varilla era mayor al de la primera y la
ganancia de la tercera varilla era de signo contrario y superior al de la segunda;
la razón se debe a que la tercera varilla tiene un comportamiento más inestable
que las otras y por lo tanto al ponerle un peso mayor              hacemos que el
controlador lo tome más en cuenta y así lograr estabilizar todo el sistema.
        Estos comportamientos que impiden un desempeño aceptable del
controlador motivan a realizar algunos ajustes y mejoras en la parte mecánica,
ya que el carro del péndulo tenía un deslizamiento muy vibratorio por tanto se
hizo lo posible para que todo el sistema quede más fijo y así el carro evite dar
movimientos temblorosos que impedían la estabilización del péndulo triple.
        Además de ello se comprobó que la velocidad de envió y recepción de
datos era muy lenta, es decir existía un retardo considerable en el envió de las
señales de salida del sistema, que además al realizar el algoritmo del
controlador adaptativo en el LabVIEW y generar la señal de control el péndulo

                                                                              138
no lograra estabilizarse adecuadamente, por lo que se decidió emplear un PIC
16F877 con el fin de dividir el trabajo para calcular la ley de control, con esta
modificación se logra obtener una respuesta más rápida y conseguir un mejor
desempeño del controlador.
       Con estas modificaciones realizamos nuevas pruebas que brinden un
comportamiento aceptable del sistema.


Prueba 2: Mejora del diseño del controlador – observador.
        Para mejorar el desempeño del controlador se realizo nuevas
simulaciones con la finalidad de obtener ganancias más acordes a la realidad
ya que al tener ganancias muy elevadas estas también amplifican los errores o
perturbaciones intrínsecas de los sensores causando que el comportamiento sea
inestable y por lo tanto indeseado.
       En la parte del observador de estados también debemos de realizar los
ajustes necesarios para obtener un buen comportamiento en el sistema real.


Prueba 3: Probando la adaptatibilidad del controlador diseñado.
       Una vez obtenido un comportamiento aceptable del sistema necesitamos
comprobar realmente si nuestro controlador tiene la capacidad de adaptarse
cuando variamos los parámetros del sistema, para probar esto modificaremos
los pesos de las varillas de los péndulos, principalmente adicionaremos cargas
en la tercera varilla de modo que este se comporte como una carga no lineal.
       Primero adicionamos una carga de 500 gramos aproximadamente, el
estimador de parámetros empieza estimar los parámetros. Ahora le imprimimos
una perturbación externa, es decir damos un pequeño golpe a la varilla del
péndulo. Ahora quitamos la carga y observamos el comportamiento del péndulo
triple. Ahora probamos con una carga mayor en este caso usamos un peso de
1Kg.
       Nuestro sistema es capaz de adaptarse conforme se varía los parámetros
del sistema, sin embargo existen ocasiones en que el controlador no responde
adecuadamente debido al error en la medida de los sensores y el retardo en
procesar el algoritmo para la estimación de parámetros.


                                                                               139
4.8.1.       Resultados finales del controlador
A continuación mostramos las ganancias finales que se obtuvieron a medida
que se variaban los parámetros del sistema, primero se considera las ganancias
obtenidas sin ninguna variación en el peso de la tercera varilla que es de 96
gramos, luego obtenemos las nuevas ganancias al aumentar el peso de la tercera
varilla en 500 gramos, finalmente probamos incrementando en 1 Kilogramo el
peso de la varilla tres.


   Cuadro 4. Cuadro de resultados obtenidos utilizando el Controlador Adaptativo.
Masa de la       Ganancia del controlador            Ganancia         Tiempo de      Máximo
 tercera                                           Integral [ KI ]   asentamiento
                            [K]                                                     sobre pico .
  varilla
               [-9.4951 -47.99 156.35    -154.19
  96 gr        -15.484 -1.1866 -3.2849 -8.861]     [ -0.051026 ]         6s           4.24 %
                 [-4.5912 -152.72 487.54 -
 596 gr          358.61    -10.776 -0.79965        [ -0.025391 ]          6s           4.23%
                       1.5032 -6.3812]
                 [-2.9296 -247.39 736.39 -
1.096 Kg          506.96   -9.2441 -0.9527         [ -0.016332 ]          6s           4.24%
                       3.1508 -5.6831]




            Como puede observarse a medida que la masa de la tercera varilla
aumenta las ganancias relacionadas con la posición del carro (estado x1)
disminuyen en valor absoluto, como se puede ver en el cuadro estos bajan de
9.49 a 4.59 y luego a 2.93. Sin embargo sucede lo contrario con los estados x2,
x3 y x4 que miden las posiciones angulares de las varillas ya que los valores
absolutos de estos tienden a aumentar a medida que el peso aumenta, por
ejemplo, para la primera varilla las ganancias aumentan de 47.9 a 152.7 y 247.4
,caso similar sucede para las varillas 2 y 3, es interesante observar que los
signos de las ganancias para x1, x2 y x4 son iguales sin embargo para la
segunda varilla este es de signo contrario.
            Las ganancias para los estados x5, x6, x7 y x8 también sufren cambios
como se puede apreciar en el cuadro anterior, por ejemplo para el estado x5 que
es la velocidad lineal del carro este tiende a disminuir en valor absoluto de

                                                                                            140
  15.48 a 10.77 y 9.24. La ganancia integral también tiende a disminuir en valor
  absoluto a medida que se incrementa en el peso de la varilla, los valores
  disminuyen de 0.051 a 0.025 y luego a 0.016.
           Un resultado importante es la poca variación en el tiempo de
  asentamiento del sistema, ya que a pesar de los cambios en los parámetros del
  proceso estos logran estabilizarse alrededor de los 6 segundos. Otro dato
  importante es que el máximo sobre pico oscila alrededor del 4.24 %.


  4.8.2.   Comparación del controlador adaptativo frente a un controlador
fijo.
           Realizamos una comparación entre el controlador adaptativo diseñado y
  utilizando un controlador fijo, en este caso usaremos un controlador óptimo
  cuadrático fijo, el esquema utilizado se muestra a continuación:




                   Figura 77: Diagrama del Controlador fijo: PI óptimo cuadrático.



        Cuando los parámetros no se varían alrededor del punto al cual fueron
  diseñados, los resultados son muy buenos, como se aprecia a continuación:




                                                                                     141
                                            0.6                                                                     0.04                                                                                                       0.04




                                                                                Posición Angular 1




                                                                                                                                                                                              Posición Angular 2
           Posición del carro
                                            0.4
                                                                                                                    0.02                                                                                                       0.02
                                            0.2
                                                                                                                                            0                                                                                                                 0
                                              0

                                        -0.2                                                                     -0.02                                                                                                  -0.02
                                                  0    2       4        6   8                                                                   0       2           4         6       8                                                                                 0           2           4           6        8
                                                           Tiempo (s)                                                                                           Tiempo (s)                                                                                                                  Tiempo (s)

                                    0.04                                                                                       0.3                                                                                             0.15




                                                                                                                                                                                              Velocidad Angular 1
                                                                                           Velocidad del Carro
Posición Angular 3




                                                                                                                               0.2                                                                                                          0.1
                                    0.02
                                                                                                                               0.1                                                                                             0.05
                                              0
                                                                                                                                            0                                                                                                                 0

                                -0.02                                                                                      -0.1                                                                                         -0.05
                                                  0    2       4        6   8                                                                   0       2           4         6       8                                                                                 0           2           4           6        8
                                                           Tiempo (s)                                                                                           Tiempo (s)                                                                                                                  Tiempo (s)

                                    0.15                                                                            0.15                                                                                                                                      2




                                                                                                                                                                                                                    Señal de Control U(t)
Velocidad Angular 2




                                                                                Velocidad Angular 3
                                            0.1                                                                                0.1
                                                                                                                                                                                                                                                              1
                                    0.05                                                                            0.05
                                                                                                                                                                                                                                                              0
                                              0                                                                                             0

                                -0.05                                                                            -0.05                                                                                                                                -1
                                                  0    2       4        6   8                                                                   0       2           4         6       8                                                                                 0           2           4           6        8
                                                           Tiempo (s)                                                                                           Tiempo (s)                                                                                                                  Tiempo (s)



                                                             Figura 78: Respuestas cuando los parámetros varían en un 5%.


                                                      Sin embargo cuando existe una variación en los parámetros, este
controlador fijo deja de responder correctamente, mostrándonos el siguiente
comportamiento:

                                             1                                                                                                  1                                                                                                                       0.5
                                                                                                      Posición Angular 1




                                                                                                                                                                                                                               Posición Angular 2
     Posición del carro




                                            0.5                                                                                             0.5
                                                                                                                                                                                                                                                                            0
                                             0                                                                                                  0


                                    -0.5                                                                                            -0.5                                                                                                                        -0.5
                                                  0    2       4        6   8                                                                       0       2        4            6       8                                                                                     0       2          4            6         8
                                                           Tiempo (s)                                                                                            Tiempo (s)                                                                                                                    Tiempo (s)

                                            0.4                                                                                                 2                                                                                                                           4
                                                                                                                                                                                                                                                  Velocidad Angular 1
                                                                                                                      Velocidad del Carro
     Posición Angular 3




                                            0.2
                                                                                                                                                0                                                                                                                           2
                                             0
                                                                                                                                             -2                                                                                                                             0
                                    -0.2

                                    -0.4                                                                                                     -4                                                                                                                          -2
                                                  0    2       4        6   8                                                                       0       2        4            6       8                                                                                     0       2          4            6         8
                                                           Tiempo (s)                                                                                            Tiempo (s)                                                                                                                    Tiempo (s)

                                             2                                                                                                  2                                                                                                                       20
                                                                                                                                                                                                                                      Señal de Control U(t)
                      Velocidad Angular 2




                                                                                                                      Velocidad Angular 3




                                             1                                                                                                  1                                                                                                                       10

                                             0                                                                                                  0                                                                                                                           0

                                             -1                                                                                              -1                                                                                                                         -10

                                             -2                                                                                              -2                                                                                                                         -20
                                                  0    2       4        6   8                                                                       0       2        4            6       8                                                                                     0       2          4            6         8
                                                           Tiempo (s)                                                                                            Tiempo (s)                                                                                                                    Tiempo (s)



                                                                Figura 79: Respuestas cuando los parámetros varían en 50%.


                                                      Se aprecia claramente la inestabilidad del sistema, de esta forma
podemos comprobar la ventaja de usar un controlador adaptativo frente a un
controlador fijo.
                                                      Cuando incrementamos el peso de la tercera varilla en 500 gramos el
resultado es el siguiente:
                                                                                                                                                                                                                                                                                                                    142
                                          32                                                                                              32                                                                                                                    32
                                      x 10                                                                                        x 10                                                                                                              x 10
                                 2                                                                                           4                                                                                                           2




                                                                                           Posición Angular 1




                                                                                                                                                                                                  Posición Angular 2
           Posición del carro
                                                                                                                             2
                                 0                                                                                                                                                                                                       1
                                                                                                                             0
                                 -2                                                                                                                                                                                                      0
                                                                                                                             -2

                                 -4                                                                                          -4                                                                                                   -1
                                      0           2       4          6     8                                                      0             2           4         6       8                                                                     0                     2           4           6       8
                                                      Tiempo (s)                                                                                        Tiempo (s)                                                                                                                Tiempo (s)
                                          32                                                                                              33                                                                                                                    34
                                      x 10                                                                                        x 10                                                                                                              x 10
                                 1                                                                                           5                                                                                                           2




                                                                                                                                                                                                  Velocidad Angular 1
                                                                                Velocidad del Carro
           Posición Angular 3




                                 0                                                                                           0                                                                                                           1


                                 -1                                                                                          -5                                                                                                          0


                                 -2                                                                              -10                                                                                                              -1
                                      0           2       4          6     8                                                      0             2           4         6       8                                                                     0                     2           4           6       8
                                                      Tiempo (s)                                                                                        Tiempo (s)                                                                                                                Tiempo (s)
                                          33                                                                                              33                                                                                                                    34
                                      x 10                                                                                        x 10                                                                                                              x 10
                                 5                                                                                   10                                                                                                                  5




                                                                                                                                                                                      Señal de Control U(t)
Velocidad Angular 2




                                                                                      Velocidad Angular 3
                                 0                                                                                                                                                                                                       0
                                                                                                                             5
                                 -5                                                                                                                                                                                               -5
                                                                                                                             0
                                -10                                                                                                                                                                                     -10

                                -15                                                                                          -5                                                                                         -15
                                      0           2       4          6     8                                                      0             2           4         6       8                                                                     0                     2           4           6       8
                                                      Tiempo (s)                                                                                        Tiempo (s)                                                                                                                Tiempo (s)



                                                       Figura 80: Respuesta cuando se incremento 500 gr a la varilla 3.


                                                  Cuando incrementamos el peso de la tercera varilla en 500 gramos el
resultado es el siguiente:


                                             35                                                                                            35                                                                                                                        35
                                      x 10                                                                                            x 10                                                                                                                  x 10
                                15                                                                                                5                                                                                                                 10
                                                                                            Posición Angular 1




                                                                                                                                                                                                                        Posición Angular 2
    Posición del carro




                                10                                                                                                0
                                                                                                                                                                                                                                                        5
                                 5                                                                                            -5
                                                                                                                                                                                                                                                        0
                                 0                                                                                           -10

                                 -5                                                                                          -15                                                                                                                    -5
                                      0           2       4           6     8                                                         0             2        4            6       8                                                                         0                 2          4            6       8
                                                      Tiempo (s)                                                                                         Tiempo (s)                                                                                                                  Tiempo (s)
                                             35                                                                                            37                                                                                                                        37
                                      x 10                                                                                            x 10                                                                                                                  x 10
                                 4                                                                                                3                                                                                                                     2
                                                                                                                                                                                                                            Velocidad Angular 1
                                                                                                       Velocidad del Carro
         Posición Angular 3




                                 2                                                                                                2
                                                                                                                                                                                                                                                        0
                                 0                                                                                                1
                                                                                                                                                                                                                                                    -2
                                 -2                                                                                               0

                                 -4                                                                                           -1                                                                                                                    -4
                                      0           2       4           6     8                                                         0             2        4            6       8                                                                         0                 2          4            6       8
                                                      Tiempo (s)                                                                                         Tiempo (s)                                                                                                                  Tiempo (s)
                                             37                                                                                            37                                                                                                                        38
                                      x 10                                                                                            x 10                                                                                                                  x 10
                                 3                                                                                                1                                                                                                                     3
                                                                                                                                                                                                                            Señal de Control U(t)
         Velocidad Angular 2




                                                                                                       Velocidad Angular 3




                                 2                                                                                                0                                                                                                                     2

                                 1                                                                                            -1                                                                                                                        1

                                 0                                                                                            -2                                                                                                                        0

                                 -1                                                                                           -3                                                                                                                    -1
                                      0           2       4           6     8                                                         0             2        4            6       8                                                                         0                 2          4            6       8
                                                      Tiempo (s)                                                                                         Tiempo (s)                                                                                                                  Tiempo (s)



                                                                   Figura 81: Respuesta cuando se incremento 1000 gr a la varilla 3.


                                                  Para una mayor apreciación de las ventajas de utilizar un controlador
adaptativo frente a un control fijo, variamos los parámetros del sistema como se
hizo en la sección anterior, observar que no se modifican las ganancias del
controlador, es decir se está utilizando un control fijo.



                                                                                                                                                                                                                                                                                                          143
                                Cuadro 5. Resultados utilizando un controlador fijo.
Masa de la                   Ganancia del controlador               Ganancia         Tiempo de       Máximo
  tercera                                                         Integral [ KI ]   asentamiento
                                      [ K ] fijo                                                    sobre pico .
  varilla

                        [-9.4951 -47.99 156.35 -154.19
  96 gr                 -15.484 -1.1866 -3.2849 -8.861]          [ -0.051026 ]          6s            4.24 %
                        [-9.4951 -47.99 156.35 -154.19
  596 gr                -15.484 -1.1866 -3.2849 -8.861]          [ -0.051026 ]          Inf.            Inf.
                        [-9.4951 -47.99 156.35 -154.19
1.096 Kg                -15.484 -1.1866 -3.2849 -8.861]          [ -0.051026 ]          Inf.            Inf.


            Por tanto queda demostrado que un controlador fijo no es capaz de
responder adecuadamente a medida que se varían los parámetros del proceso
estudiado.


4.8.3.      Diferencias entre modelo completo no lineal y modelo linealizado
            Para ver las diferencias al utilizar un modelo no lineal completo y un
modelo linealizado en torno al punto de equilibrio compararemos las respuestas
al utilizar un controlador continuo proporcional integral óptimo cuadrático.
            Primero probaremos el controlador en el modelo no lineal, el esquema
se muestra a continuación:

             1.2




               1




             0.8




             0.6




             0.4




             0.2




               0




             -0.2
                    0                         5                      10                        15




                        Figura 82: Simulación usando el modelo no lineal del péndulo triple.


            De la gráfica podemos apreciar que el tiempo de asentamiento es de
alrededor 6 segundos y el sobreimpulso no supera el 4%,


                                                                                                    144
               Ahora probamos el mismo controlador, pero utilizando el modelo
linealizado en torno al punto de equilibrio, la respuesta del sistema se muestra a
continuación:

               1.2




                  1




               0.8




               0.6




               0.4




               0.2




                  0




               -0.2
                      0                         5                        10                        15



                          Figura 83: Simulación usando el modelo linealizado del péndulo triple.


               Haciendo unos cálculos en el Matlab, comprobamos que la diferencia
que existe entre los resultados usando uno y otro modelo son muy pequeños,
para los estados del sistema estas diferencias no superan los valores siguientes:
               Para la posición del carro, es decir la variable X1, el error máximo es de
0.011622 metros o 1.16 centímetros, mas aun esto podemos apreciarlo
gráficamente:
                 -3
           x 10
      2




      0




      -2




      -4




      -6




      -8




     -10




     -12
           0                 2       4      6       8       10      12        14   16     18            20




                                           Figura 84: Error entre la posición.


               La gráfica muestra el resultado de restar el valor de X1 obtenido usando
el modelo no lineal y esta variable utilizando el modelo linealizado.
               Para los ángulos de las varillas, es decir las variables X2, X3 y X4 ,el
error máximo es 0.0018054, 0.0014732 y 0.0012714 radianes respectivamente,
si convertimos a grados sexagesimales obtenemos errores menores a 0.1 grados,


                                                                                                             145
en conclusión las diferencias entre el modelo no lineal y el modelo linealizado
son mínimas ,mas aun esto podemos apreciarlo gráficamente:


                           -3
                       x 10
                  1


                  0


                  -1


                  -2
                       0        2       4        6       8   10     12        14        16        18    20

                           -3
                       x 10
                  1


                  0


                  -1


                  -2
                       0        2       4        6       8   10     12        14        16        18    20

                           -3
                       x 10
                  1


                  0


                  -1


                  -2
                       0        2       4        6       8   10     12        14        16        18    20



                                            Figura 85: Error entre los ángulos.


               Para las velocidades lineal y angulares , es decir las variables X5,X6,X7
y X8 ,el error máximo es 0.29088 m/s, 0.015932, 0.021298 y 0.025586 rad/s
respectivamente, en conclusión las diferencias entre el modelo no lineal y el
modelo linealizado son mínimas, mas aun esto podemos apreciarlo
gráficamente:


    0.5


      0


    -0.5
           0               2        4        6       8       10          12        14        16        18    20

   0.02


      0


   -0.02
           0               2        4        6       8       10          12        14        16        18    20

   0.02

      0

   -0.02

   -0.04
           0               2        4        6       8       10          12        14        16        18    20

   0.02

      0

   -0.02

   -0.04
           0               2        4        6       8       10          12        14        16        18    20


                                        Figura 86: Error entre las velocidades.
                                                                                                              146
              Resumiendo estos resultados mostramos el siguiente cuadro:


            Cuadro 6. Diferencias entre modelo completo no lineal y modelo linealizado
                         Variable                  Estado               Error máximo


       Posición Lineal del carro                     X1               0.011622      m.
       Posición Angular de la varilla 1              X2               0.0018054 rad
       Posición Angular de la varilla 2              X3               0.0014732 rad
       Posición Angular de la varilla 3              X4               0.0012714 rad
       Velocidad Lineal del carro                    X5               0.29088       m/s
       Velocidad Angular de la varilla 1             X6               0.015932 rad/s
       Velocidad Angular de la varilla 2             X7               0.021298 rad/s
       Velocidad Angular de la varilla 3             X8               0.025586 rad/s



4.9.   VALIDACIÓN DE HIPOTESIS

              El controlador adaptativo autosintonizado diseñado si es capaz de
       controlar la estabilidad del péndulo triple invertido lineal, el controlador tiene
       un tiempo de respuesta de 6 segundos aproximadamente y el Sobrepico máximo
       es menor al 5 %. Puede variar su comportamiento frente a cambios en la
       dinámica del sistema como es el peso de la tercera varilla, lo que se hace es
       variar la matriz de ganancia de realimentación de estados de acuerdo a los
       cambios en la dinámica que son estimados por el identificador de sistemas
       utilizando el método de los mínimos cuadrados recursivos mejorados
       multivariables. En el siguiente cuadro se muestra las características del
       controlador adaptativo diseñado.

                      Cuadro 7. Características del Controlador Adaptativo.
                         CONTROL ADAPTATIVO DE UN PÉNDULO TRIPLE
       Tipo de controlador                          Adaptativo Autoajustable.
       Método de Identificación de parámetros.      Mínimos cuadrados recursivos.
       Ley o estructura de control                  Proporcional Integral Óptimo cuadrático
       Tiempo de asentamiento                        6 s. Aprox.
       Máximo Sobrepico                              5%


                                                                                          147
       El controlador adaptativo diseñado es capaz de responder de una mejor
manera frente a las perturbaciones externas e incertidumbres en el modelado del
proceso en comparación a un controlador fijo, sin embargo la respuesta del
controlador depende mucho de la efectividad del estimador de parámetros ya
que si el sistema identificado no coincide con el sistema real la respuesta no
será adecuada.
       Las ventajas de utilizar un controlador adaptativo si son mayores a las
desventajas producidas por el alto costo computacional requerido para realizar
los algoritmos de control, mas aun si el proceso estará sujeto a constantes
cambios en sus parámetros el controlador adaptativo será una solución directa al
problema de estudio, sin embargo, si los parámetros del sistema no van a sufrir
mayores cambios se debe de pensar primero en utilizar un controlador fijo en
vez de uno adaptativo.




                                                                            148
 CONCLUSIONES Y
RECOMENDACIONES
                                    CONCLUSIONES


       Durante el proceso de investigación se realizó muchos experimentos que ayudaron
a comprender de mejor manera la teoría de control, tanto a nivel teórico como práctico, de
esta forma se adquirió habilidades para diseñar sistemas de control de modo que exista
estrecha relación entre la simulación y la implementación real ,en nuestro estudio sobre el
control adaptativo del péndulo triple se obtuvo muchos resultados importantes que
ayudarán a futuras investigaciones en esta área, las conclusiones más importantes a las que
se llegó son las siguientes:


       1. Se diseñó e implementó un sistema para el control de estabilidad de un péndulo
           triple invertido, utilizando un esquema de control adaptativo autosintonizado
           que brindó un comportamiento dentro de lo esperado.
       2. Se estudió las diferencias de utilizar un modelo no lineal frente a el modelo
           linealizado, los errores son muy pequeños, menores al 1.2% y por tanto se
           pueden considerar despreciables siempre y cuando no se aleje del punto de
           operación en la cual se linealizó.
       3. Se realizó una comparación entre el controlador adaptativo diseñado y un
           controlador fijo como es el PI óptimo cuadrático, se observó que cuando los
           parámetros tienen pequeñas variaciones, menores al 10%, el regulador fijo
           responde adecuadamente, sin embargo cuando el sistema presenta un gran
           cambio en su dinámica, superiores al 30 % de su valor nominal este regulador
           deja de ser bueno, aquí es donde el controlador adaptativo muestra su mayor
           ventaja.
       4. Se diseño un software en LabVIEW, este programa permite controlar el Set
           Point así como permite el monitoreo de las señales provenientes del sistema
           físico.
       5. Se implementó el sistema mecánico del péndulo triple con materiales
           asequibles, el circuito electrónico del controlador se diseño de acuerdo al
           estudio hecho en el presente proyecto.
6. Se comprobó que al utilizar un mecanismo de adaptación dentro de un lazo de
   realimentación, un controlador es capaz de brindar un buen comportamiento
   incluso cuando se modifique los parámetros del sistema o se tenga una
   perturbación externa que afecte la dinámica del proceso.
7. Es muy importante tener un método de estimación de parámetros que no
   presente problemas de divergencia, es decir si en cada iteración estos tiendan a
   tomar valores muy grandes, llegará a un punto en que sus variables tomen
   valores indeterminados, que afectarán a el correcto funcionamiento del
   estimador ,por tanto un mal rendimiento del sistema de control.
8. Uno de los inconvenientes de utilizar un controlador adaptativo es el mayor
   costo computacional requerido en comparación a un regulador fijo, por lo tanto
   se debe de evaluar en qué casos un controlador fijo es insuficiente y será
   necesario un controlador adaptativo.
9. Se realizó pruebas para probar la adaptatibilidad del sistema, para ello se
   adicionó cargas no lineales con el fin de alterar la dinámica del proceso, los
   resultados obtenidos guardan estrecha relación con las simulaciones obtenidas,
   brindando un rendimiento adecuado del algoritmo de control adaptativo.
10. Al simular el sistema utilizando el Matlab se llegó a un punto en que el
   programa no respondía adecuadamente debido al hecho de usar variables muy
   pequeñas que eran consideradas como cero o valores muy grandes que se
   consideraban como NaN (Not a Number) dándonos valores fuera de lo
   esperado ,incluso cuando toda la estructura del programa era correcta.
                               RECOMENDACIONES


       Para futuros trabajos relacionados con el presente proyecto de investigación,
damos las siguientes sugerencias y recomendaciones:


       1. Implementar un sistema físico que tenga un mínimo de factores no lineales
          como son: fricciones de rozamiento, vibraciones indeseadas del módulo,
          saturación del amplificador y retardo en el envío de datos. Además se
          recomienda hacer uso de otros tipos de sensores para medir las variables, una
          buena elección es utilizar encoders absolutos.
       2. Para poder comprender las estrategias de control avanzado como es el
          adaptativo autosintonizado, primero se recomienda realizar experiencias
          usando controladores convencionales como los PID, o los óptimos cuadráticos.
          Se debe de tomar muy en cuenta los retardos en el envío de datos y
          procesamiento de los algoritmos de control, ya que el tiempo de realizar la
          estimación de parámetros es considerable y puede ocasionar problemas en el
          rendimiento del sistema.
       3. Se motiva a realizar el control de sistemas utilizando nuevas metodologías de
          control como los adaptativos por modelo de referencia, adaptativos predictivos,
          redes neuronales, controladores difusos, control adaptativo predictivo experto
          (ADEX), y otras nuevas tecnologías de control automático que están
          encontrando gran interés en la industria de hoy en día.
 REFERENCIAS
BIBLIOGRÁFICAS
                          REFERENCIAS BIBLIOGRÁFICAS


 [1]   Arturo Rojas Moreno. Control Avanzado - Diseño y aplicaciones en tiempo real
       Universidad Nacional de Ingeniería .Lima 2001.

 [2]   Bahram Shahian , Michael Hassul . Control System Design Using MATLAB .New
       Jersey 1993.

 [3]   Carnegie Mellon .Manuales de Matlab para control automático .Estados Unidos
       1996.

 [4]   Carolina Godoy .Control adaptativo en tiempo real .Quito 2012.

 [5]   Daniel Rodríguez Ramírez, Carlos Bordóns Alba .Apuntes de Ingeniería de Control
       – Identificación de Sistemas, Control Adaptativo, Control Predictivo .2005.

 [6]   Edoardo Mosca.Optimal, Predictive and adaptative control .Prentice Hall 1995.

 [7]   Eduardo García Breijo .Compilador C CCS y simulador PROTEUS para
       Microcontroladores PIC .Barcelona 2008.

 [8]   Elena Lopez Guillen .Identificacion de Sistemas – Aplicación al modelado de un
       motor de continua .España.

 [9]   Espartacus Gomaris,Domingo Biel ,Jose Matas,Miguel Reyes . Teoría de control –
       Diseño Electrónico. Alfaomega. Barcelona 2001.

[10]   Iván Jesús Rivas Campero, José Manuel Salcedo Solorio. Comportamiento dinámico
       de un péndulo triple plano .México .2009.

[11]   Javier Pérez Ramírez, José M. Campoy, Bruno G. Soto .Control adaptativo
       implantado en un micro-PLC.

[12]   José Lajara Vizcaino, José P. Sebastia .LabVIEW Entorno gráfico de programación
       .Alfaomega –marcombo 2007.

[13]   Juan Calderón Montiel. Análisis de desempeño de controladores adaptativos
       discretos en el espacio de estados .Ecuador 2008.

[14]   Karl J. Astrom,Bjorn Wittenmark . Adaptative Control. 2ª ed. New York .1994.

[15]   Katsuhiko Ogata .Ingeniería de control moderna .Cuarta edición .Prentice Hall
       2007.
[16]   Katsuhiko Ogata. Sistemas de control en tiempo discreto .Segunda edición. Prentice
       Hall 1996.

[17]   Lennart Ljung . System Identification – Theory for the User .2ª ed. Suiza .1999.

                                                                                          152
[18]   Moreno José .Estimación de parámetros en controladores de sistemas de excitación
       utilizando un método de identificación. México 2010.

[19]   Petros A. Ioannou ,Baris Fidan .Adaptative control tutorial .California .2006 .

[20]   Petros A. Ioannou ,Jing Sun .Robust adaptative Control. California .1996.

[21]   Robert Boylestad, Louis Nashelsky .Electrónica Teoría de circuitos .Octava edición
       .Prentice Hall 2003.

[22]   Roberto H. Sampieri, Carlos F. Collado, Pilar B. Lucio .Metodología de la
       investigación .Quinta edición .México 2010.

[23]   Rodríguez Rubio Francisco, Manuel Jesús López Sánchez .Control Adaptivo y
       Robusto .Sevilla.1996.

[24]   Segismundo Izquierdo Millán .Identificación de sistemas. Madrid 2005.

[25]   Shankar Sastry, Marc Bodson .Adaptative Control –Stability,convergence and
       robustness ,New Jersey 1989 .

[26]   Terencio Soldovieri C. Introducción a la mecánica de Lagrange Hamilton
       .Venezuela 2010.

[27]   Thomas F. Edgar .Recursive Least Square Parameter Estimation for linear steady
       and Dynamics models. University of Texas 2006.

[28]   Valencia M. Mónica. Diseño y análisis de desempeño de observadores adaptativos
       en esquemas de control mediante realimentación completa de estados .Ecuador 2011
       .

[29]   Martin zSánchez, A. Cabanillas ,F. Alonso ,F. Riesco .Evaluación de una plataforma
       de control Adaptativo predictivo Experto en la refinería de Escombreras .Madrid
       2004 .

[30]   Víctor H. Santamaría, José R. Rojo Ramírez. Péndulo Triple invertido .México
       Agosto del 2011.




                                                                                         153
ANEXOS
Anexo 1. Diagrama del control adaptativo usando Simulink de Matlab.




Anexo 2. Diagrama del control fijo usando Simulink de Matlab.




                                                                      154
Anexo 3. Controlador adaptativo en LabVIEW 2012.




                                                   155
Anexo 4. Diagrama de bloques del controlador adaptativo.




                                                           156
Anexo 5. Diagrama esquemático del controlador electrónico del péndulo triple.




                                                                                157
     Anexo 6. Circuito Impreso de la fuente de alimentación del controlador.




Anexo 7. Circuito Impreso de la fuente de alimentación del driver de potencia.




                                                                                 158
      Anexo 8. Circuito Impreso del controlador.




   Anexo 9. Fuente de alimentación del controlador.




Anexo 10. Fuente de alimentación del driver de potencia.




                                                           159
       Anexo 11. Tarjeta del controlador.




Anexo 12. Tarjeta del controlador –vista superior.




Anexo 13. Tarjeta del controlador –placa de cobre.




                                                     160
Anexo 14. Fuente de alimentación del Driver STK 6875 –vista superior.




Anexo 15. Fuente de alimentación del Driver STK 6875 –placa de cobre.




   Anexo 16. Fuente de alimentación del controlador–vista superior.




   Anexo 17. Fuente de alimentación del controlador–placa de cobre.




                                                                        161
            Anexo 18. Sistema mecánico del péndulo triple – vista frontal.




            Anexo 19. Código del control Adaptativo del Péndulo Triple.

%% PROGRAMA DEL CONTROLADOR ADAPTATIVO AUTOSINTONIZADO APLICADO
%% AL CONTROL DE UN PENDULO TRIPLE.

clc;close all ;
syms xp u m0 m1 m2 m3 l1 l2 l3;
syms x1 x2 x3 x4 x5 x6 x7 x8;

%Momento de inercia de los links
J1=0;
J2=0;
J3=0;

% longitud al centro de masas
lc1=0.5*l1;
lc2=0.5*l2;
lc3=0.5*l3;

% Coeficiente de gravitación
g=9.81;

% constantes para simplificacion
a0=m0+m1+m2+m3;
a1=m2*l1+m3*l1+m1*lc1;
a2=m2*lc2+m3*l2;
a3=m3*lc3;

b1=J1+(m1*lc1*lc1)+(m2*l1*l1)+(m3*l1*l1);



                                                                             162
b2=J2+(m2*lc2*lc2)+(m3*l2*l2);
b3=J3+m3*lc3*lc3;

c1=g*a1;
c2=g*a2;
c3=g*a3;

% Fricción Viscosa
 bc=0; k1=0; k2=0; k3=0;

%    Matriz de Inercia M(q)
%    Definimos los estados como
%    q =[x1 x2 x3 x4]
%    qp=[x5 x6 x7 x8]
%    donde x1:=posicion del carro, x2:=posicion angular 1
%    x3:=posicion angular 2 , x4:=posicion angular 3
%    x5:=velocidad del carro x6:=velocidad angular 1
%    x7:=velocidad angular 2 x8:=velocidad angular 3

% PARAMETROS DEL MOTOR
rp = 0.019; n = 11/75;Jo = 0;
Jm = 6.37e-6;mp = 0.045;
Jp = mp*rp^2/2;
Jeq = Jm + n^2*(Jo + Jp);
Bm = 4.23e-6; Bo =4.23e-8; Beq = Bm + n^2*Bo;
Km = 86.02e-3; Kb = 86.47e-3; Ra = 37.38; KA = 4.8;

J2 = Jeq/(n^2*rp^2);
Kx = Km/(Ra*n*rp);
Bx = Beq/(n^2*rp^2) + Kb*Km/(n^2*rp^2*Ra);
KxA=Kx*KA;

%Elementos de la matriz de Inercias
M11=a0/KxA+J2/KxA;
M12=a1/KxA*cos(x2);
M13=a2/KxA*cos(x3);
M14=a3/KxA*cos(x4);

M21=a1*cos(x2);
M22=b1;
M23=a2*l1*cos(x3-x2);
M24=a3*l1*cos(x4-x2);

M31=a2*cos(x3);
M32=a2*l1*cos(x3-x2);
M33=b2;
M34=a3*l2*cos(x4-x3);

M41=a3*cos(x4);
M42=a3*l1*cos(x4-x2);
M43=a3*l2*cos(x4-x3);
M44=b3;

    %Vector de Fuerzas de Coriolis y de Fuerzas Centripetas

C11=bc/KxA+Bx/KxA;
C12=a1/KxA*sin(x2)*x6;
C13=a2/KxA*sin(x3)*x7;



                                                              163
C14=a3/KxA*sin(x4)*x8;

C21=0;
C22=k1+k2;
C23=-k2-a2*l1*sin(x3-x2)*x7;
C24=-a3*l1*sin(x4-x2)*x8;

C31=0;
C32=-k2+a2*l1*sin(x3-x2)*x6;
C33=k2+k3;
C34=-k3-a3*l2*sin(x4-x3)*x8;

C41=0;
C42=a3*l1*sin(x4-x2)*x6;
C43=-k3+a3*l2*sin(x4-x3)*x7;
C44=k3;

%Matriz de Gravedad
G1=0;
G2=-c1*sin(x2);
G3=-c2*sin(x3);
G4=-c3*sin(x4);

% %Matriz de Fricción Viscosa y Seca
% Fr1=b1*x2+k1*tanh(beta*x2);
% Fr2=b2*x4+k2*tanh(beta*x4);

% Variables Articulares y Derivadas
q=[x1;x2;x3;x4];
qp=[x5;x6;x7;x8];

% Matrices
M=[M11,M12,M13,M14;
M21,M22,M23,M24;
M31,M32,M33,M34;
M41,M42,M43,M44];

C=[C11,-C12,-C13,-C14;
C21,C22,C23,C24;
C31,C32,C33,C34;
C41,C42,C43,C44];

G=[G1;G2;G3;G4];
% w=1;
% f=5*sin(w*t);
f=u;
T=[f;0;0;0];

N=C*qp+G;

% Ecuaciones de Estado
qpp=inv(M)*(T-N);

% Sustituyendo en el punto de equilibrio.
Equi=subs(qpp,{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0});

%xp=[x2 ;qpp(1); x4; qpp(2); x6; qpp(3); x8; qpp(4)];
xp=[x5; x6; x7; x8; qpp(1);qpp(2);qpp(3); qpp(4)];


                                                                  164
 %% LINEALIZACION DEL SISTEMA

A1=diff(xp,x1);
A2=diff(xp,x2);
A3=diff(xp,x3);
A4=diff(xp,x4);
A5=diff(xp,x5);
A6=diff(xp,x6);
A7=diff(xp,x7);
A8=diff(xp,x8);
A=subs([A1 A2 A3 A4 A5 A6 A7
A8],{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0});

B1=diff(xp(1),u);
B2=diff(xp(2),u);
B3=diff(xp(3),u);
B4=diff(xp(4),u);
B5=diff(xp(5),u);
B6=diff(xp(6),u);
B7=diff(xp(7),u);
B8=diff(xp(8),u);
B=subs([B1 B2 B3 B4 B5 B6 B7
B8]',{x1,x2,x3,x4,x5,x6,x7,x8,u},{0,0,0,0,0,0,0,0,0});


%% PARAMETROS DEL PENDULO TRIPLE
% masa del carrito

m0=0.370;

% masas de los pendulos
m1=0.073;
m2=0.087;
m3=0.096;

% longitud de los pendulos
l1=0.25;
l2=0.27;
l3=0.29;

%Momento de inercia de los links
J1=0;
J2=0;
J3=0;

% longitud al centro de masas
lc1=0.5*l1;
lc2=0.5*l2;
lc3=0.5*l3;

% Coeficiente de gravitación
g=9.81;

% constantes para simplificacion
a0=m0+m1+m2+m3;
a1=m2*l1+m3*l1+m1*lc1;
a2=m2*lc2+m3*l2;
a3=m3*lc3;



                                                         165
a4=a2*l1;
a5=a3*l1;
a6=a3*l2;

b1=J1+(m1*lc1*lc1)+(m2*l1*l1)+(m3*l1*l1);
b2=J2+(m2*lc2*lc2)+(m3*l2*l2);
b3=J3+m3*lc3*lc3;


% MODELO LINEAL     DEL PROCESO

Ac=subs(A);
Bc=subs(B);
Cc=[1 0 0 0 0 0 0 0];
Dc=[0];


% MODELO LINEAL DISCRETO DEL PROCESO
T = 0.01; % PERIODO DE MUESTREO

[G,H]=c2d(Ac,Bc,T);%
            alfa=1000;N=10; Pi = alfa*eye(10); % MATRIZ P INICIAL
theta_p = [G H ]'; % PARAMETROS DEL PROCESO
thetai = [G H zeros(8,1)]'; % PARAMETROS INICIALES
lambda = 0.99; % FACTOR DE MEMORIA
Y(:,:,1)=[0 0 0 0 0 0 0 0]'; uc(2) = 0;
ref=0.5;
X1(2)=0;X2(2)=0;X3(2)=0;X4(2)=0;X5(2)=0;X6(2)=0;X7(2)=0;X8(2)=0;

v(1)=0;
Q = [ 100 0 0 0     0   0   0   0 0
        0 150 0 0   0   0   0   0 0
        0 0 150 0   0   0   0   0 0
        0 0 0 150   0   0   0   0 0
        0 0 0 0 1   0   0   0   0
        0 0 0 0 0   1   0   0   0
        0 0 0 0 0   0   1   0   0
        0 0 0 0 0   0   0   1   0
        0 0 0 0 0   0   0   0   1];

R = [100];
K=[0 0 0 0 0 0 0 0];
KI=0;
Ge=G;He=H;
Mm=1000;
uc(1)=0;
X=[0 0 0 0 0 0 0 0]';
for k=2:Mm


%% IDENTIFICADOR DE PARAMETROS
psi_p = [Y(:,:,k-1); uc(k-1)];%9x1
%Y(:,:,k+1) = theta_p'*psi_p; % MODELO LINEAL DEL PROCESO
Y(:,:,k) = X; % MODELO LINEAL DEL PROCESO
psi = [psi_p;1]; % VECTOR DE DATOS
nor = max(1,norm(psi));
psin = psi/nor;
Qch = chol(Pi');



                                                                    166
S = inv(diag(Qch*ones(N,1),0));
Ps = S*Pi*S;
psins = inv(S)*psin;
rt = 1 + psins'*Ps*psins;
LF = 1 - (rt-sqrt(rt^2-4*norm(Ps*psins)^2/trace(Ps)))/2;
e = Y(:,:,k)/nor-thetai'*psin; % ERROR DE ESTIMACION
div = psins'*Ps*psins + LF;
theta = thetai'+e*(inv(S)*Ps*psins/div)'; % VECTOR DE PARAMETROS
Ge = theta(:,1:8); % PARAMETRO G ESTIMADO
He = theta(:,9); % PARAMETRO H ESTIMADO
Ce = theta(:,10);
Hns = Ps*psins/div;
Ps = Ps/LF - Hns*psins'*Ps/LF;
tt = abs(max(eig(Ps))/min(eig(Ps)) );
cmax = 100; cmin = 15;
if tt <= cmin,
thetai = theta'; Pi = Ps;
elseif tt >= cmax,
Qchnew = chol(Ps');
Snew = inv(diag(Qchnew*ones(N,1),0));
Psnew = Snew*Ps*Snew;
Pi = Psnew; thetai = theta';
end

%% DISEÑO DE LA LEY DE CONTROL

Ge1 = [Ge zeros(8,1)
      -Cc*Ge 1];
He1 = [He;-Cc*He];
%M = [He1 Ge1*He1 Ge1^2*He1 Ge1^3*He1 Ge1^4*He1];
%rM = rank(M); % rM=5 => COMPLETAMENTE CONTROLABLE
% CALCULO DE LA GANANCIA DEL CONTROLADOR

P = zeros(9,9);
for i=1:800
P = Q + Ge1'*P*Ge1 -Ge1'*P*He1*inv(R+He1'*P*He1)*He1'*P*Ge1;
end
K1 = inv(R+He1'*P*He1)*He1'*P*Ge1;
%[KK,PP] = dlqr(Ge1,He1,Q,R); % K1=KK, P=PP
KK=K1;
K = [KK(1) KK(2) KK(3) KK(4) KK(5) KK(6) KK(7) KK(8)]; KI = - KK(9);
     X=[X1(k) X2(k) X3(k) X4(k) X5(k) X6(k) X7(k) X8(k)]';
    y(k)=Cc*X;
    v(k)=v(k-1)+ref-y(k);
    uc(k)=-K*[X1(k) X2(k) X3(k) X4(k) X5(k) X6(k) X7(k) X8(k)]'+KI*v(k);

    X=Ge*X+He*uc(k);
    X1(k+1)=[1 0 0 0   0   0   0   0   ]*X;
    X2(k+1)=[0 1 0 0   0   0   0   0   ]*X;
    X3(k+1)=[0 0 1 0   0   0   0   0   ]*X;
    X4(k+1)=[0 0 0 1   0   0   0   0   ]*X;
    X5(k+1)=[0 0 0 0   1   0   0   0   ]*X;
    X6(k+1)=[0 0 0 0   0   1   0   0   ]*X;
    X7(k+1)=[0 0 0 0   0   0   1   0   ]*X;
    X8(k+1)=[0 0 0 0   0   0   0   1   ]*X;

  end




                                                                       167
%% GRAFICAS DEL SISTEMA
figure(1)
t=linspace(0,T*Mm,Mm);
subplot(3,3,1)
plot(t,X1(1:Mm),t,ref),grid;
ylabel('Posición del carro [mts.]')
xlabel('Tiempo (s)')
subplot(3,3,2)
plot(t,X2(1:Mm),t,0),grid;
ylabel('Posición Angular 1 [rad]')
xlabel('Tiempo (s)')
subplot(3,3,3)
plot(t,X3(1:Mm),t,0),grid;
ylabel('Posición Angular 2 [rad]')
xlabel('Tiempo (s)')
subplot(3,3,4)
plot(t,X4(1:Mm),t,0),grid;
ylabel('Posición Angular 3 [rad]')
xlabel('Tiempo (s)')
subplot(3,3,5)
plot(t,X5(1:Mm)),grid;
ylabel('Velocidad del carro [mts/s]')
xlabel('Tiempo (s)')
subplot(3,3,6)
plot(t,X6(1:Mm)),grid;
ylabel('Velocidad Angular 1 [rad/s]')
xlabel('Tiempo (s)')
subplot(3,3,7)
plot(t,X7(1:Mm)),grid;
ylabel('Velocidad Angular 2 [rad/s]')
xlabel('Tiempo (s)')
subplot(3,3,8)
plot(t,X8(1:Mm)),grid;
ylabel('Velocidad Angular 3 [rad/s]')
xlabel('Tiempo (s)')
subplot(3,3,9)
plot(t,uc(1:Mm)),grid;
ylabel('Señal de Control U(t)[Volts]')
xlabel('Tiempo (s)')




                                         168
GLOSARIO DE
 TERMINOS
                                 GLOSARIO DE TÉRMINOS


Adaptativo: Sistema que modifica sus parámetros a medida que se producen cambios en la
      naturaleza de la señal de entrada, por ejemplo, en función de las perturbaciones.

Algoritmo: Procedimiento matemático o lógico para realizar un cálculo o para resolver un
       problema. Sucesión de operaciones elementales, perfectamente especificadas y ordenadas,
       que sirven para hacer algo preciso.

Asintótico: Relativo a la asíntota. Curvas asintóticas, curvas, en número de dos, de ramas infinitas,
       tales que, si un punto se aleja indefinidamente sobre una de ellas, existe sobre la otra un
       punto variable cuya distancia al primero tiende a cero.

Cero: Término usado en la transformada de Laplace y la transformada z. Cuando en el dominio s
       o en el dominio z, la función de transferencia está escrita como un polinomio dividido por
       otro polinomio, las raíces del numerador son los ceros del sistema.

Controlabilidad: Si es posible transferir el sistema de un estado inicial arbitrario a cualquier
       estado deseado, en un periodo finito de tiempo. Es decir si todas las variables de estado
       pueden ser controladas en un periodo finito, mediante alguna señal de control no
       restringida.

Control realimentado: Operación que en presencia de perturbaciones, tiende a reducir la
       diferencia entre la salida de un sistema y alguna entrada de referencia.

Convolución: Operación matemática por medio de la cual se halla la salida de un sistema,
      conociendo su entrada y su respuesta al impulso.

Dispositivo compuesto: Es aquel dispositivo con múltiples interfaces independientes. Cada una
       tiene una dirección sobre el bus para cada interface puede tener un diferente driver device
       en el host.

Dominio de la frecuencia: Una señal que tiene frecuencia como variable independiente. La salida
      de la transformada de Fourier.

Dominio del tiempo: Una señal que tiene el tiempo como variable independiente.

Dominio z: El dominio definido por la transformada z. También llamado plano z.

Driver: es un programa que habilita aplicaciones para poderse comunicar con el dispositivo. Cada
       dispositivo sobre el bus debe tener un driver, algunos periféricos utilizan los drivers que
       trae Windows.

Ecuación de diferencias: Ecuación que relaciona las muestras pasadas y presentes de la señal de
       salida con las muestras pasadas y presentes de la señal de entrada.

Espacio de Estado: El espacio n-dimensional cuyos ejes de coordenadas están formados por los
       ejes 𝑥1 , 𝑥2 , … , 𝑥𝑛 , donde 𝑥1 , 𝑥2 , … , 𝑥𝑛 , son las variables de estado, se denomina espacio
       de estado. Cualquier estado se puede representar como un punto en el espacio de estados.




                                                                                                   169
Estabilidad: Una situación es estable si se mantiene en estado estacionario, es decir, igual en el
        tiempo y una modificación razonablemente pequeña de las condiciones iniciales no altera
        significativamente el futuro de la situación.

Estabilidad asintótica: Significa que soluciones que empiezan suficientemente cerca, no sólo
        permanecen cercanas sino que eventualmente acaban convergiendo al mismo equilibrio.

Factorización de Cholesky: Una matriz simétrica definida positiva puede ser descompuesta como
       el producto de una matriz triangular inferior y la traspuesta de la matriz triangular inferior.
       La matriz triangular inferior es el triángulo de Cholesky de la matriz original positiva
       definida. El resultado de Cholesky ha sido extendido a matrices con entradas complejas.
       Es una manera de resolver sistemas de ecuaciones matriciales y se deriva de
       la factorización LU con una pequeña variación.

Frecuencia de muestreo: Rata o razón a la cual son adquiridas las muestras con un conversor
      analógico/digital.

Función de transferencia: La señal de salida dividida entre la señal de entrada. La función de
      transferencia puede expresarse de diferentes formas, dependiendo de cómo estén
      representadas las señales. Por ejemplo, en el dominio s y en el dominio z se expresa como
      la división de dos polinomios.

Message Pipes: este tipo de enlace virtual si tiene un formato USB definido y solo puede soportar
      la transferencia Control. Cuando se conecta un dispositivo USB a la PC se produce el
      Proceso de Enumeración, el cual consiste en que el host le pregunta al dispositivo que se
      presente y le diga cuáles son sus parámetros.

Muestra: Valor instantáneo de una señal continua, tomado en cierto instante de tiempo.

Normalización: Ajuste de una serie (vector) de valores (representando típicamente un conjunto de
      medidas) de acuerdo con alguna función de transformación para hacerlos comparables con
      algún punto específico de referencia.

Observabilidad: Si cualquier estado inicial puede determinarse a partir de la observación de las
      salidas sobre un número finito de periodos de muestreo, es decir si cualquier transición del
      estado de manera eventual afecta a todos los elementos del vector de salida.

Período de muestreo: Espacio de tiempo entre muestras cuando una señal es digitalizada.

Perturbaciones: Señal que tiende a afectar negativamente el valor de la salida de un sistema .Si la
       perturbación se origina dentro del sistema se denomina interna, mientras que una
       perturbación externa se genera fuera del sistema y es una entrada.

Plano z: Dominio z.

Polo: Término usado en la transformada de Laplace y la transformada z. Cuando en el dominio s o
       en el dominio z, la función de transferencia está escrita como un polinomio dividido por
       otro polinomio, las raíces del denominador son los polos del sistema.

Pre procesamiento: Conjunto de tareas tendientes a acondicionar la señal.

Puerto USB: Es una entrada o acceso para que el usuario pueda compartir información
       almacenada en diferentes dispositivos.



                                                                                                 170
Puntos terminales (Endpoints): Es una localidad específica dentro del dispositivo. El Endpoint
       es un buffer que almacena múltiples bytes, típicamente es un bloque de la memoria de
       datos o un registro dentro del microcontrolador. Todos los dispositivos deben soportar el
       punto terminal 0. Este punto terminal es el que recibe todo el control y la peticiones de
       estado durante la enumeración cuando el dispositivo esta sobre el bus.

Resolución: Número de bits utilizados para representar una señal analógica.

Respuesta en frecuencia: Cambios en la magnitud y la fase que experimentan las sinusoides
      cuando pasan a través de un sistema lineal. Usualmente se expresa como una función de la
      frecuencia.

Stream Pipes: Se trata de un flujo sin formato USB definido, esto significa que se puede enviar
      cualquier tipo de dato. Este tipo de pipe soporta las transferencias bulk, isócronas, e
      interrupt. Además tanto el host como el dispositivo USB pueden controlar.

Transformada: Un procedimiento, ecuación o algoritmo que cambia un grupo de datos en otro
       grupo de datos.

Tuberías (Pipes): Es un enlace virtual entre el host (la PC) y el dispositivo USB, este enlace
       configura los parámetros asociados con el ancho de banda que tipo de transferencia se va a
       utilizar (Control, Bulk, Isócrona o Interrupt) dirección del flujo de datos y el máximo
       y/o mínimo tamaño de los paquetes/buffers. Cada enlace está caracterizado por su banda
       de paso (Token), su tipo deservicio, el número de punto terminal (End Point) y el tamaño
       de los paquetes. Estos enlaces se definen y crean durante la inicialización del USB.
       Siempre existe un enlace virtual 0 que permite tener acceso a la información de
       configuración del periférico USB (estado, control e información). La norma USB define 2
       tipos de enlaces virtuales (pipe); stream y message.

Umbralización: Procedimiento de descartar los valores que estén por encima/debajo de cierto
      umbral.

Variable controlada: Es la cantidad o condición que se mide o controla, normalmente se refiere a
       la salida del sistema.

Variable manipulada: Es la cantidad o condición que el controlador modifica para efectar el
       valor de la variable manipulada.

Variables de estado: Las variables de un sistema dinámico son las variables que constituyen el
       menor conjunto de variables que determinan el estado del sistema dinámico, si al menos se
       necesitan n variable 𝑥1 , 𝑥2 , … , 𝑥𝑛 para describir completamente el comportamiento de un
       sistema dinámico entonces tales n variables son un conjunto de variables de estado .

Vector de estado: Si se necesitan n variables de estado para describir completamente el
       comportamiento de un sistema dado, entonces esas n variable se pueden considerar como n
       componentes de un vector X. Un vector de estado por lo tanto determina unívocamente el
       estado del sistema x(t) en cualquier instante de tiempo especificado.




                                                                                             171
